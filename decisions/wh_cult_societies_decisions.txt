settlement_decisions = {
	chaos_cult_desecrate_province_decision = {
		ai_check_interval = 12
		only_playable = yes

		ai_target_filter = realm_owned

		# from_potential = {
			# prisoner = no
			# NOT = { trait = incapable }
			# has_dlc = "Mystics"
			# has_quest = quest_chaos_cult_desecrate_province
			# NOT = { has_character_flag = desecration_in_progress }
			# is_devil_worshiper_trigger = yes
		# }

		potential = {
			location = { is_quest_target_of = FROM }
			FROM = {
				NOT = { has_character_flag = desecration_in_progress }
				has_quest = quest_chaos_cult_desecrate_province
				prisoner = no
				NOT = { trait = incapable }
				is_devil_worshiper_trigger = yes
			}
		}

		allow = {
			FROM = { has_quest = quest_chaos_cult_desecrate_province }
			location = { is_quest_target_of = FROM }
		}

		effect = {
			FROM = {
				increase_visibility_effect = yes
				custom_tooltip = {
					text = chaos_cult_desecrate_province_decision_tt
				}
				set_character_flag = desecration_in_progress

				# ROOT = {
					# if = {
						# limit = {
							# owner = { character = FROM }
						# }
						# if = {
							# limit = {
								# FROM = { society_member_of = cult_of_khorne }
							# }
							# add_province_modifier = { name = beastmen_unrest years = 5 }
						# }
						# if = {
							# limit = {
								# FROM = { society_member_of = cult_of_nurgle }
							# }
							# add_province_modifier = { name = nurgle_province_disease years = 5 }
							# random_list = {
									# 16 = {
										# spawn_disease = tuberculosis
									# }
									# 16 = {
										# spawn_disease = typhoid_fever
									# }
									# 16 = {
										# spawn_disease = typhus
									# }
									# 16 = {
										# spawn_disease = measles
									# }
									# 16 = {
										# spawn_disease = small_pox
									# }
									# 16 = {
										# spawn_disease = syphilis
									# }
							# }
						# }
						# if = {
							# limit = {
								# FROM = { society_member_of = cult_of_tzeentch }
							# }
							# add_province_modifier = { name = warpdust_traces years = 5 }
						# }
						# if = {
							# limit = {
								# FROM = { society_member_of = cult_of_slaanesh }
							# }
							# add_province_modifier = { name = slaanesh_hedonism years = 5 }
						# }
						# if = {
							# limit = {
								# FROM = { society_member_of = cult_of_undivded }
							# }
							# add_holding_modifier = {
								# name = desecrated_temple
								# years = 5
							# }
						# }

						# FROM = {
							# sound_effect = devil_worshippers_desecrate_temple
							# clr_quest = quest_chaos_cult_desecrate_province
							# add_society_currency_medium_effect = yes
							# break = yes
						# }
					# }
				# }
				hidden_effect = { character_event = { id = DR_cults.7112 days = 7 } }
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0.5
		}
	}
}

targeted_decisions = {
	# #Action: Demonic impregnation
	chaos_demonic_impregnation = {
		only_playable = yes
		filter = court_including_me
		ai_target_filter = court_including_me
		ai_check_interval = 120

		from_potential = {
			has_dlc = "Mystics"
			is_playable = yes
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			OR = {
				AND = {
					is_devil_worshiper_trigger = yes
					society_rank >= 3
					has_quest = quest_the_devil_worshipers_demonic_impregnation
				}
				AND = {
					society_rank >= 4
					is_devil_worshiper_trigger = yes
				}
				open_follower_of_any_chaos_gods = yes
			}
			NOT = {has_character_modifier = had_demonic_birth }
		}

		potential = {
			host = { character = FROM }
			is_female = yes
			is_pregnant = no
			age = 16
			OR = {
				NOT = { age = 45 }
				immortal = yes
			}
			OR = {
				character = FROM
				FROM = { has_quest = quest_the_devil_worshipers_demonic_impregnation }
			}
		}

		allow = {
			trigger_if = {
				limit = { is_devil_worshiper_trigger = yes }
				FROM = { has_society_currency_major_trigger = yes }
			}
			trigger_if= {
				limit = { religion = chaos  }
				has_offmap_currency = {
					offmap = undivided_warp
					value >= 4500
				}				
			}
			trigger_if= {
				limit = { religion = slaanesh  }
				has_offmap_currency = {
					offmap = slaanesh_warp
					value >= 2500
				}				
			}
			trigger_if= {
				limit = { religion = tzeentch  }
				has_offmap_currency = {
					offmap = tzeentch_warp
					value >= 2500
				}				
			}
			trigger_if= {
				limit = { religion = nurgle  }
				has_offmap_currency = {
					offmap = nurgle_warp
					value >= 2500
				}				
			}
			trigger_if= {
				limit = { religion = khorne  }
				has_offmap_currency = {
					offmap = khorne_warp
					value >= 2500
				}				
			}			
			is_female = yes
			is_pregnant = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.0001 #Slow down
			}
			modifier = {
				factor = 100
				has_quest = quest_the_devil_worshipers_demonic_impregnation
			}
		}

		effect = {
			FROM = {
				increase_visibility_effect = yes
			}
			if = {
				limit = { is_devil_worshiper_trigger = yes }
				detract_society_currency_major_effect = yes
			}
			if = {
				limit = { religion = chaos }
				add_offmap_currency = {
					offmap = undivided_warp
					value = -2000
				}
			}			
			if = {
				limit = { religion = slaanesh }
				add_offmap_currency = {
					offmap = slaanesh_warp
					value = -1000
				}
			}
			if = {
				limit = { religion = tzeentch }
				add_offmap_currency = {
					offmap = tzeentch_warp
					value = -1000
				}
			}
			if = {
				limit = { religion = nurgle }
				add_offmap_currency = {
					offmap = nurgle_warp
					value = -1000
				}
			}
			if = {
				limit = { religion = khorne }
				add_offmap_currency = {
					offmap = khorne_warp
					value = -1000
				}
			}			
			hidden_effect = { #ROOT is target, FROM is doer
				FROM = {
					character_event = { id = DR_cults.7507 }
					
					add_character_modifier = {
						name = had_demonic_birth
						months = 60
					}	
				}
			}
		}
	}

	#Action: Prolong Life/Absorb Lifeforce
	chaos_prolong_life = {
		only_playable = yes

		filter = dynasty
		ai_target_filter = dynasty

		from_potential = {
			has_dlc = "Mystics"
			is_playable = yes
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			OR = {
				AND = {
				is_devil_worshiper_trigger = yes
				society_rank == 4
				}
			}
		}

		potential = {
			host = { character = FROM }
			is_child_of = FROM
			NOT = { age = 16 }
			NOT = { has_character_flag = demon_child_non_pagan }
		}

		allow = {
			FROM = { has_society_currency_major_trigger = yes }
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01 #Slow down
			}
			modifier = {
				factor = 10
				NOR = {
					has_character_modifier = stolen_life_minor
					has_character_modifier = stolen_life_medium
					has_character_modifier = stolen_life_major
				}
			}
			modifier = {
				factor = 0
				has_character_modifier = stolen_life_major
			}
		}

		effect = {
			FROM = { increase_visibility_effect = yes }
			FROM = { detract_society_currency_major_effect = yes }
			hidden_effect = { #ROOT is target, FROM is doer
				FROM = {
					character_event = { id = DR_cults.7509 }
				}
			}
		}
	}

	#Shallyans: Lay on Hands
	shallya_healing = {
		ai_check_interval = 12
		is_in_society = yes

		filter = self
		ai_target_filter = self

		potential = {
			has_dlc = "Mystics"
			society_member_of = cult_of_shallya
			society_rank >= 3
			NOR = {
				has_character_flag = shallya_healing_in_effect
				has_character_modifier = shallya_healing_recent
			}
		}

		allow = {
			has_society_currency_medium_trigger = yes
			custom_tooltip = {
				text = shallya_healing_tooltip
				OR = {

					has_disease_trigger = yes
					has_symptom_trigger = yes
					has_injury_trigger = yes
					is_maimed_trigger = yes
					trait = infirm
					trait = mangled
					trait = eunuch
					trait = blinded
					trait = incapable
				}
			}
		}
		effect = {
			character_event = { id = DR_societies.7118 days = 0 }
			detract_society_currency_medium_effect = yes
			set_character_flag = shallya_healing_in_effect
		}
		ai_will_do = {
			factor = 0.5
			modifier = {
				OR = {
					is_maimed_trigger = yes
					has_disease_trigger = yes
					trait = mangled
					trait = infirm
					trait = incapable
					trait = eunuch
				}
				factor = 2
			}
		}
	}

	#Shallyans: Self-Sacrifice
	shallyan_self_sacrifice = {
		ai_check_interval = 120
		is_in_society = yes

		filter = self
		ai_target_filter = self

		potential = {
			has_dlc = "Mystics"
			society_member_of = cult_of_shallya
			society_rank == 4
		}
		allow = {
			society_currency = 8000
		}
		effect = {
			character_event = {
				id = whs_shal.1
			}
		}
		ai_will_do = {
			factor = 10
		}
	}

	#Power: Demonic Possession
	chaos_cult_demonic_possession = {
		ai_check_interval = 12
		is_in_society = yes

		ai_target_filter = sub_realm

		from_potential = {
			is_devil_worshiper_trigger = yes
			society_rank > 1
		}

		potential = {
			OR = {
				host = { character = FROM }
				liege = { character = FROM }
			}
			NOT = { character = FROM }
			NOT = { trait = avatar_kurnous }
			NOT = { trait = avatar_isha }
			NOT = { trait = everqueen }
			OR = { trait = creature_elf
			trait = creature_chaos_dwarf
			trait = creature_dwarf
			trait = creature_human
			trait = creature_amazon
			trait = creature_beastman }
			is_vampire_trigger = no
		}

		allow = {
			FROM = {
				prisoner = no
				NOT = { trait = incapable }
				has_society_currency_minor_trigger = yes

				custom_tooltip = {
					text = is_accessible
					OR = {
						is_inaccessible_trigger = no
						AND = {
							FROM = {
								has_character_modifier = in_seclusion
								at_location = ROOT
							}
							ROOT = {
								has_character_modifier = in_seclusion
							}
						}
					}
				}
			}
			ROOT = {
				NOT = { trait = incapable }
				prisoner = yes
			}
		}

		effect = {
			# ROOT = {
				# set_character_flag = possessing_courtier
				# hidden_effect = {
					# character_event = { id = DR_cults.7840 days = 3 random = 7 }
				# }
			# }
			FROM = {
				detract_society_currency_minor_effect = yes
				increase_visibility_effect = yes
				character_event = { id = schaos.17 }
			}
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01 # slow down
			}
			modifier = {
				factor = 0.5
				is_benevolent_trigger = yes
			}
			modifier = {
				factor = 0.25
				ROOT = {
					is_landed = no
				}
			}
			modifier = {
				factor = 3
				ROOT = {
					among_most_powerful_vassals = 5
				}
			}
		}
	}

	#Action: satanist recruit
	khorne_recruit = {
		ai_check_interval = 12
		is_in_society = yes

		filter = all
		ai_target_filter = sub_realm

		from_potential = {
			OR = {
				ai = no
				ROOT = {
					ai = no
				}
			}
			society_member_of = cult_of_khorne
			OR = {
				ai = no
				society_rank = {
					society = cult_of_khorne
					rank == 2
				}
				society_rank = {
					society = cult_of_khorne
					rank == 3
				}
			}
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { has_character_modifier = recruitment_timer }
		}
		potential = {
			is_within_diplo_range = FROM
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			#Blocks so AI recruits sensible people (who might say no)
			NOT = { same_society_as = FROM }
			OR = {
				FROM = { ai = no }
				is_friend = FROM
				is_lover = FROM
				is_close_relative = FROM
				trait = trusting
				has_impious_trait_trigger = yes
				trait = drunkard
				trait = possessed
				trait = lunatic_1
				trait = lunatic_2
				trait = lunatic_3
				interested_in_society = cult_of_khorne
				#will join on own if able
				NOT = { secret_religion_group = chaos_gods_group }
			}
		}
		allow = {
			age = 16
			NOT = {
					trait = witch_hunter
				}
			NOR = {
				trait = creature_nehekharan
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
			}

			OR = {
				religion_group = old_world_group
				religion_group = ormazd_gods_group
				religion_group = oriental_gods_group
				religion = stromfels

			}
			OR = {
				trait = wroth
				trait = cruel
				trait = brave
				trait = duelist
				trait = hunter
				trait = impaler
				is_mutated_trigger = yes
			}
			is_inaccessible_trigger = no
			custom_tooltip = {
				text = satanists_recruit_block_tooltip
				OR = {
					NOT = { has_character_flag = khorne_attempted_recruitment }
					interested_in_society = cult_of_khorne
				}
				NOT = { has_character_flag = being_recruited_by_khorne }
			}
			FROM = {
				is_inaccessible_trigger = no
			}
		}
		effect = {
			set_character_flag = khorne_attempted_recruitment
			set_character_flag = being_recruited_by_khorne
			FROM = {
				save_event_target_as = chaos_cult_recruiter
			}
			hidden_effect = {
				character_event = { id = DR_cults.7001 days = 1 } # recruitment chain
				character_event = { id = DR_cults.7030 days = 365 } # sends delayed back up, in case recruitment fails somehow
				FROM = {
					if = {
						limit = { ai = yes }
						add_character_modifier = {
							name = recruitment_timer
							days = 730
							hidden = yes
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01 # slow down
			}
			modifier = {
				factor = 10 # recruit interested parties
				interested_in_society = cult_of_khorne
			}
		}
	}

	#Action: satanist recruit
	nurgle_recruit = {
		ai_check_interval = 12
		is_in_society = yes

		filter = all
		ai_target_filter = sub_realm

		from_potential = {
			OR = {
				ai = no
				ROOT = {
					ai = no
				}
			}
			society_member_of = cult_of_nurgle
			OR = {
				ai = no
				society_rank = {
					society = cult_of_nurgle
					rank == 2
				}
				society_rank = {
					society = cult_of_nurgle
					rank == 3
				}
			}
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { has_character_modifier = recruitment_timer }
		}
		potential = {
			is_within_diplo_range = FROM
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			#Blocks so AI recruits sensible people (who might say no)
			NOT = { same_society_as = FROM }
			OR = {
				FROM = { ai = no }
				is_friend = FROM
				is_lover = FROM
				is_close_relative = FROM
				trait = trusting
				has_impious_trait_trigger = yes
				trait = drunkard
				trait = possessed
				trait = lunatic_1
				trait = lunatic_2
				trait = lunatic_3
				interested_in_society = cult_of_nurgle
				#will join on own if able
				NOT = { secret_religion_group = chaos_gods_group }
			}
		}
		allow = {
			age = 16
			NOT = {
					trait = witch_hunter
				}
			NOR = {
				trait = creature_nehekharan
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
			}

			OR = {
				religion_group = old_world_group
				religion_group = ormazd_gods_group
				religion_group = oriental_gods_group
				religion = stromfels

			}
			OR = {
				trait = envious
				trait = kind
				trait = content
				trait = weak
				trait = infirm
				trait = sickly
				is_ill = yes
				is_mutated_trigger = yes
			}
			is_inaccessible_trigger = no
			custom_tooltip = {
				text = satanists_recruit_block_tooltip
				OR = {
					NOT = { has_character_flag = nurgle_attempted_recruitment }
					interested_in_society = cult_of_nurgle
				}
				NOT = { has_character_flag = being_recruited_by_nurgle }
			}
			FROM = {
				is_inaccessible_trigger = no
			}
		}
		effect = {
			set_character_flag = nurgle_attempted_recruitment
			set_character_flag = being_recruited_by_nurgle
			FROM = {
				save_event_target_as = chaos_cult_recruiter
			}
			hidden_effect = {
				character_event = { id = DR_cults.7001 days = 1 } # recruitment chain
				character_event = { id = DR_cults.7030 days = 365 } # sends delayed back up, in case recruitment fails somehow
				FROM = {
					if = {
						limit = { ai = yes }
						add_character_modifier = {
							name = recruitment_timer
							days = 730
							hidden = yes
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01 # slow down
			}
			modifier = {
				factor = 10 # recruit interested parties
				interested_in_society = cult_of_nurgle
			}
		}
	}

	tzeentch_recruit = {
		ai_check_interval = 12
		is_in_society = yes

		filter = all
		ai_target_filter = sub_realm

		from_potential = {
			OR = {
				ai = no
				ROOT = {
					ai = no
				}
			}
			society_member_of = cult_of_tzeentch
			OR = {
				ai = no
				society_rank = {
					society = cult_of_tzeentch
					rank == 2
				}
				society_rank = {
					society = cult_of_tzeentch
					rank == 3
				}
			}
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { has_character_modifier = recruitment_timer }
		}
		potential = {
			is_within_diplo_range = FROM
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			#Blocks so AI recruits sensible people (who might say no)
			NOT = { same_society_as = FROM }
			OR = {
				FROM = { ai = no }
				is_friend = FROM
				is_lover = FROM
				is_close_relative = FROM
				trait = trusting
				has_impious_trait_trigger = yes
				trait = drunkard
				trait = possessed
				trait = lunatic_1
				trait = lunatic_2
				trait = lunatic_3
				interested_in_society = cult_of_tzeentch
				#will join on own if able
				NOT = { secret_religion_group = chaos_gods_group }
			}
		}
		allow = {
			age = 16
			NOT = {
					trait = witch_hunter
				}
			NOR = {
				trait = creature_nehekharan
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
			}

			OR = {
				religion_group = old_world_group
				religion_group = ormazd_gods_group
				religion_group = oriental_gods_group
				religion = stromfels

			}
			OR = {
				trait = ambitious
				trait = cruel
				trait = deceitful
				trait = arbitrary
				trait = cynical
				trait = scholar
				trait = mystic
				is_mutated_trigger = yes
			}
			is_inaccessible_trigger = no
			custom_tooltip = {
				text = satanists_recruit_block_tooltip
				OR = {
					NOT = { has_character_flag = tzeentch_attempted_recruitment }
					interested_in_society = cult_of_tzeentch
				}
				NOT = { has_character_flag = being_recruited_by_tzeentch }
			}
			FROM = {
				is_inaccessible_trigger = no
			}
		}
		effect = {
			set_character_flag = tzeentch_attempted_recruitment
			set_character_flag = being_recruited_by_tzeentch
			FROM = {
				save_event_target_as = chaos_cult_recruiter
			}
			hidden_effect = {
				character_event = { id = DR_cults.7001 days = 1 } # recruitment chain
				character_event = { id = DR_cults.7030 days = 365 } # sends delayed back up, in case recruitment fails somehow
				FROM = {
					if = {
						limit = { ai = yes }
						add_character_modifier = {
							name = recruitment_timer
							days = 730
							hidden = yes
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01 # slow down
			}
			modifier = {
				factor = 10 # recruit interested parties
				interested_in_society = cult_of_tzeentch
			}
		}
	}

	slaanesh_recruit = {
		ai_check_interval = 12
		is_in_society = yes

		filter = all
		ai_target_filter = sub_realm

		from_potential = {
			OR = {
				ai = no
				ROOT = {
					ai = no
				}
			}
			society_member_of = cult_of_slaanesh
			OR = {
				ai = no
				society_rank = {
					society = cult_of_slaanesh
					rank == 2
				}
				society_rank = {
					society = cult_of_slaanesh
					rank == 3
				}
			}
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { has_character_modifier = recruitment_timer }
		}
		potential = {
			is_within_diplo_range = FROM
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			#Blocks so AI recruits sensible people (who might say no)
			NOT = { same_society_as = FROM }
			OR = {
				FROM = { ai = no }
				is_friend = FROM
				is_lover = FROM
				is_close_relative = FROM
				trait = trusting
				has_impious_trait_trigger = yes
				trait = drunkard
				trait = possessed
				trait = lunatic_1
				trait = lunatic_2
				trait = lunatic_3
				interested_in_society = cult_of_slaanesh
				#will join on own if able
				NOT = { secret_religion_group = chaos_gods_group }
			}
		}
		allow = {
			age = 16
			NOT = {
					trait = witch_hunter
				}
			NOR = {
				trait = creature_nehekharan
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
			}

			OR = {
				religion_group = old_world_group
				religion_group = ormazd_gods_group
				religion_group = oriental_gods_group
				religion = stromfels

			}
			OR = {
				trait = lustful
				trait = proud
				trait = gluttonous
				trait = greedy
				trait = cruel
				trait = hedonist
				trait = poet
				trait = impaler
				is_mutated_trigger = yes
			}
			is_inaccessible_trigger = no
			custom_tooltip = {
				text = satanists_recruit_block_tooltip
				OR = {
					NOT = { has_character_flag = slaanesh_attempted_recruitment }
					interested_in_society = cult_of_slaanesh
				}
				NOT = { has_character_flag = being_recruited_by_slaanesh }
			}
			FROM = {
				is_inaccessible_trigger = no
			}
		}
		effect = {
			set_character_flag = slaanesh_attempted_recruitment
			set_character_flag = being_recruited_by_slaanesh
			FROM = {
				save_event_target_as = chaos_cult_recruiter
			}
			hidden_effect = {
				character_event = { id = DR_cults.7001 days = 1 } # recruitment chain
				character_event = { id = DR_cults.7030 days = 365 } # sends delayed back up, in case recruitment fails somehow
				FROM = {
					if = {
						limit = { ai = yes }
						add_character_modifier = {
							name = recruitment_timer
							days = 730
							hidden = yes
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01 # slow down
			}
			modifier = {
				factor = 10 # recruit interested parties
				interested_in_society = cult_of_slaanesh
			}
		}
	}

	undivided_recruit = {
		ai_check_interval = 12
		is_in_society = yes

		filter = all
		ai_target_filter = sub_realm

		from_potential = {
			OR = {
				ai = no
				ROOT = {
					ai = no
				}
			}
			society_member_of = cult_of_undivided
			OR = {
				ai = no
				society_rank = {
					society = cult_of_undivided
					rank == 2
				}
				society_rank = {
					society = cult_of_undivided
					rank == 3
				}
			}
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { has_character_modifier = recruitment_timer }
		}
		potential = {
			is_within_diplo_range = FROM
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			#Blocks so AI recruits sensible people (who might say no)
			NOT = { same_society_as = FROM }
			OR = {
				FROM = { ai = no }
				is_friend = FROM
				is_lover = FROM
				is_close_relative = FROM
				trait = trusting
				has_impious_trait_trigger = yes
				trait = drunkard
				trait = possessed
				trait = lunatic_1
				trait = lunatic_2
				trait = lunatic_3
				interested_in_society = cult_of_undivided
				#will join on own if able
				NOT = { secret_religion_group = chaos_gods_group }
			}
		}
		allow = {
			age = 16
			NOT = {
					trait = witch_hunter
				}
			NOR = {
				trait = creature_nehekharan
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
			}

			OR = {
				religion_group = old_world_group
				religion_group = ormazd_gods_group
				religion_group = oriental_gods_group
				religion = stromfels

			}
			OR = {
				trait = ambitious
				trait = proud
				trait = gluttonous
				trait = greedy
				trait = cruel
				trait = wroth
				trait = cynical
				trait = mystic
				is_mutated_trigger = yes
			}
			is_inaccessible_trigger = no
			custom_tooltip = {
				text = satanists_recruit_block_tooltip
				OR = {
					NOT = { has_character_flag = undivided_attempted_recruitment }
					interested_in_society = cult_of_undivided
				}
				NOT = { has_character_flag = being_recruited_by_undivided }
			}
			FROM = {
				is_inaccessible_trigger = no
			}
		}
		effect = {
			set_character_flag = undivided_attempted_recruitment
			set_character_flag = being_recruited_by_undivided
			FROM = {
				save_event_target_as = chaos_cult_recruiter
			}
			hidden_effect = {
				character_event = { id = DR_cults.7001 days = 1 } # recruitment chain
				character_event = { id = DR_cults.7030 days = 365 } # sends delayed back up, in case recruitment fails somehow
				FROM = {
					if = {
						limit = { ai = yes }
						add_character_modifier = {
							name = recruitment_timer
							days = 730
							hidden = yes
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01 # slow down
			}
			modifier = {
				factor = 10 # recruit interested parties
				interested_in_society = cult_of_undivided
			}
		}
	}

	choose_chaos_cults_aspect = {
		is_in_society = yes

		filter = self
		ai_target_filter = self
		ai_check_interval = 12

		potential = {
			society_rank = 2
			is_devil_worshiper_trigger = yes
			has_chaos_cult_aspects_trait = NO
			prisoner = no
			NOT = { trait = incapable }
			character = FROM
			has_dlc = "Mystics"
		}

		allow = {
			has_society_currency_minor_trigger = yes
			custom_tooltip = {
				text = choose_chaos_cults_aspect_allow_tt
				NOT = { has_character_flag = choosing_chaos_cults_aspect }
			}
			OR = {
				custom_tooltip = {
					text = does_not_have_a_chaos_cult_aspects_trait_tt
					has_chaos_cult_aspects_trait = NO
				}
			}
		}

		effect = {
			character_event = { id = CC.10000 }
			set_character_flag = choosing_chaos_cults_aspect
			detract_society_currency_minor_effect = yes
		}

		revoke_allowed = { always = no }

		ai_will_do = {
			factor = 1
		}
	}
	chaos_cult_contain_yourself = {
		is_in_society = yes

		filter = self
		ai=no

		potential = {
			prisoner = no
			NOT = { trait = incapable }
			character = FROM
			has_dlc = "Mystics"
			society_rank = 2
			is_devil_worshiper_trigger = yes
			NOR={
				has_character_modifier=nurgle_contain2
				has_character_modifier=nurgle_contain
				has_character_modifier=khorne_contain
				has_character_modifier=khorne_contain2
				has_character_modifier=tzeentch_contain
				has_character_modifier=tzeentch_contain2
			}
		}

		allow = {
			has_society_currency_minor_trigger = yes
		}

		effect = {
			if={limit={society_member_of = cult_of_slaanesh }
				if={limit={society_rank==4}
					add_character_modifier = {
						modifier = tzeentch_contain2
						years = 1

					}
				}
				else={
					add_character_modifier = {
						modifier = tzeentch_contain
						years = 1

					}
				}
			}
			if={limit={society_member_of = cult_of_nurgle }
				if={limit={society_rank==4}
					add_character_modifier = {
						modifier = nurgle_contain2
						years = 1

					}
				}
				else={
					add_character_modifier = {
						modifier = nurgle_contain
						years = 1

					}
				}
			}
			if={limit={society_member_of = cult_of_khorne }
				if={limit={society_rank==4}
					add_character_modifier = {
						modifier = khorne_contain2
						years = 1

					}
				}
				else={
					add_character_modifier = {
						modifier = khorne_contain
						years = 1

					}
				}
			}
			if={limit={society_member_of = cult_of_tzeentch }
				if={limit={society_rank==4}
					add_character_modifier = {
						modifier = tzeentch_contain2
						years = 1

					}
				}
				else={
					add_character_modifier = {
						modifier = tzeentch_contain
						years = 1

					}
				}
			}
			if={limit={society_member_of = cult_of_undivided }
				if={limit={society_rank==4}
					add_character_modifier = {
						modifier = tzeentch_contain2
						years = 1

					}
				}
				else={
					add_character_modifier = {
						modifier = tzeentch_contain
						years = 1

					}
				}
			}
			detract_society_currency_minor_effect = yes
		}
		revoke_allowed = { always = no }

		ai_will_do = {
			factor = 1
		}
	}
	chaos_cult_free_yourself = {
		is_in_society = yes

		filter = self
		ai=no

		potential = {
			prisoner = no
			NOT = { trait = incapable }
			character = FROM
			has_dlc = "Mystics"
			society_rank = 2
			is_devil_worshiper_trigger = yes
			OR={
				has_character_modifier=nurgle_contain2
				has_character_modifier=nurgle_contain
				has_character_modifier=khorne_contain
				has_character_modifier=khorne_contain2
				has_character_modifier=tzeentch_contain
				has_character_modifier=tzeentch_contain2
			}
		}

		allow = {
			has_society_currency_minor_trigger = yes
		}

		effect = {
			remove_character_modifier=nurgle_contain
			remove_character_modifier=nurgle_contain2
			remove_character_modifier=khorne_contain
			remove_character_modifier=khorne_contain2
			remove_character_modifier=tzeentch_contain
			remove_character_modifier=tzeentch_contain2
			detract_society_currency_minor_effect = yes
		}
		revoke_allowed = { always = no }

		ai_will_do = {
			factor = 1
		}
	}
}

title_decisions = {
	chaos_cult_prepare_grounds = {
		ai_check_interval = 6
		only_playable = yes

		ai_target_filter = realm_owned
		filter = realm_owned

		from_potential = {
			society_rank > 2
			OR = {
				society_member_of = cult_of_khorne
				society_member_of = cult_of_nurgle
				society_member_of = cult_of_tzeentch
				society_member_of = cult_of_slaanesh
				society_member_of = cult_of_undivided
			}
		}

		potential = {
			tier = COUNT
			holder_scope = {
				same_realm = FROM
			}
			OR = {
				AND = {
					FROM = {
						society_member_of = cult_of_khorne
					}
					NOT = { location = { religion = khorne } }
					NOT = { location = { has_province_modifier = secret_khorne_community } }
				}
				AND = {
					FROM = {
						society_member_of = cult_of_nurgle
					}
					NOT = { location = { religion = nurgle } }
					NOT = { location = { has_province_modifier = secret_nurgle_community } }
				}
				AND = {
					FROM = {
						society_member_of = cult_of_tzeentch
					}
					NOT = { location = { religion = tzeentch } }
					NOT = { location = { has_province_modifier = secret_tzeentch_community } }
				}
				AND = {
					FROM = {
						society_member_of = cult_of_slaanesh
					}
					NOT = { location = { religion = slaanesh } }
					NOT = { location = { has_province_modifier = secret_slaanesh_community } }
				}
				AND = {
					FROM = {
						society_member_of = cult_of_undivided
					}
					NOT = { location = { religion = undivided } }
					NOT = { location = { has_province_modifier = secret_undivided_community } }
				}
			}
		}

		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes
			}
			custom_tooltip = {
				text = prepare_grounds_allow_tooltip
				hidden_trigger = {
					FROM = { NOT = { has_character_flag = preparing_grounds_in_@ROOT } }
				}
			}
		}

		effect = {
			location = {
				save_event_target_as = target_province
			}
			FROM = {
				society = {
					save_event_target_as = original_society
				}
				if = {
					limit = {
						ai = no
					}
					detract_society_currency_medium_effect = yes
				}
				custom_tooltip = {
					text = secret_religions_prepare_grounds_effect_tooltip
					character_event = { id = DR_cults.3850 days = 2 }
				}
			}
			FROM = {
				if = {
					limit = {
						is_society_grandmaster = yes
					}
					increase_visibility_minor_effect = yes
				}
				if = {
					limit = {
						NOT = { is_society_grandmaster = yes }
					}
					increase_visibility_effect = yes
				}
				set_character_flag = preparing_grounds_in_@ROOT
				character_event = { id = DR_cults.3849 days = 1200 }
			}
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
		}
	}
}

society_decisions = {
	chaos_cult_uprising = {
		ai_check_interval = 6
		is_high_prio = yes

		potential = {
			OR = {
				society_member_of = cult_of_khorne
				society_member_of = cult_of_nurgle
				society_member_of = cult_of_tzeentch
				society_member_of = cult_of_slaanesh
				society_member_of = cult_of_undivided
			}
			OR = {
				society_rank == 3
			society_rank == 4
			}
		}

		allow = {
			has_society_currency_major_trigger = yes
			NOR = {
				AND = {
					society_member_of = cult_of_khorne
					top_liege = {
						secret_religion = chaos_gods_group
						NOT = { secret_religion = khorne }
					}
				}
				AND = {
					society_member_of = cult_of_nurgle
					top_liege = {
						secret_religion = chaos_gods_group
						NOT = { secret_religion = nurgle }
					}
				}
				AND = {
					society_member_of = cult_of_tzeentch
					top_liege = {
						secret_religion = chaos_gods_group
						NOT = { secret_religion = tzeentch }
					}
				}
				AND = {
					society_member_of = cult_of_slaanesh
					top_liege = {
						secret_religion = chaos_gods_group
						NOT = { secret_religion = slaanesh }
					}
				}
				AND = {
					society_member_of = cult_of_undivided
					top_liege = {
						secret_religion = chaos_gods_group
						NOT = { secret_religion = chaos }
					}
				}
			}
		}

		effect = {
			detract_society_currency_major_effect = yes
			set_character_flag = cultist_uprising_leader
			spawn_unit = {
	                province = capital_scope
	                home = capital_scope
	                owner = ROOT
	                troops = {
						daemonic_host = { 1500 1500 }
	                }
	                attrition = 1
	                maintenance_multiplier = 0
	                reinforces = no
	        }
			if = {
			limit = {
				society_member_of = cult_of_khorne
				top_liege = {
					NOT = { society_member_of = cult_of_khorne }
				}
			}

			create_random_soldier = {
				random_traits = no
				dynasty = RANDOM
				culture = bloodletter_khorne
				religion = khorne
				age = 888
				attributes = {
					martial = 20
					diplomacy = 4
					stewardship = 5
					intrigue = 4
					learning = 3
				}
				health = 6
				fertility = 0.7
				trait = brilliant_strategist
				trait = wroth
				trait = cruel
				trait = proud
				trait = zealous
				trait = khorne_demon
				trait = khorne_bloodletter
			}
			new_character = {
				set_character_flag = host_demon_commander
				add_friend = ROOT	#familiar mechanics
			}
		}

		if = {
			limit = {
				society_member_of = cult_of_nurgle
				top_liege = {
					NOT = { society_member_of = cult_of_nurgle }
				}
			}

			create_random_soldier = {
				random_traits = no
				dynasty = RANDOM
				culture = plaguebearer_nurgle
				religion = nurgle
				age = 777
				attributes = {
					martial = 15
					diplomacy = 4
					stewardship = 5
					intrigue = 10
					learning = 3
				}
				health = 6
				fertility = 0.7
				trait = brilliant_strategist
				trait = wroth
				trait = lunatic_3
				trait = hedonist
				trait = cruel
				trait = zealous
				trait = nurgle_demon
				trait = nurgle_plaguebearer
			}
			new_character = {
				set_character_flag = host_demon_commander
				add_friend = ROOT	#familiar mechanics
			}
		}
		if = {
			limit = {
				society_member_of = cult_of_tzeentch
				top_liege = {
					NOT = { society_member_of = cult_of_tzeentch }
				}
			}

		create_random_soldier = {
			random_traits = no
			dynasty = RANDOM
			culture = flamer_tzeentch
			religion = tzeentch
			age = 999
			attributes = {
				martial = 15
				diplomacy = 4
				stewardship = 5
				intrigue = 30
				learning = 3
			}
			health = 6
			fertility = 0.7
			trait = brilliant_strategist
			trait = wroth
			trait = genius
			trait = mystic
			trait = cruel
			trait = zealous
			trait = tzeentch_demon
			trait = tzeentch_flamer
		}
		new_character = {
			set_character_flag = host_demon_commander
			add_friend = ROOT	#familiar mechanics
			}
		}

		if = {
			limit = {
				society_member_of = cult_of_slaanesh
				top_liege = {
					NOT = { society_member_of = cult_of_slaanesh }
				}
			}
			create_random_soldier = {
				random_traits = no
				dynasty = RANDOM
				culture = daemonette_slaanesh
				religion = slaanesh
				age = 666
				attributes = {
					martial = 15
					diplomacy = 4
					stewardship = 5
					intrigue = 10
					learning = 3
				}
				health = 6
				fertility = 0.7
				trait = brilliant_strategist
				trait = wroth
				trait = cruel
				trait = hedonist
				trait = lustful
				trait = zealous
				trait = slaanesh_demon
				trait = slaanesh_daemonette
			}
			new_character = {
				set_character_flag = host_demon_commander
				add_friend = ROOT	#familiar mechanics
			}
		}
		if = {
			limit = {
				society_member_of = cult_of_undivided
				top_liege = {
					NOT = { society_member_of = cult_of_undivided }
				}
			}
			create_random_soldier = {
				random_traits = no
				dynasty = RANDOM
				culture = bloodletter_khorne
				religion = khorne
				age = 888
				attributes = {
					martial = 20
					diplomacy = 4
					stewardship = 5
					intrigue = 4
					learning = 3
				}
				health = 6
				fertility = 0.7
				trait = brilliant_strategist
				trait = wroth
				trait = cruel
				trait = proud
				trait = zealous
				trait = khorne_demon
				trait = khorne_bloodletter
			}
			new_character = {
					set_character_flag = host_demon_commander
					add_friend = ROOT	#familiar mechanics
			}
		}
		custom_tooltip = {
				text = openly_adopt_faith_effect_tooltip
				hidden_effect = {
					character_event = { id = DR_cults.3811 }
					top_liege = {
						any_realm_character = {

							# if = {
								# limit = {
									# NOT = {
										# same_society_as = ROOT
									# }
									# OR = {
										# has_prevs_secret_religion_truly_trigger = yes
										# has_sympathy_for_true_religion_of_prev_trigger = yes
									# }
								# }
								# character_event = { id = DR_cults.3810 } # Allow sympathisers the chance to flip
							# }

							if = {
								limit = {
									is_ruler = yes
									any_demesne_province = {
										OR = {
											AND = {
												has_province_modifier = secret_khorne_community
												ROOT = {
													society_member_of = cult_of_khorne
												}
											}

											AND = {
												has_province_modifier = secret_nurgle_community
												ROOT = {
													society_member_of = cult_of_nurgle
												}
											}

											AND = {
												has_province_modifier = secret_tzeentch_community
												ROOT = {
													society_member_of = cult_of_tzeentch
												}
											}

											AND = {
												has_province_modifier = secret_slaanesh_community
												ROOT = {
													society_member_of = cult_of_slaanesh
												}
											}

											AND = {
												has_province_modifier = secret_undivided_community
												ROOT = {
													society_member_of = cult_of_undivided
												}
											}
										}
									}
								}
								character_event = { id = DR_cults.3820 } # Flip provinces with local cult modifier
							}
						}
					}

					flip_secret_religious_community_provinces = yes
					convert_to_secret_religion = yes
					remove_character_modifier = highly_suspect
					remove_character_modifier = under_suspicion
					if = {
						limit = {
							society_member_of = cult_of_khorne
						}
						religion = khorne
					}
					else_if = {
						limit = {
							society_member_of = cult_of_nurgle
						}
						religion = nurgle
					}
					else_if = {
						limit = {
							society_member_of = cult_of_undivided
						}
						religion = chaos
					}
					else_if = {
						limit = {
							society_member_of = cult_of_tzeentch
						}
						religion = tzeentch
					}
					else_if = {
						limit = {
						society_member_of = cult_of_slaanesh
						}
						religion = slaanesh
					}
					top_liege = {
						any_realm_lord = {
							character_event = { id = DR_cults.3830 } # Inform lieges unless they're part of the cult flipping, save a flag on previous events.
						}

						any_realm_character = {
							limit = {
								same_society_as = ROOT
							}
							convert_to_secret_religion = yes
							if = {
								limit = {
									society_member_of = cult_of_khorne
								}
								religion = khorne
							}
							else_if = {
								limit = {
									society_member_of = cult_of_nurgle
								}
								religion = nurgle
							}
							else_if = {
								limit = {
									society_member_of = cult_of_undivided
								}
								religion = chaos
							}
							else_if = {
								limit = {
									society_member_of = cult_of_tzeentch
								}
								religion = tzeentch
							}
							else_if = {
								limit = {
								society_member_of = cult_of_slaanesh
								}
								religion = slaanesh
							}
							leave_society = yes
						}

						any_realm_character = {
							limit = {
								has_character_flag = currently_part_of_secret_religion_uncovering
							}
							clr_character_flag = currently_part_of_secret_religion_uncovering
						}
					}
					remove_character_modifier = highly_suspect
					remove_character_modifier = under_suspicion
					leave_society = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.001 # Slow down
				independent = no
			}
			modifier = {
				factor = 0.1
				any_society_member = {
					NOT = { character = ROOT }
					same_realm = ROOT
					ai = no
					society_rank > 2
				}
			}
			modifier = {
				factor = 5
				top_liege = {
					war = yes
					any_war = {
						defender = { character = PREV }
						using_cb = cultist_bid_for_independence
					}
				}
			}
			modifier = {
				factor = 2
				top_liege = {
					ROOT = {
						realm_levy_diff = {
							who = PREV
							value >= 1000
						}
					}
				}
			}
			modifier = {
				factor = 2
				top_liege = {
					ROOT = {
						realm_levy_diff = {
							who = PREV
							value >= 2000
						}
					}
				}
			}
			modifier = {
				factor = 2
				top_liege = {
					ROOT = {
						realm_levy_diff = {
							who = PREV
							value >= 4000
						}
					}
				}
			}
			modifier = { #Don't do it unless you are confident in support
				factor = 0.1
				NOR = {
					realm_character_percent = {
						target = 0.3
						OR = {
							same_society_as = ROOT
							is_openly_of_prevs_secret_religion_trigger = yes
							secret_religion_group = chaos_gods_group
						}
					}
					AND = {
						realm_character_percent = {
							target = 0.25
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
						liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
					}
					AND = {
						realm_character_percent = {
							target = 0.20
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
						top_liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
						liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
					}
					AND = {
						realm_character_percent = {
							target = 0.15
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
						any_vassal = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
						top_liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
						liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
								secret_religion_group = chaos_gods_group
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.15
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.25
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.35
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.5
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.65
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}
			}
			modifier = {
				factor = 1.5
				top_liege = {
					any_vassal = {
						same_society_as = ROOT
						ai = no
						OR = {
							society_rank == 3
							society_rank == 4
						}
					}
				}
			}
		}
	}
	# Build a Library
	build_library = {
		ai_check_interval = 6
		only_playable = yes
		is_high_prio = yes

		potential = {
			has_dlc = "Mystics"
			OR={
				society_member_of = cult_of_tzeentch
				society_member_of = cult_of_verena
			}
			has_quest = quest_verena_build_library
			is_playable = yes
			block_general_event_trigger = no
			NOT = { has_character_flag = building_laboratory }
			NOT = { has_character_flag = built_laboratory }
		}
		allow = {
			wealth = 50
		}
		effect = {
			wealth = -50
			set_character_flag = building_laboratory
			custom_tooltip = { text = start_constructing_laboratory_tooltip }
			hidden_tooltip = { character_event = { id = DR_societies.1100 } }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0
				NOT = { wealth = 75 }
			}

			modifier = {
				factor = 0.1
				NOT = { age = 30 }
			}
		}
	}
	#Write a Theory Paper
	hermetics_write_theory_paper = {
		ai_check_interval = 6
		potential = {
			society_member_of = cult_of_tzeentch
		}

		allow = {
			prisoner = no
			custom_tooltip = {
				text = write_theory_paper_decision_cooldown_timer_tt
				hidden_trigger = {
					NOT = {
						has_character_modifier = write_theory_paper_decision_cooldown_timer
					}
				}
			}
			NOT = { is_inaccessible_trigger = yes }
			NOT = { trait = incapable }
		}

		effect = {
			custom_tooltip = {
				text = write_theory_paper_decision_effect_tt
				add_character_modifier = {
					modifier = write_theory_paper_decision_cooldown_timer
					years = 5
					hidden = yes
				}
				character_event = { id = DR_societies.1630 }
			}
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.001 # Slow down
			}
		}
	}
	#Power: write Magnum Opus
	hermetics_write_magnum_opus = {
		ai_check_interval = 24
		is_in_society = yes

		filter = self
		ai_target_filter = self

		potential = {
			OR={
				society_member_of = cult_of_tzeentch
				society_member_of = cult_of_verena
			}
			society_rank = 4
			prisoner = no
			NOT = { trait = incapable }
		}

		allow = {
			FROM = {
				custom_tooltip = {
					text = hermetics_wrote_magnum_opus_cd_tooltip
					NOT = { has_character_flag = wrote_magnum_opus }
				}
				has_society_currency_minor_trigger = yes
				custom_tooltip = {
					text = hermetics_wrote_magnum_opus_duplicate
					OR = {
    					NOR = {
    						has_artifact = magnum_opus_theurgy_ritual_1
							has_artifact = magnum_opus_theurgy_ritual_2
							has_artifact = magnum_opus_theurgy_ritual_3
							has_artifact = magnum_opus_theurgy_ritual_4
    					}
    					NOR = {
    						has_artifact = magnum_opus_theurgy_contemplation_1
							has_artifact = magnum_opus_theurgy_contemplation_2
							has_artifact = magnum_opus_theurgy_contemplation_3
							has_artifact = magnum_opus_theurgy_contemplation_4
    					}
    					NOR = {
    						has_artifact = magnum_opus_astrology_stars_1
							has_artifact = magnum_opus_astrology_stars_2
							has_artifact = magnum_opus_astrology_stars_3
							has_artifact = magnum_opus_astrology_stars_4
    					}
    					NOR = {
    						has_artifact = magnum_opus_astrology_planets_1
							has_artifact = magnum_opus_astrology_planets_2
							has_artifact = magnum_opus_astrology_planets_3
							has_artifact = magnum_opus_astrology_planets_4
    					}
    					NOR = {
    						has_artifact = magnum_opus_alchemy_panacea_1
							has_artifact = magnum_opus_alchemy_panacea_2
							has_artifact = magnum_opus_alchemy_panacea_3
							has_artifact = magnum_opus_alchemy_panacea_4
    					}
    					NOR = {
    						has_artifact = magnum_opus_alchemy_transmutation_1
							has_artifact = magnum_opus_alchemy_transmutation_2
							has_artifact = magnum_opus_alchemy_transmutation_3
							has_artifact = magnum_opus_alchemy_transmutation_4
    					}
    				}
    			}
			}
		}

		effect = {
			hidden_effect = {
				character_event = { id = DR_societies.1610 days = 1 }
				set_character_flag = wrote_magnum_opus
			}
			detract_society_currency_major_effect = yes
		}
		revoke_allowed = {
			always = no
		}
	}
}

decisions = {
	sleeper_agent_join_cult = {
		ai_check_interval = 60
		potential = {
			has_character_flag = chaos_cult_sleeper_agent
			secret_religion_group = chaos_gods_group
			ai = yes # Only the player should ever see this
		}
		allow = {
			OR = {
				AND = {
					secret_religion = khorne
					can_join_society = cult_of_khorne
				}
				AND = {
					secret_religion = nurgle
					can_join_society = cult_of_nurgle
				}
				AND = {
					secret_religion = tzeentch
					can_join_society = cult_of_tzeentch
				}
				AND = {
					secret_religion = slaanesh
					can_join_society = cult_of_slaanesh
				}
				AND = {
					secret_religion = chaos
					can_join_society = cult_of_undivided
				}
			}
		}
		effect = {
			trigger_switch = {
				on_trigger = secret_religion
				khorne = {
					join_society = cult_of_khorne
				}
				nurgle = {
					join_society = cult_of_nurgle
				}
				tzeentch = {
					join_society = cult_of_tzeentch
				}
				slaanesh = {
					join_society = cult_of_slaanesh
				}
				chaos = {
					join_society = cult_of_undivided
				}
			}
			if = {
				limit = {
					had_character_flag = {
						flag = money_from_the_pope
						years = 5
					}
				}
				add_society_currency_major_effect = yes
			}
			clr_character_flag = chaos_cult_sleeper_agent
		}
		ai_will_do = {
			factor = 1
		}
	}
}
