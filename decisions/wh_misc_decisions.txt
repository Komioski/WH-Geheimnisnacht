targetted_decisions = {
	#Cartography Decision, for new map modes
	choose_fake_map_mode = {
		only_playable = yes	# pre-trigger
		filter = self
		ai_target_filter = self	# but ai should not use this anyway

		from_potential = {
			ai = no
		}

		potential = {
			ai = no
		}

		allow = {
			always = yes
		}

		effect = {
			character_event = {	# Opens event to allow player to chose which map mode the steward action will display
				id = fabcart.1
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0
		}

	}

	#Brief non-aggression pact
	alliance_proposal = {
		ai_target_filter = independent_rulers
		ai_check_interval = 6 # Determines how seldom the AI checks whether they can and should do the decision, in months.
		only_playable = yes

		from_potential = {
			is_landed = yes
			OR = {
				ai = no
				independent = yes
			}
		}

		potential = {
			prisoner = no
			independent = yes
			NOT = { has_non_aggression_pact_with = FROM }
		}

		allow = {
			#These conditions are for ROOT.
			opinion = { who = FROM value = 75 }
			NOT = { has_non_aggression_pact_with = FROM }
			prisoner = no
			is_within_diplo_range = FROM
			custom_tooltip = {
				text = compatible_alliance_prop
				OR = {
					AND = {
						ROOT = {
							religion_group = old_world_group
						}
						FROM = {
							OR = {
								religion_group = old_world_group
								religion_group = dwarf_gods_group
								religion_group = cadai_group
							}
						}
					}
					AND = {
						ROOT = {
							religion_group = dwarf_gods_group
						}
						FROM = {
							OR = {
								religion_group = old_world_group
								religion_group = dwarf_gods_group
							}
						}
					}
					AND = {
						ROOT = {
							religion_group = FROM
						}
						FROM = {
							religion_group = ROOT
						}
					}
				}
			}
			custom_tooltip = {
				text = already_sent_alliance_prop
				NOT = { has_opinion_modifier = { who = FROM modifier = sent_alliance_prop } }
			}
		}

		effect = {
			opinion = {
				who = FROM
				modifier = sent_alliance_prop
				months = 6
			}
			letter_event = { id = Alliance.100 }
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0.1
		}

	}

	send_son_to_university = {
		filter = dynasty
		ai_target_filter = dynasty
		ai_check_interval = 6
		only_rulers = yes
		from_potential = {
			is_ruler = yes
			NOT = { trait = witch_hunter }
			NOR = {
				religion = grail
				religion = false_grail
			}
			trait = creature_human
			OR = {
				religion_group = old_world_group
				religion_group = ormazd_gods_group
			}
			OR = {
				location = { region = world_old_world }
				location = { region = world_greater_araby }
			}
			NOT = { is_tribal = yes }
			NOT = { is_nomadic = yes }
			prisoner = no
			NOT = {
				trait = incapable
			}
		}
		potential = {
			age = 16
			is_landed = no
			in_command = no
			prisoner = no
			is_incapacitated_trigger = no
			OR = {
				father = {
					character = FROM
				}
				mother = {
					character = FROM
				}
			}
			NOR = {
				has_character_flag = wants_educ_university
				trait = academic
				trait = arabyan_scholar
				# has_character_flag = wants_eng_university
				# trait = engineer
			}
			OR = { is_female = no
				FROM = { NOR = { religion = ormazd
						religion = kitabid } } }
			NOT = { trait = witch_hunter }
			NOR = {
				religion = grail
				religion = false_grail
			}
			trait = creature_human
			OR = {
				religion_group = old_world_group
				religion_group = ormazd_gods_group
			}
		}
		allow = {
			host = {
				character = FROM
			}
			OR = {
				father = {
					character = FROM
				}
				mother = {
					character = FROM
				}
			}
		}
		effect = {
			hidden_tooltip = {
				character_event = { id = DR_universities.31 }
				if = {
					limit = { FROM = {is_female = yes } }
					set_character_flag = mother_return_university
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
			# modifier = {
				# factor = 0.005 # Slow it down
			# }
		}
	}

	vassalize_new_elector = {
		ai = no  # "ai_target_filter = all" is expensive, so ai instead uses MTTH event ElectiveLeagues.40
        from_potential = {
            league_potential_trigger = yes
        }

        potential = {
            NOT = { character = FROM }
            league_potential_trigger = yes
        }

        allow = {
            FROM = {
                primary_title = {
                    has_law = succ_feudal_elective
                    is_titular = yes
                }

                # Sorry for the indent, players, but it gets the scopes correct for sharing scripted triggers
                ROOT = {
                    custom_tooltip = {
                        text = LOWER_RANK_THAN_US
                        lower_real_tier_than = PREV
                    }

                    THIS_can_be_elector_of_PREV_trigger = yes
                    THIS_can_join_PREV_league_trigger = yes
                    THIS_and_FROM_are_adjacent_trigger = yes

                    NOT = { has_opinion_modifier = { who = FROM  modifier = opinion_granted_independence } }
                }
            }
        }

        effect = {
            add_THIS_to_FROM_existing_league_effect = yes
        }

    }
}

decisions = {
	lizardmen_ships = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 3

		potential = {
			is_playable = yes
			culture_group = lizardman_group
			NOT = {
				has_earmarked_regiments = lizardmen_ships
			}
			#has_overseas_holdings = yes
		}
		allow = {
			war = yes
			prestige = 50
		}
		effect = {
			prestige = -50
			spawn_fleet = {
				province = closest # closest sea zone
				owner = ROOT
				disband_on_peace = yes
				maintenance_multiplier = 0.2
				earmark = lizardmen_ships
				troops =
				{
					galleys = { 100 100 }
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = {
					any_war = {
						OR = {
							defender = { character = ROOT }
							attacker = { character = ROOT }
						}
					}
				}
			}
		}
	}

	skaven_ships = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 3

		potential = {
			is_playable = yes
			culture_group = skaven_group
			NOT = {
				has_earmarked_regiments = skaven_ships
			}
			#has_overseas_holdings = yes
		}
		allow = {
			war = yes
			prestige = 50
		}
		effect = {
			prestige = -50
			spawn_fleet = {
				province = closest # closest sea zone
				owner = ROOT
				disband_on_peace = yes
				maintenance_multiplier = 0.1
				earmark = skaven_ships
				troops =
				{
					galleys = { 100 100 }
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = {
					any_war = {
						OR = {
							defender = { character = ROOT }
							attacker = { character = ROOT }
						}
					}
				}
			}
		}
	}

	restore_eternal_empire = {
		ai_check_interval = 6
		is_high_prio = yes
		only_playable = yes
		potential = {
			age = 16
			prisoner = no
			NOT = { trait = incapable }
			NOT = { has_global_flag = ee_restored }
			religion = myrmidian
			OR = {
				culture_group = estalian_group
				culture_group = tilean_group
			}
		}
		allow = {
			prestige = 1500
			OR = {
				has_landed_title = e_estalia
				has_landed_title = e_tilea
			}
			has_landed_title = c_magritta
			completely_controls = d_remas
			completely_controls = d_luccini
			completely_controls = d_bilbali
		}
		effect = {
			wealth = -500
			prestige = 500
			activate_title = { title = e_eternal_empire status = yes }
			hidden_tooltip = {
				k_astarios = { de_jure_liege = e_eternal_empire }
				k_cantonia = { de_jure_liege = e_eternal_empire }
				k_castillona = { de_jure_liege = e_eternal_empire }
				k_tigarre = { de_jure_liege = e_eternal_empire }
				k_obregon = { de_jure_liege = e_eternal_empire }
				k_calafina = { de_jure_liege = e_eternal_empire }
				k_tobaro = { de_jure_liege = e_eternal_empire }
				k_adriata = { de_jure_liege = e_eternal_empire }
				k_miragliano = { de_jure_liege = e_eternal_empire }
				k_trantio = { de_jure_liege = e_eternal_empire }
				k_remas = { de_jure_liege = e_eternal_empire }
				k_pavona = { de_jure_liege = e_eternal_empire }
				k_luccini = { de_jure_liege = e_eternal_empire }
				k_sartosa = { de_jure_liege = e_eternal_empire }
				k_monte_castello = { de_jure_liege = e_eternal_empire }
				k_verezzo = { de_jure_liege = e_eternal_empire }
				if = {
					limit = { has_landed_title = e_estalia }
					e_estalia = {
						any_direct_de_jure_vassal_title = {
							de_jure_liege = e_eternal_empire
						}
					}
				}
				if = {
					limit = { has_landed_title = e_tilea }
					e_tilea = {
						any_direct_de_jure_vassal_title = {
							de_jure_liege = e_eternal_empire
						}
					}
				}
			}
			primary_title = {
				e_eternal_empire = {
					grant_title = ROOT
					copy_title_laws = PREV
					copy_title_history = PREV
				}
			}
			hidden_tooltip = { e_eternal_empire = { make_primary_title = yes } }
			if = {
				limit = {
					OR = {
						has_landed_title = e_estalia
						e_estalia = { has_holder = no }
					}
				}
				e_estalia = { destroy_landed_title = THIS }
				activate_title = { title = e_estalia status = no }
			}
			if = {
				limit = {
					OR = {
						has_landed_title = e_tilea
						e_tilea = { has_holder = no }
					}
				}
				e_tilea = { destroy_landed_title = THIS }
				activate_title = { title = e_tilea status = no }
			}
			set_global_flag = ee_restored
			narrative_event = { id = DR_misc.1 tooltip = EVTTOOLTIPETERNALRESTORED }
		}
		ai_will_do = {
			factor = 1
		}
	}

	#Parade of the Idols ( Atruhayid )
	celebrate_atruhayid_festival = {
		ai_check_interval = 12
				is_high_prio = yes
				only_rulers = yes
                potential = {
                        is_ruler = yes
                        is_feudal = yes
                        prisoner = no

                        religion = atruhayid
                        NOT = { trait = incapable }
                        NOT = {
                                has_character_modifier = holding_atruhayid_feast
                        }
                        NOT = {
                                has_character_modifier = large_feast_timer
                        }
                        NOT = {
                                has_character_modifier = fabulous_feast
                        }
                        NOT = {
                                liege = {
                                        has_character_modifier = holding_atruhayid_feast
                                }
                        }
                        num_of_vassals = 1
                        NOT = { has_character_flag = do_not_disturb }
                }
                allow = {
			custom_tooltip = { text = IS_NOT_INCAPACITATED
					is_incapacitated_trigger = no }
                        war = no
                        any_demesne_title = {
                                is_occupied = no
                        }
                        prisoner = no
                        scaled_wealth = 0.2
                        month = 5
						NOT = { month = 9 }
                        prestige = 100
                }
                effect = {
                        scaled_wealth = -0.2
                        add_character_modifier = {
                                name = holding_atruhayid_feast
                                duration = 365
                        }
                        set_character_flag = recent_minor_decision
                        set_character_flag = do_not_disturb
                        hidden_tooltip = { character_event = { id = DR_misc.1500 } }
                }
                revoke_allowed = {
                        always = no
                }
                ai_will_do = {
                        factor = 0.1
                        modifier = {
                                factor = 0
                                NOT = {
                                        scaled_wealth = 2
                                }
                        }
                        modifier = {
                                factor = 0.5
                                trait = shy
                        }
                        modifier = {
                                factor = 0.5
                                NOT = { diplomacy = 10 }
                        }
                        modifier = {
                                factor = 0
                                has_character_flag = recent_minor_decision
                                NOT = {
                                        had_character_flag = {
                                                flag = recent_minor_decision
                                                days = 730
                                        }
                                }
                        }
                        modifier = {
                                factor = 0
                                NOT = { age = 30 }
                        }
                }
	}

	#Borderlands Prince Leagues
	#Only for human rulers inside the Borderlands region
	create_elective_league = {
		ai = no  # adjacency calculation is expensive, so ai instead uses MTTH event ElectiveLeagues.30
        potential = {
            OR = {
                real_tier = KING
                real_tier = DUKE
                real_tier = COUNT
            }
            league_potential_trigger = yes
        }

        allow = {
            is_feudal = yes
            # religion_allows_feudal_elective_trigger = yes
            any_independent_ruler = {
                THIS_and_PREV_same_rank_trigger = yes
                THIS_can_join_PREV_league_trigger = yes
                THIS_and_FROM_are_adjacent_trigger = yes
            }
        }

        effect = {
            custom_tooltip = {
                text = create_elective_league_effect
                hidden_tooltip = {
                    character_event = { id = DR_misc.1031 }
                }
            }
        }

    }

}

settlement_decisions = {
	cleanse_skaven_presence = {

		filter = owned
		ai_target_filter = owned
		is_high_prio = yes
		only_playable = yes

		potential = {
			FROM = {
				NOT = {
					trait = creature_skaven
				}
			}
			holder_scope = {
				character = FROM
			}
			dejure_liege_title = {
				holder_scope = {
					character = FROM
				}
			}
			location = { NOT = { region = world_underempire } }
			OR = {
				location = { has_province_modifier = skaven_burrows }
				location = { culture_group = skaven_group }
			}
		}
		allow = {
			FROM = {
				wealth = 40
			}
			NOT = { location = { has_province_modifier = hunting_skaven } }
			OR = {
				location = { has_province_modifier = skaven_burrows }
				location = { culture_group = skaven_group }
			}
		}
		effect = {
			hidden_tooltip = {
					FROM = { character_event = { id = DR_misc.1100 } }
				 	location = {
						add_province_modifier = {
							name = hunting_skaven
							duration = 60
							hidden = yes
						}
					}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1


		}
	}
}
