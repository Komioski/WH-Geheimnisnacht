##Events for Miscellaneous cultures and races
namespace = DR_misc
##Estalia & Tilea

#Eternal Empire restored
narrative_event = {
	id = DR_misc.1
	title = EVTNAMEDR_misc.1
	desc = EVTDESCDR_misc.1

	picture = GFX_evt_myrmidianwarrior

	is_triggered_only = yes

	option = {
		name = EVTOPTADR_misc.1
		hidden_tooltip = {
			primary_title = {
				any_direct_de_jure_vassal_title = {
					de_jure_liege = e_eternal_empire
				}
			}
		}
		add_trait = myrmidia_incarnate
		give_nickname = nick_the_glorious
	}
}

# Myrmidia Incarnate Trait Gained
character_event = {
	id = DR_misc.2

	hide_window = yes
	only_rulers = yes

	trigger = {
		has_global_flag = ee_restored
		has_landed_title = e_eternal_empire
		NOT = { trait = myrmidia_incarnate }
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = OK
		add_trait = myrmidia_incarnate
	}
}

# Myrmidia Incarnate Trait Lost
character_event = {
	id = DR_misc.3

	hide_window = yes

	trigger = {
		has_global_flag = ee_restored
		trait = myrmidia_incarnate
		NOT = { has_landed_title = e_eternal_empire }
		is_alive = yes
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = OK
		remove_trait = myrmidia_incarnate
	}
}

################################################
# MYRMIDIAN HIGH TEMPLE GRANTING
################################################

### Magritta

# Magritta Re-Established
character_event = {
	id = DR_misc.200

	hide_window = yes
	religion = myrmidian
	only_rulers = yes

	trigger = {
		has_landed_title = b_inquisitoria_general
		is_theocracy = yes
		NOT = { has_landed_title = d_high_temple_of_magritta }
		religion = myrmidian
		OR = {
			independent = yes
			top_liege = {
				higher_real_tier_than = DUKE
				religion = ROOT
			}
		}
	}

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		any_liege = {
			limit = { tier = EMPEROR }
			save_event_target_as = new_liege
		}
		any_liege = {
			limit = { tier = KING }
			save_event_target_as = new_liege
		}
		d_high_temple_of_magritta = { grant_title = ROOT }
		set_defacto_liege = event_target:new_liege
		if = {
			limit = {
				k_cult_of_myrmidia = {
					holder_scope = {
							NOT = { has_landed_title = d_high_temple_of_magritta }
							NOT = { has_landed_title = d_high_temple_of_remas }
						}
				}
			}
			any_liege = {
				limit = { tier = EMPEROR }
				save_event_target_as = new_liege
			}
			k_cult_of_myrmidia = { holder_scope = { grant_title = d_high_temple_of_magritta } }
			k_cult_of_myrmidia = { holder_scope = { grant_title = b_inquisitoria_general } }
			set_defacto_liege = event_target:new_liege
		}
	}
}

# Magritta De-Established
character_event = {
	id = DR_misc.201

	hide_window = yes
	only_playable = yes

	trigger = {
		has_landed_title = d_high_temple_of_magritta
		OR = {
			NOT = { has_landed_title = b_inquisitoria_general }
			is_theocracy = no
			NOT = {
				religion = myrmidian
			}
		}
	}

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		d_high_temple_of_magritta = { unsafe_destroy_landed_title = THIS }
	}
}

### Remas

# Remas Re-Established
character_event = {
	id = DR_misc.202

	hide_window = yes
	religion = myrmidian
	only_rulers = yes

	trigger = {
		has_landed_title = b_matermyrmidia
		is_theocracy = yes
		NOT = { has_landed_title = d_high_temple_of_remas }
		religion = myrmidian
		OR = {
			independent = yes
			top_liege = {
				higher_real_tier_than = DUKE
				religion = ROOT
			}
		}
	}

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		any_liege = {
			limit = { tier = EMPEROR }
			save_event_target_as = new_liege
		}
		any_liege = {
			limit = { tier = KING }
			save_event_target_as = new_liege
		}
		d_high_temple_of_remas = { grant_title = ROOT }
		set_defacto_liege = event_target:new_liege
		if = {
			limit = {
				k_cult_of_myrmidia = {
					holder_scope = {
							NOT = { has_landed_title = d_high_temple_of_magritta }
							NOT = { has_landed_title = d_high_temple_of_remas }
						}
				}
			}
			any_liege = {
				limit = { tier = EMPEROR }
				save_event_target_as = new_liege
			}
			k_cult_of_myrmidia = { holder_scope = { grant_title = d_high_temple_of_remas } }
			k_cult_of_myrmidia = { holder_scope = { grant_title = b_matermyrmidia } }
			set_defacto_liege = event_target:new_liege
		}
	}

	option = {
		name = OK
	}
}

# Remas De-Established
character_event = {
	id = DR_misc.203

	hide_window = yes
	only_playable = yes

	trigger = {
		has_landed_title = d_high_temple_of_remas
		OR = {
			NOT = { has_landed_title = b_matermyrmidia }
			is_theocracy = no
			NOT = {
				religion = myrmidian
			}
		}
	}

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		d_high_temple_of_remas = { unsafe_destroy_landed_title = THIS }
	}

	option = {
		name = OK
	}
}


#Miyan Eat People
#Miyan cannibalize prisoner ( Jailor )
character_event = {
	id = DR_misc.500
	desc = EVTDESC_DR_misc_miyan_eat_guy
	picture = GFX_evt_spymaster

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_misc_miyan_eat_guy
			remove_opinion = { who = FROM modifier = opinion_traitor }
			remove_opinion = { who = FROM modifier = opinion_rebel_traitor }
			remove_opinion = { who = FROM modifier = opinion_dishonorable }
			piety = 20
			if = {
				limit = {
					NOT = { trait = zealous }
				}
				random = {
					chance = 10
					add_trait = zealous
					}
			}
		hidden_tooltip = {
			FROM = { character_event = { id = DR_misc.501 } }
		}
		ai_chance = { factor = 1000 }
	}
}

#Miyan cannibalize prisoner ( Jailed )
character_event = {
	id = DR_misc.501
	desc = EVTDESC_DR_misc_miyan_eaten_guy
	picture = GFX_evt_spymaster

	is_triggered_only = yes

	option = {
		name = OK
		if = {
 limit = {
 is_invincible_trigger = yes
 }

			antideath_effect = yes
			break = yes
}
				death = { death_reason = death_sacrificed killer = FROM }
				if = {
					limit = { is_close_relative = FROM }
					FROM = { add_trait = kinslayer }
				}
				if = {
					limit = {
						trait = khemri_tomb_king
					}
					character_event = { id = snehekharan.1 days = 1 }
					break = yes
				}
				if = {
					limit = {
						has_artifact = carstein_ring
					}
					character_event = { id = carstein.13 days = 1 }
					break = yes
				}
				hidden_tooltip = {
					# FROM = {
						# any_vassal = {
							# limit = { religion = cadai }
							# opinion = {
									# modifier = opinion_barbaric
									# who = FROM
							# }
						# }
					# }
					any_dynasty_member = {
							limit = { religion_group = cytharai_group }
								opinion = {
									modifier = opinion_eaten_family_druchii
									who = FROM
								}
					}
					any_dynasty_member = {
						limit = {
							NOT = { religion_group = cytharai_group }
						}
								opinion = {
									modifier = opinion_eaten_family
									who = FROM
								}
					}
				}
	}
}

##Other Stuff
#Win a war ( Ambiton )
character_event = {
	id = DR_misc.1000

	hide_window = yes
	is_triggered_only = yes

	trigger = {
		FROM = {
			has_ambition = obj_win_war
			NOT = { has_character_flag = obj_win_war_won_war }
		}
	}

	option = {
		name = OK
		FROM = {
			set_character_flag = obj_win_war_won_war
		}
	}
}


#Special localisations for some titles ( Elector-Counts, Everqueen ), on_new_holder
character_event = {
	id = DR_misc.1001

	hide_window = yes
	only_rulers = yes
	is_triggered_only = yes

	trigger = {
		FROM = {
			tier = KING
			OR = {
				title = k_reikland
				title = k_averland
				title = k_hochland
				title = k_middenland
				title = k_nordland
				title = k_ostermark
				title = k_ostland
				title = k_stirland
				title = k_sylvania
				title = k_talabecland
				title = k_westerland
				title = k_wissenland
				title = k_avelorn
			}
		}
		tier = KING
		primary_title = {
			title = FROM
		}
		OR = {
			AND = {
				trait = creature_human
				FROM = {
					OR = {
						title = k_reikland
						title = k_averland
						title = k_hochland
						title = k_middenland
						title = k_nordland
						title = k_ostermark
						title = k_ostland
						title = k_stirland
						title = k_sylvania
						title = k_talabecland
						title = k_westerland
						title = k_wissenland
					}
				}
			}
			AND = {
				trait = creature_elf
				is_female = yes
				FROM = {
					title = k_avelorn
				}
			}
		}
	}

	immediate = {
		if = {
			limit = { FROM = { title = k_reikland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_PRINCE
					remove_special_character_title = GRAND_PRINCESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_PRINCE
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_PRINCESS
			}
		}
		if = {
			limit = { FROM = { title = k_averland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_COUNT
					remove_special_character_title = GRAND_COUNTESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_COUNT
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_COUNTESS
			}
		}
		if = {
			limit = { FROM = { title = k_hochland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_BARON
					remove_special_character_title = GRAND_BARONESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_BARON
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_BARONESS
			}
		}
		if = {
			limit = { FROM = { title = k_middenland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_DUKE
					remove_special_character_title = GRAND_DUCHESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_DUKE
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_DUCHESS
			}
		}
		if = {
			limit = { FROM = { title = k_nordland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_BARON
					remove_special_character_title = GRAND_BARONESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_BARON
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_BARONESS
			}
		}
		if = {
			limit = { FROM = { title = k_ostermark } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = CHANCELLOR
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = CHANCELLOR
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = CHANCELLOR
			}
		}
		if = {
			limit = { FROM = { title = k_ostland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_PRINCE
					remove_special_character_title = GRAND_PRINCESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_PRINCE
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_PRINCESS
			}
		}
		if = {
			limit = { FROM = { title = k_stirland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_COUNT
					remove_special_character_title = GRAND_COUNTESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_COUNT
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_COUNTESS
			}
		}
		if = {
			limit = { FROM = { title = k_talabecland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_DUKE
					remove_special_character_title = GRAND_DUCHESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_DUKE
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_DUCHESS
			}
		}
		if = {
			limit = { FROM = { title = k_wissenland } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_COUNT
					remove_special_character_title = GRAND_COUNTESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_COUNT
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_COUNTESS
			}
		}
		if = {
			limit = { FROM = { title = k_sylvania } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = GRAND_COUNT
					remove_special_character_title = GRAND_COUNTESS
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = GRAND_COUNT
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = GRAND_COUNTESS
			}
		}
		if = {
			limit = { FROM = { title = k_avelorn } }
			FROMFROM = {
				if = {
					limit = { is_alive = yes }
					remove_special_character_title = EVERKING #Wot?
					remove_special_character_title = EVERQUEEN
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = EVERKING
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = EVERQUEEN
			}
		}
		if = {
			limit = {
				FROM = {
					# is_theocracy = yes
					trait = creature_slann
				}
			}
			# FROMFROM = {
				# if = {
					# limit = { is_alive = yes }
					# remove_special_character_title = MAGE_PRIEST
				# }
			# }
			set_special_character_title = MAGE_PRIEST
		}
		# if = {
			# limit = {
				# FROM = {
					# trait = chaos_dwarf_sorcerer
				# }
			# }
			# if = {
				# limit = { is_female = no }
				# set_special_character_title = SORCERER_PROPHET
			# }
			# if = {
				# limit = { is_female = yes }
				# set_special_character_title = SORCERESS_PROPHET
			# }
		# }

		if = {
			limit = {
				OR = {
					religion = atruhayid_reformed
					religion = atruhayid
				}
				OR = {
					government = feudal_government
					government = muslim_government
				}
				capital_scope = {
					port = yes
				}
				FROM = {
					tier = COUNT
				}
			}
			set_special_character_title = CORSAIR
		}
		if = {
			limit = {
				OR = {
					religion = atruhayid_reformed
					religion = atruhayid
				}
				OR = {
					government = feudal_government
					government = muslim_government
				}
				capital_scope = {
					port = yes
				}
				FROM = {
					tier = DUKE
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = CORSAIR_LORD
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = CORSAIR_LADY
			}
		}
		if = {
			limit = {
				OR = {
					religion = atruhayid_reformed
					religion = atruhayid
				}
				OR = {
					government = feudal_government
					government = muslim_government
				}
				capital_scope = {
					port = yes
				}
				FROM = {
					tier = KING
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = CORSAIR_PRINCE
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = CORSAIR_PRINCESS
			}
		}
		if = {
			limit = {
				OR = {
					religion = atruhayid_reformed
					religion = atruhayid
				}
				OR = {
					government = feudal_government
					government = muslim_government
				}
				capital_scope = {
					port = yes
				}
				FROM = {
					tier = EMPEROR
				}
			}
			if = {
				limit = { is_female = no }
				set_special_character_title = CORSAIR_KING
			}
			if = {
				limit = { is_female = yes }
				set_special_character_title = CORSAIR_QUEEN
			}
		}

	}

	option = {
		name = "OK"
	}
}

#Sailing the Mists of Albion
character_event = {
	id = DR_misc.1002
	hide_window = yes

	is_triggered_only = yes

	has_global_flag = mists_of_albion

	trigger = {
		location = {
			OR = {
				province_id = 1868
				province_id = 1938
				province_id = 1912
				province_id = 1865
				province_id = 2074
			}
		}
		OR = {
			location = {
				province_id = 1868
			}
			NAND = {
				OR = {
					religion = old_faith
					religion = old_faith_reformed
				}
				culture_group = albion_group
			}
		}
	}

	immediate = {
		if = {
			limit = {
				AND = {
					OR = {
						religion = old_faith
						religion = old_faith_reformed
					}
					culture_group = albion_group
				}
			}
			any_army = {
				limit = {
					location = { province_id = 1868 }
				}
				troops = -1.00
			}
			liege = {
				any_army = {
					limit = {
						location = { province_id = 1868 }
					}
					troops = -1.00
				}
			}
		}
		else = {
			any_army = {
				limit = {
					location = {
						OR = {
							province_id = 1868
							province_id = 1938
							province_id = 1912
							province_id = 1865
							province_id = 2074
						}
					}
				}
				troops = -1.00
			}
			liege = {
				any_army = {
					limit = {
						location = {
							OR = {
								province_id = 1868
								province_id = 1938
								province_id = 1912
								province_id = 1865
								province_id = 2074
							}
						}
					}
					troops = -1.00
				}
			}
		}
		if = {
			limit = {
				ai = no
				NOT = { has_character_flag = pleasestopalbionwarning }
			}
			character_event = { id = DR_misc.1003 }
		}
		liege = {
			if = {
				limit = {
					ai = no
					NOT = { has_character_flag = pleasestopalbionwarning }
				}
				character_event = { id = DR_misc.1003 }
			}
		}
	}

}

#followup event to army owner
character_event = {
	id = DR_misc.1003
	picture = GFX_evt_ship_storm
	is_triggered_only = yes
	desc = EVTDESC_DR_misc_albion_mists_sink_ship

	option = {
		name = EVTOPTA_DR_misc_albion_mists_sink_ship
	}

	option = {
		name = EVTOPTB_DR_misc_albion_mists_sink_ship
		set_character_flag = pleasestopalbionwarning
	}
}

#The Mists of Albion are lifted
narrative_event = {
	id = DR_misc.103
	picture = GFX_evt_albion_discovered
	title = EVTTITLE_DR_misc_mists_of_albion
	desc = EVTDESC_DR_misc_mists_of_albion
	is_triggered_only = yes

	major = yes

	only_playable = yes
	ai = no

	trigger = {
		has_global_flag = mists_of_albion
		NOT = { has_global_flag = mists_of_albion_cleared }
		OR = {
			year = 2305
			is_doom_very_high_trigger = yes
		}
	}

	immediate = {
		clr_global_flag = mists_of_albion
		set_global_flag = mists_of_albion_cleared
	}

	option = {
		name = EVTOPTA_DR_misc_mists_of_albion
	}

}



#ADAPTED FROM "Elective Leagues" BY JRUDERMAN http://steamcommunity.com/sharedfiles/filedetails/?id=637603578&searchtext=
#ALL CREDIT TO HIM
#Border Princes Leagues 1030-
# AI ruler tries to create a new league
character_event = {
    id = DR_misc.1030
    hide_window = yes

	is_triggered_only = yes

    trigger = {
        ai = yes  # Players instead use a similar decision, create_elective_league
        OR = {
            real_tier = KING
            real_tier = DUKE
            real_tier = COUNT
        }
        is_feudal = yes
        league_potential_trigger = yes
        religion_allows_feudal_elective_trigger = yes
    }

    immediate = {
        character_event = { id = DR_misc.1031 }
    }
}


# ROOT tries to create a new league (players from decision; AI from event DR_misc.1030)
character_event = {
    id = DR_misc.1031
    is_triggered_only = yes
    hide_window = yes

    immediate = {

        #any_opinion_modifier_target = {
        #    limit = {
        #        reverse_has_opinion_modifier = {
        #            who = PREV
        #            modifier = opinion_cofounder
        #        }
        #    }
        #    reverse_remove_opinion = {
        #        who = PREV
        #        modifier = opinion_cofounder
        #    }
        #}

        set_variable = { which = num_cofounders  value = 0 }
        character_event = { id = DR_misc.1032 }  # Find recursively-adjacent cofounders
        character_event = { id = DR_misc.1035 }  # Show list of cofounders; allow creating a higher title if >=2
    }
}

# ROOT is counting cofounders (recursive). Realms adjacent to FROM are now eligible to join.
character_event = {
    id = DR_misc.1032
    is_triggered_only = yes
    hide_window = yes
    #desc = ElectiveLeagues_event_32_DESC

    immediate = {
        any_independent_ruler = {
            limit = {
                # Not already in ROOT's league
                NOT = { character = ROOT }
                NOT = { reverse_has_opinion_modifier = { who = PREV  modifier = opinion_cofounder } }

                # Can join ROOT's league...
                THIS_and_PREV_same_rank_trigger = yes
                THIS_can_join_PREV_league_trigger = yes

                # ...by virtue of being adjacent to FROM (who could be ROOT or another cofounder)
                THIS_and_FROM_are_adjacent_trigger = yes
            }

            ROOT = { change_variable = { which = num_cofounders  value = 1 } }
            reverse_opinion = { who = PREV  modifier = opinion_cofounder }
            # character_event = { id = DR_misc.1033 }  # Bounce back here with THIS as FROM
        }
    }

    option = {
        name = OK
    }
}

# Bounce event
# character_event = {
    # id = DR_misc.1033
    # is_triggered_only = yes
    # hide_window = yes

    # immediate = {
        # FROM = {
            # character_event = { id = DR_misc.1032 }
        # }
    # }
# }

# ROOT has counted their cofounders and may be able to create a new elective realm
character_event = {
    id = DR_misc.1035
    is_triggered_only = yes
    desc = ElectiveLeagues_event_35_DESC
    picture = GFX_evt_coronation

    option = {
        trigger = {
            tier = COUNT
            check_variable = { which = num_cofounders  value = 1 }
        }
        name = ElectiveLeagues_event_35_DUCHY
        ai_chance = { factor = 90 }

        primary_title = {
            create_title = {
                tier = DUKE
                landless = no
                temporary = no
                custom_created = yes
                culture = ROOT
                holder = ROOT
                base_title = THIS
                copy_title_laws = yes
                name = ELECTIVE_REALM_NAME_DUKE
            }
        }
        create_league_effect = yes
    }

    option = {
        trigger = {
            tier = DUKE
            check_variable = { which = num_cofounders  value = 1 }
        }
        name = ElectiveLeagues_event_35_KINGDOM
        ai_chance = { factor = 90 }

        primary_title = {
            create_title = {
                tier = KING
                landless = no
                temporary = no
                custom_created = yes
                culture = ROOT
                holder = ROOT
                base_title = THIS
                copy_title_laws = yes
                name = ELECTIVE_REALM_NAME_KING
            }
        }

        create_league_effect = yes
    }

    option = {
        trigger = {
            tier = KING
            check_variable = { which = num_cofounders  value = 1 }
        }
        name = ElectiveLeagues_event_35_EMPIRE
        ai_chance = { factor = 90 }

        primary_title = {
            create_title = {
                tier = EMPEROR
                landless = no
                temporary = no
                custom_created = yes
                culture = ROOT
                holder = ROOT
                base_title = THIS
                copy_title_laws = yes
                name = ELECTIVE_REALM_NAME_EMPEROR
            }
        }

        create_league_effect = yes
    }

    option = {
        name = ElectiveLeagues_event_35_NEVER_MIND
        ai_chance = { factor = 10 }

        any_opinion_modifier_target = {
            limit = {
                reverse_has_opinion_modifier = {
                    who = PREV
                    modifier = opinion_cofounder
                }
            }
            hidden_tooltip = {
                reverse_remove_opinion = {
                    who = PREV
                    modifier = opinion_cofounder
                }
            }
        }
    }
}


# AI ruler of an elective league tries to vassalize more neighbors
character_event = {
    id = DR_misc.1040
    hide_window = yes

    trigger = {
        ai = yes  # Players instead use a targeted decision, vassalize_new_elector

        higher_real_tier_than = COUNT
        independent = yes
        in_revolt = no

        primary_title = {
            has_law = succ_feudal_elective
            is_titular = yes
        }
    }

    mean_time_to_happen = {
        years = 1
    }

    immediate = {
        any_independent_ruler = {
            limit = {
                NOT = { character = ROOT }
                league_potential_trigger = yes
                lower_real_tier_than = PREV
                THIS_can_be_elector_of_PREV_trigger = yes
                THIS_can_join_PREV_league_trigger = yes
                THIS_and_FROM_are_adjacent_trigger = yes  # Hoping FROM is treated as ROOT when no FROM...
                NOT = { has_opinion_modifier = { who = ROOT  modifier = opinion_granted_independence } }
            }

            character_event = { id = DR_misc.1046 }
        }
    }
}

# ROOT is asked by FROM to join an existing elective league
# Triggered by AI event DR_misc.1040
# Player decision vassalize_new_elector does NOT use this event because FROMFROM and interaction description
# Todo: add option to players to decline, a persistent opinion modifier for having declined, and a way to undo it...
character_event = {
    id = DR_misc.1046
    desc = WELCOME_TO_EXISTING_LEAGUE
    picture = GFX_evt_coronation  # ...
    is_triggered_only = yes

    option = {
        name = OK
        add_THIS_to_FROM_existing_league_effect = yes
    }
	option = {
		name = NOT_NOW
		opinion = { modifier = rejected_league_prop }
	}
}


##For testing |wipe_council_effect|
#character_event = {
#    id = DR_misc.1060
#    is_triggered_only = yes
#    hide_window = yes
#
#    immediate = {
#        wipe_council_effect = yes
#    }
#}


# Liege: fund expedition?
character_event = {
	id = DR_misc.1100
	desc = EVTDESCADR_skaven_cleansing_marshal_liege
	picture = GFX_evt_skaven_war
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_skaven_cleansing_marshal_liege
			wealth = -35
			prestige = 100
			hidden_tooltip = {
				random_list = {
					80 = {
						modifier = {
							#Almost impossible in the Underempire
							factor = 0.2
							FROM = { location = { region = world_underempire } }
						}
						character_event = { id = DR_misc.1101 days = 25 random = 25 }
					}
					20 = {
						modifier = {
							#Almost impossible in the Underempire
							factor = 4
							FROM = { location = { region = world_underempire } }
						}
						character_event = { id = DR_misc.1102 days = 25 random = 25 }
					}
				}
			}
		ai_chance = { factor = 1 }

	}
	option = {
		name = EVTOPTB_skaven_cleansing_marshal_liege
		prestige = -50
		ai_chance = { factor = 0 }

	}
}

# Liege: success
character_event = {
	id = DR_misc.1101
	desc = EVTDESC_skaven_cleansing_success
	picture = GFX_evt_skaven_war
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_skaven_cleansing_success
			hidden_tooltip = {
			FROMFROM = { location = { remove_province_modifier = skaven_burrows } }
			FROMFROM = { refill_holding_levy = yes }
				if = { limit = {
							NOR = {
								trait = creature_nehekharan
								culture = blooddragons_culture
								culture = witchhunter_culture
								culture = living_jade
							}
							FROMFROM = {
								location = { culture_group = skaven_group }
							} }
							FROMFROM = { location = { religion = ROOT
										culture = ROOT } }
						}
					}
			hidden_tooltip = { if = { limit = { trait = creature_nehekharan
							FROMFROM = {
								location = { culture_group = skaven_group }
							} }
							FROMFROM = {
								location = {
									culture = nehekka
									religion = atruhayid
								}
							}
						}
					}
			hidden_tooltip = { if = { limit = { culture = living_jade
							FROMFROM = {
								location = { culture_group = skaven_group }
							} }
							FROMFROM = {
								location = {
									culture = lizardman_lost
									religion = vampiric
								}
							}
						}
					}
				hidden_tooltip = {
					if = {
							limit = {
								culture = blooddragons_culture
								FROMFROM = {
									location = { culture_group = skaven_group }
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_empire }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_border_princes }
									}
								}
								FROMFROM = {
									location = {
										culture = neueslander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_kislev }
									}
								}
								FROMFROM = {
									location = {
										culture = kislevite
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_bretonnia }
									}
								}
								FROMFROM = {
									location = {
										culture = nortagnese
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_estalia }
									}
								}
								FROMFROM = {
									location = {
										culture = astur
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_tilea }
									}
								}
								FROMFROM = {
									location = {
										culture = reman
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_badlands_strygos }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_badlands_magnata }
									}
								}
								FROMFROM = {
									location = {
										culture = myken
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_greater_araby_araby }
									}
								}
								FROMFROM = {
									location = {
										culture = ramaccan
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_greater_araby_southlands }
									}
								}
								FROMFROM = {
									location = {
										culture = wasai
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_nehekhara }
									}
								}
								FROMFROM = {
									location = {
										culture = nehekka
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_norsca }
									}
								}
								FROMFROM = {
									location = {
										culture = aesling
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_karaz_ankor }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_darklands_plains_of_bones }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_darklands_ankor_naggrund }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_darklands_blasted_wastes }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_drak_ankor }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_ulthuan }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_new_world_lustria }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_new_world_arnheim }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_new_world_naggaroth }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_dragon_isles }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_athel_loren }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_chaos_wastes }
									}
								}
								FROMFROM = {
									location = {
										culture = kul
										religion = ROOT
									}
								}
							}
						}
				}
				hidden_tooltip = {
					if = {
							limit = {
								culture = witchhunter_culture
								FROMFROM = {
									location = { culture_group = skaven_group }
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_empire }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_border_princes }
									}
								}
								FROMFROM = {
									location = {
										culture = neueslander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_kislev }
									}
								}
								FROMFROM = {
									location = {
										culture = kislevite
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_troll_country }
									}
								}
								FROMFROM = {
									location = {
										culture = ropsmann
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_bretonnia }
									}
								}
								FROMFROM = {
									location = {
										culture = nortagnese
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_estalia }
									}
								}
								FROMFROM = {
									location = {
										culture = astur
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_old_world_tilea }
									}
								}
								FROMFROM = {
									location = {
										culture = reman
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_badlands_strygos }
									}
								}
								FROMFROM = {
									location = {
										culture = strigany
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_badlands_magnata }
									}
								}
								FROMFROM = {
									location = {
										culture = myken
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_greater_araby_araby }
									}
								}
								FROMFROM = {
									location = {
										culture = ramaccan
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_greater_araby_southlands }
									}
								}
								FROMFROM = {
									location = {
										culture = wasai
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_nehekhara }
									}
								}
								FROMFROM = {
									location = {
										culture = nehekka
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_norsca }
									}
								}
								FROMFROM = {
									location = {
										culture = aesling
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_karaz_ankor }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_darklands_plains_of_bones }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_darklands_ankor_naggrund }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_darklands_blasted_wastes }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_drak_ankor }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_ulthuan }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_new_world_lustria }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_new_world_arnheim }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_new_world_naggaroth }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_dragon_isles }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_athel_loren }
									}
								}
								FROMFROM = {
									location = {
										culture = reiklander
										religion = ROOT
									}
								}
							}
							if = {
								limit = {
									FROMFROM = {
										location = { region = world_chaos_wastes }
									}
								}
								FROMFROM = {
									location = {
										culture = kul
										religion = ROOT
									}
								}
							}
						}
				}
			hidden_tooltip = { if = { limit = { trait = creature_nehekharan
							FROMFROM = {
								location = { culture_group = skaven_group }
							} }
							FROMFROM = {
								location = {
									culture = nehekka
									religion = atruhayid
								}
							}
						}
					}
		ai_chance = { factor = 1 }
	}
}

# Liege: failure
character_event = {
	id = DR_misc.1102
	desc = EVTDESC_skaven_cleansing_failure
	picture = GFX_evt_skaven_war
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_skaven_cleansing_failure
			hidden_tooltip = {
					FROMFROM = {
						random = {
							chance = 10
								modifier = {
									#
									factor = 4
									FROMFROM = { location = { region = world_underempire } }
								}
							province_event = { id = TOG.1000 }  #Peasant revolt ATM until I get around to adding an actual Skaven revolt
						}
					}
				}
		ai_chance = { factor = 1 }

	}
}

#Event to avoid certain races converting away from their religions
character_event = {
	id = DR_misc.1150

	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			#Greenskins
			AND = {
				OR = {
					trait = creature_orc
					trait = creature_goblin
					trait = creature_hobgoblin
				}
				NOR = {
					religion = greenskin_gods
					religion = spider_god
				}
			}
			#Skaven
			AND = {
				trait = creature_skaven
				NOT = {
					religion_group = horned_rat_god_group
				}
			}
			#Vampires ( non-Jade/non-Mathmasi )
			AND = {
				OR = {
					trait = vampire_lahmian_visible
					trait = vampire_carstein_visible
					trait = vampire_blood_visible
					trait = vampire_strigoi_visible
					trait = vampire_necrarch_visible
					trait = vampire_lahmian_hidden
					trait = vampire_carstein_hidden
					trait = vampire_blood_hidden
					trait = vampire_strigoi_hidden
					trait = vampire_necrarch_hidden
				}
				NOR = {
					religion = vampiric
					religion = nagashi
				}
			}
			#Jade
			AND = {
				OR = {
					trait = vampire_jade_visible
					trait = vampire_jade_hidden
				}
				NOR = {
					religion = vampiric
					religion = nagashi
					religion = draconite
				}
			}
			#Mathmasi
			AND = {
				OR = {
					trait = vampire_mahtmasi_visible
					trait = vampire_mahtmasi_hidden
				}
				NOR = {
					religion = vampiric
					religion = nagashi
					religion = shadowmen
				}
			}
			#Ogres
			AND = {
				trait = creature_ogre
				NOT = {
					religion = great_maw
				}
			}
			#Chaos Dwarfs
			AND = {
				trait = creature_chaos_dwarf
				NOT = {
					religion = hashut
				}
			}
			#Chaos Worshippers
			AND = {
				FROM = {
					OR = {
						religion = chaos
						religion = tzeentch
						religion = nurgle
						religion = slaanesh
						religion = khorne
					}
				}
				NOR = {
					religion = chaos
					religion = tzeentch
					religion = nurgle
					religion = slaanesh
					religion = khorne
				}
			}
			#Add more races as necessary
		}
	}

	option = {
		name = OK
		if = {
			limit = {
				FROM = { religion = greenskin_gods }
			}
			religion = greenskin_gods
		}
		if = {
			limit = {
				FROM = { religion = spider_god }
			}
			religion = spider_god
		}
		if = {
			limit = {
				FROM = { religion = horned_rat }
			}
			religion = horned_rat
		}
		if = {
			limit = {
				FROM = { religion = vampiric }
			}
			religion = vampiric
		}
		if = {
			limit = {
				FROM = { religion = nagashi }
			}
			religion = nagashi
		}
		if = {
			limit = {
				FROM = { religion = draconite }
			}
			religion = draconite
		}
		if = {
			limit = {
				FROM = { religion = shadowmen }
			}
			religion = shadowmen
		}
		if = {
			limit = {
				FROM = { religion = great_maw }
			}
			religion = great_maw
		}
		if = {
			limit = {
				FROM = { religion = chaos }
			}
			religion = chaos
		}
		if = {
			limit = {
				FROM = { religion = tzeentch }
			}
			religion = tzeentch
		}
		if = {
			limit = {
				FROM = { religion = nurgle }
			}
			religion = nurgle
		}
		if = {
			limit = {
				FROM = { religion = slaanesh }
			}
			religion = slaanesh
		}
		if = {
			limit = {
				FROM = { religion = khorne }
			}
			religion = khorne
		}
		if = {
			limit = {
				FROM = { religion = hashut }
			}
			religion = hashut
		}
	}
}

character_event = {
	id = DR_misc.1151
	picture = GFX_evt_sigmar_battle
	desc = OK

	is_triggered_only = yes

	option = {
		name = OK
		religion = sigmarite
	}

}




###########################################
# Atruhayid festival - Parade of the Idol #
###########################################
# Invite vassals to festival
character_event = {
	id = DR_misc.1500
	desc = EVTDESC_DR_atruhayid_1500
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1500
		any_vassal = {
			limit = {
				prisoner = no
				war = no
				in_command = no
				NOT = { trait = incapable }
				age = 16
				NOT = { has_character_flag = do_not_disturb }
			}
			letter_event = {
				id = DR_misc.1501
				tooltip = EVTTOOLTIP1_RoI_1000
			}
		}
		hidden_tooltip = { character_event = { id = DR_misc.1520 days = 12 } }
	}
}

# Vassal receives invitation
letter_event = {
	id = DR_misc.1501
	desc = EVTDESC_DR_atruhayid_1501
	picture = GFX_evt_emissary
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1501 #Travel to the feast
		ai_chance = {
			factor = 2
			modifier  = {
				factor = 0.1
				ai = yes
				trait = in_hiding
			}
			modifier  = {
				factor = 2
				opinion = { who = from value = -30 }
			}
			modifier  = {
				factor = 5
				opinion = { who = from value = -15 }
			}
			modifier  = {
				factor = 5
				opinion = { who = from value = 0 }
			}
		}
		set_character_flag = do_not_disturb
		hidden_tooltip = { character_event = { id = DR_misc.1505 days = 12 } } # Hidden - arrives at feast
		hidden_tooltip = { character_event = { id = DR_misc.1599 days = 42 } } # Safety event for clearing all flags
		if = {
			limit = { trait = in_hiding	}
			remove_trait = in_hiding
			add_character_modifier = {
				name = went_out_of_hiding_timer
				duration = 180
				hidden = yes
			}
			hidden_tooltip = { character_event = { id = CM.6400 } } # Notify plotters and family
		}
	}
	option = {
		name = EVTOPTB_RoI_1001 #Refuse invitation
		ai_chance = {
			factor = 1
			modifier  = {
				factor = 0
				opinion = { who = FROM value = 25 }
				NOT = { trait = in_hiding }
			}
			modifier  = {
				factor = 5
				NOT = {
					religion = atruhayid
				}
			}
		}
		FROM = {
			letter_event = {
				id = DR_misc.1502
				#days = 3
				tooltip = EVTTOOLTIP1_RoI_2001
			}
		}
	}
}

# If vassal refuses to come to the feast
letter_event = {
	id = DR_misc.1502
	desc = EVTDESC_DR_atruhayid_1502
	picture = GFX_evt_emissary

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1502
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 2
		}
	}
}

# Festival begins
character_event = {
	id = DR_misc.1520
	desc = EVTDESC_DR_atruhayid_1520
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1520
		set_character_flag = atruhayid_feast_begun
		hidden_tooltip = { character_event = { id = DR_misc.1595 days = 30 } } # End festival
		hidden_tooltip = { character_event = { id = DR_misc.1599 days = 31 } } # Clearing all flags and modifiers after feast
		hidden_tooltip = {
			character_event = {
				id = DR_misc.1530
				days = 5
			} # Presentation of the Idol
			character_event = {
				id = DR_misc.1540
				days = 10
			} # Veneration of the Idol
			character_event = {
				id = DR_misc.1550
				days = 15
			} # Taxes on the Pious
			character_event = {
				id = DR_misc.1590
				days = 20
			} # Sermon
		}
		any_courtier = {
			limit = {
				is_adult = yes
				is_ruler = no
				NOT = { trait = incapable }
				religion = atruhayid
			}
			set_character_flag = attending_atruhayid_feast
			character_event = { id = DR_misc.1530 days = 5 } # Presentation of the Idol
			character_event = { id = DR_misc.1540 days = 10 } # Veneration of the Idol
			character_event = { id = DR_misc.1550 days = 15 } # Taxes on the Pious
			character_event = { id = DR_misc.1590 days = 20 } # Sermon
			hidden_tooltip = { character_event = { id = DR_misc.1599 days = 31 } } # Clearing all flags and modifiers after feast
		}
	}
}

# Vassal arrives at festival
character_event = {
	id = DR_misc.1505
	desc = EVTDESC_DR_atruhayid_1520
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1520
		hidden_tooltip = {
			if = {
				limit = {
					religion = atruhayid
				}
				character_event = {
					id = DR_misc.1530
					days = 5
				} # Presentation of the Senjaq
				character_event = {
					id = DR_misc.1540
					days = 10
				} # Veneration of the Senjaq
				character_event = {
					id = DR_misc.1550
					days = 15
				} # Taxes on the Pious
			}
			character_event = {
				id = DR_misc.1590
				days = 20
			} # Sermon
		}
	}
}

# Festival ends
character_event = {
	id = DR_misc.1595

	hide_window = yes

	is_triggered_only = yes

	immediate = {
		character_event = { id = DR_misc.1596 }
		any_vassal = {
			limit = {
				has_character_flag = attending_atruhayid_feast
				ROOT = { is_liege_of = THIS }
			}
			character_event = { id = DR_misc.1598 }
		}
	}
}

# Festival is over - host
character_event = {
	id = DR_misc.1596
	desc = EVTDESC_DR_atruhayid_1596
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1596
		add_character_modifier = {
			name = large_feast_timer
			duration = 1825
			hidden = yes
		}
		remove_character_modifier = holding_atruhayid_feast
		clr_character_flag = atruhayid_feast_begun
		clr_character_flag = do_not_disturb
	}
}

# Festival is over - guest
character_event = {
	id = DR_misc.1598
	desc = EVTDESC_DR_atruhayid_1596
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1596
		add_character_modifier = {
			name = large_feast_timer
			duration = 365
			hidden = yes
		}
		opinion = {
			modifier = opinion_enjoyed_feast
			who = FROM
			years = 2
		}
		clr_character_flag = attending_atruhayid_feast
		clr_character_flag = do_not_disturb
	}
}

# Clear all character flags and modifiers - safety catch
character_event = {
	id = DR_misc.1599

	hide_window = yes

	is_triggered_only = yes

	immediate = {
		remove_character_modifier = holding_atruhayid_feast
		clr_character_flag = attending_atruhayid_feast
		clr_character_flag = atruhayid_feast_begun
		clr_character_flag = do_not_disturb
	}
}

# Presentation of the Idol
character_event = {
	id = DR_misc.1530
	title = EVTTITLE_DR_atruhayid_1530
	desc = EVTDESC_DR_atruhayid_1530
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	capable_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1530
		trigger = {
               		piety = 300
        	}
		piety = 30
		hidden_tooltip = {
			random_list = {
				10 = { character_event = { id = DR_misc.1531 } } # Drop the Idol
				10 = { character_event = { id = DR_misc.1535 } } # Character becomes possessed
				10 = { character_event = { id = DR_misc.1537 } } # Character becomes zealous
				10 = { character_event = { id = DR_misc.1539 } } # Character becomes stronger
				300 = {} # No event
			}
		}
	}
	option = {
		name = EVTOPTB_DR_atruhayid_1530
		piety = 10
	}
}

# Weak or old character drops the Idol
character_event = {
	id = DR_misc.1531
	desc = EVTDESC_DR_atruhayid_1531
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		OR = {
			age = 50
			trait = weak
			trait = ill
			trait = pneumonic
			trait = infirm
			trait = has_tuberculosis
			trait = has_typhoid_fever
			trait = has_typhus
			trait = has_bubonic_plague
			trait = has_measles
			trait = has_small_pox
			trait = syphilitic
			trait = leper
		}
	}

	option = {
		name = EVTOPTA_DR_atruhayid_1531
		prestige = -200
		piety = -200
		hidden_tooltip = {
			random = {
	                        chance = 20
	                        character_event = { id = 6100 }

        	        }
		}
	}
}


# Character becomes possessed by Idol
character_event = {
	id = DR_misc.1535
	desc = EVTDESC_DR_atruhayid_1535
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		NOT = { trait = possessed }
		trait = zealous
	}

	option = {
		name = EVTOPTA_DR_atruhayid_1535
		add_trait = possessed
	}
}

# Character becomes zealous
character_event = {
	id = DR_misc.1537
	desc = EVTDESC_DR_atruhayid_1537
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		NOT = { trait = zealous }
		NOT = { trait = cynical }
	}

	option = {
		name = EVTOPTA_DR_atruhayid_1537
		add_trait = zealous
	}
}

# Character becomes stronger
character_event = {
	id = DR_misc.1539
	desc = EVTDESC_DR_atruhayid_1539
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		NOT = { is_strong_trigger = yes }
		NOT = { trait = weak }
		NOT = { trait = slothful }
		NOT = { health_traits = 1 }
	}

	option = {
		name = EVTOPTA_DR_atruhayid_1539
		add_trait = strong
	}
}

# Veneration of the Idol
character_event = {
	id = DR_misc.1540
	title = EVTTITLE_DR_atruhayid_1540
	desc = EVTDESC_DR_atruhayid_1540
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	capable_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1540
		piety = 15
		hidden_tooltip = {
			random_list = {
				30 = { character_event = { id = 38260 } } # Become Humble
				30 = { prestige = 50 } 			  # Gain Prestige
				40 = {} # No event
			}
		}
	}
}

# Donation of Money
character_event = {
	id = DR_misc.1550
	title = EVTTITLE_DR_atruhayid_1550
	desc = EVTDESC_DR_atruhayid_1550
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	capable_only = yes

	option = { # GIVE A LOT
		name = EVTOPTA_DR_atruhayid_1550
		trigger = {
			NOT = { trait = greedy }
		}
		piety = 100
		scaled_wealth = -0.25
		add_trait = charitable
	}
	option = { # GIVE SOME
		name = EVTOPTB_DR_atruhayid_1550
		piety = 10
		scaled_wealth = -0.05
		if = {
			limit = { trait = charitable }
			remove_trait = charitable
		}
	}
	option = { # BUGGER THAT
		name = EVTOPTC_DR_atruhayid_1550
		trigger = {
			NOT = { trait = charitable }
		}
		piety = -50
		add_trait = greedy
	}
}

# Sermon - host and guests
character_event = {
	id = DR_misc.1590
	desc = EVTDESC_DR_atruhayid_1590
	picture = GFX_evt_questing_araby
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_DR_atruhayid_1590
		piety = 20
		add_character_modifier = {
			name = large_feast_timer
			duration = 365
			hidden = yes
		}
	}
}
