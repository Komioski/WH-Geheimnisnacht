namespace = DR_pirates

#Buccaneer Trait Gained
character_event = {
	id = DR_pirates.1
	desc = EVTDESC_DR_pirates_1
	picture = GFX_evt_vikings_arriving_oldgods
	border = GFX_event_normal_frame_war

	hide_from = yes

	is_triggered_only = yes

	min_age = 16
	capable_only = yes
	prisoner = no

	religion = stromfels

	trigger = {
		religion = stromfels
		has_dlc = "The Old Gods"
		NOT = { trait = buccaneer }
	}

	immediate = {
		if = {
			limit = { has_nickname = no }
			random_list = {
				1 = { set_character_flag = nick_flying_culturename }
				1 = { set_character_flag = nick_the_red_sailor }
				1 = { set_character_flag = nick_the_black_sailor }
				1 = { set_character_flag = nick_ghostsails }
				1 = { set_character_flag = nick_searat }
				1 = { set_character_flag = nick_seadog }
				1 = { modifier = { factor = 0 is_female = yes } set_character_flag = nick_blackbeard }
				1 = { set_character_flag = nick_seawolf }
				1 = { set_character_flag = nick_board_thunder }
				1 = { set_character_flag = nick_redbeard }
				1 = { modifier = { factor = 0  is_female = yes } set_character_flag = nick_whitebeard }
				1 = { set_character_flag = nick_the_scourge_capital }
				1 = { set_character_flag = nick_lazyjacks }
				1 = { set_character_flag = nick_crossbones }
				1 = { set_character_flag = nick_grogswiller }
				30 = {  }
			}
		}
	}

	option = {
		name = EVTDESC_DR_pirates_1
		add_trait = buccaneer
		if = {
			limit = { has_character_flag = nick_flying_culturename }
			give_nickname = nick_the_flying_culturename
			clr_character_flag = nick_flying_culturename
		}
		if = {
			limit = { has_character_flag = nick_the_red_sailor }
			give_nickname = nick_the_red_sailor
			clr_character_flag = nick_the_red_sailor
		}
		if = {
			limit = { has_character_flag = nick_the_black_sailor }
			give_nickname = nick_the_black_sailor
			clr_character_flag = nick_the_black_sailor
		}
		if = {
			limit = { has_character_flag = nick_ghostsails }
			give_nickname = nick_ghostsails
			clr_character_flag = nick_ghostsails
		}
		if = {
			limit = { has_character_flag = nick_searat }
			give_nickname = nick_searat
			clr_character_flag = nick_searat
		}
		if = {
			limit = { has_character_flag = nick_blackbeard }
			give_nickname = nick_blackbeard
			clr_character_flag = nick_blackbeard
		}
		if = {
			limit = { has_character_flag = nick_seadog }
			give_nickname = nick_seadog
			clr_character_flag = nick_seadog
		}
		if = {
			limit = { has_character_flag = nick_seawolf }
			give_nickname = nick_seawolf
			clr_character_flag = nick_seawolf
		}
		if = {
			limit = { has_character_flag = nick_board_thunder }
			give_nickname = nick_board_thunder
			clr_character_flag = nick_board_thunder
		}
		if = {
			limit = { has_character_flag = nick_redbeard }
			give_nickname = nick_redbeard
			clr_character_flag = nick_redbeard
		}
		if = {
			limit = { has_character_flag = nick_whitebeard }
			give_nickname = nick_whitebeard
			clr_character_flag = nick_whitebeard
		}
		if = {
			limit = { has_character_flag = nick_the_scourge_capital }
			give_nickname = nick_the_scourge_capital
			clr_character_flag = nick_the_scourge_capital
		}
		if = {
			limit = { has_character_flag = nick_lazyjacks }
			give_nickname = nick_lazyjacks
			clr_character_flag = nick_lazyjacks
		}
		if = {
			limit = { has_character_flag = nick_crossbones }
			give_nickname = nick_crossbones
			clr_character_flag = nick_crossbones
		}
		if = {
			limit = { has_character_flag = nick_grogswiller }
			give_nickname = nick_grogswiller
			clr_character_flag = nick_grogswiller
		}
	}
}



#Pirates kidnap noble at the high seas!
character_event = {
	id = DR_pirates.17

	only_playable = yes
	min_age = 16
	capable_only = yes
	prisoner = no
	hide_window = yes

	trigger = {
		religion = stromfels
		# NOT = {
			# any_liege = {
				# NOT = { religion = stromfels }
			# }
		# }
		capital_scope = { port = yes }
	}

	mean_time_to_happen = {
		years = 100
		modifier = {
			factor = 0.5
			tier = DUKE
		}
		modifier = {
			factor = 0.25
			higher_tier_than = DUKE
		}
		modifier = {
			factor = 0.33
			in_command = yes
			is_at_sea = yes
		}
		modifier = {
			factor = 1.25
			NOT = { martial = 2 }
		}
		modifier = {
			factor = 1.25
			NOT = { martial = 4 }
		}
		modifier = {
			factor = 1.25
			NOT = { martial = 6 }
		}
		modifier = {
			factor = 0.9
			martial = 10
		}
		modifier = {
			factor = 0.9
			martial = 12
		}
		modifier = {
			factor = 0.9
			martial = 14
		}
		modifier = {
			factor = 0.9
			martial = 16
		}
		modifier = {
			factor = 0.9
			martial = 18
		}
		modifier = {
			factor = 0.9
			martial = 20
		}
	}

	immediate = {
		random_playable_ruler = {
			limit = {
				capital_scope = { port = yes }
				demesne_size = 1
				NOT = { same_realm = ROOT }
				is_within_diplo_range = ROOT
				OR = {
					trait = creature_human
					trait = creature_dwarf
					trait = creature_elf
				}
				NOR = {
						trait = vampire_strigoi_hidden
						trait = vampire_necrarch_hidden
						trait = vampire_strigoi_visible
						trait = vampire_necrarch_visible
				}
			}
			random_courtier = {
				limit = {
					age = 15
					prisoner = no
					NOT = { trait = in_hiding }
					NOT = { trait = incapable }
					has_epidemic = no
					in_command = no
					location = { port = yes }
					is_within_diplo_range = ROOT
					OR = { #is important
						is_ruler = yes
						wealth = 100
						liege = { is_close_relative = PREV }
						AND = {
							NOT = { dynasty = 0 }
							is_councillor = yes
						}
					}
					OR = {
						trait = creature_human
						trait = creature_dwarf
						trait = creature_elf
					}
					NOR = {
							trait = vampire_strigoi_hidden
							trait = vampire_necrarch_hidden
							trait = vampire_strigoi_visible
							trait = vampire_necrarch_visible
					}
				}
				character_event = { id = DR_pirates.18 }
				any_ward = {
					limit = {
						prisoner = no
						NOT = { trait = in_hiding }
						NOT = { trait = incapable }
						in_command = no
						at_location = PREV
					}
					character_event = { id = DR_pirates.18 }
				}
			}
		}
	}

	option = {
		name = OK
	}
}
#Inform captured
character_event = {
	id = DR_pirates.18
	desc = "EVTDESC_DR_pirates_18"
	picture = GFX_evt_pirate_crew

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_DR_pirates_18"
		tooltip = { imprison = FROM }
		hidden_tooltip = {
			FROM = { character_event = { id = DR_pirates.19 } }
			any_playable_ruler = {
				limit = {
					ai = no
					NOT = { character = ROOT }
					OR = {
						is_liege_of = ROOT
						is_close_relative = ROOT
					}
				}
				character_event = { id = DR_pirates.20 }
			}
		}
	}
}
 #inform pirate
character_event = {
	id = DR_pirates.19
	desc = "EVTDESC_DR_pirates_19"
	picture = GFX_evt_pirate_crew

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_DR_pirates_19"
		FROM = { imprison = ROOT }
		wealth = 25
	}
}
 #inform liege
character_event = {
	id = DR_pirates.20
	desc = "EVTDESC_DR_pirates_20"
	picture = GFX_evt_pirate_crew

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_DR_pirates_20"
		FROMFROM = { tooltip = { } }
	}
}


# #Plunder Fleets stuff
# character_event = {
	# id = DR_pirates.101
	# desc = OK
	# picture = GFX_evt_crusaders
	# border = GFX_event_normal_frame_war

	# hide_window = yes # Only fires for unplayable landless characters

	# is_triggered_only = yes

	# immediate = {
		# if = {
			# limit = { trait = in_hiding	}
			# remove_trait = in_hiding
			# add_character_modifier = {
				# name = went_out_of_hiding_timer
				# duration = 180
				# hidden = yes
			# }
			# clr_character_flag = do_not_disturb
			# hidden_tooltip = { character_event = { id = CM.6400 } } # Notify plotters and family
		# }
		# add_trait = adventurer
		# FROMFROM = {
			# primary_title = {
				# holder_scope = {
					# save_event_target_as = previous_liege
				# }
			# }
			# # character_event = {
				# # id = DR_pirates.101
				# # days = 1
			# # }
			# capital_scope = {
				# save_event_target_as = target_province
				# ROOT = {
					# set_defacto_liege = ROOT
					# create_title = {
						# tier = DUKE
						# landless = yes
						# temporary = yes
						# adventurer = yes
						# custom_created = yes
						# culture = ROOT
						# holder = ROOT
						# base_title = PREV
						# mercenary = yes
						# # replace_captain_on_death = yes
						# siphons_income_to_creator = 0.15
						# culture = ROOT
						# name = "DYNAMIC_PIRATE_PLUNDER_FLEET"
					# }
					# # set_character_flag = raiding_adventurer
					# set_character_flag = raiding_adventurer_pirate

					# character_event = { id = DR_pirates.102 } #create troops

					# create_random_soldier = {
						# random_traits = yes
						# dynasty = none
						# religion = ROOT
						# culture = ROOT
						# female = no
						# age = 30
					# }
					# create_random_soldier = {
						# random_traits = yes
						# dynasty = none
						# religion = ROOT
						# culture = ROOT
						# female = no
						# age = 25
					# }
					# # Create a fleet, just to be sure
					# spawn_fleet = {
						# province = closest # closest sea zone
						# owner = ROOT
						# disband_on_peace = yes
						# troops =
						# {
							# galleys = { 110 110 }
						# }
					# }

				# }
			# }
			# make_tributary = { who = ROOT percentage = 0.9 }
		# }
	# }
# }

# character_event = {
	# id = DR_pirates.102
	# is_triggered_only = yes
	# hide_window = yes

	# immediate = {
		# FROMFROM = {
			# primary_title = {
				# holder_scope = {
					# save_event_target_as = previous_liege
				# }
			# }

		# }
		# random_list = {
			# 30 = { #3
				# # modifier = {
					# # factor = 1.4
					# # NOT = { year = 850 }
				# # }
				# # modifier = {
					# # factor = 1.4
					# # NOT = { year = 950 }
				# # }
				# # modifier = {
					# # factor = 1.2
					# # NOT = { year = 1050 }
				# # }
				# # modifier = {
					# # factor = 0.6
					# # year = 1150
				# # }
				# character_event = { id = DR_pirates.104 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
			# }
			# 30 = { #6
				# # modifier = {
					# # factor = 0.7
					# # year = 1100
				# # }
				# character_event = { id = DR_pirates.104 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
			# }
			# 30 = { #9
				# # modifier = {
					# # factor = 0.7
					# # NOT = { year = 900 }
				# # }
				# # modifier = {
					# # factor = 0.7
					# # NOT = { year = 950 }
				# # }
				# # modifier = {
					# # factor = 0.7
					# # NOT = { year = 1000 }
				# # }
				# # modifier = {
					# # factor = 0.7
					# # NOT = { year = 1050 }
				# # }
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 12 }
				# }
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 14 }
				# }
				# character_event = { id = DR_pirates.104 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
			# }
			# 30 = { #12
				# # modifier = {
					# # factor = 0
					# # NOT = { year = 1150 }
				# # }
				# # modifier = {
					# # factor = 0.7
					# # NOT = { year = 1180 }
				# # }
				# # modifier = {
					# # factor = 0.7
					# # NOT = { year = 1200 }
				# # }
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 15 }
				# }
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 20 }
				# }
				# character_event = { id = DR_pirates.104 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
				# character_event = { id = DR_pirates.103 }
			# }
		# }
	# }
# }

# character_event = {
	# id = DR_pirates.103
	# is_triggered_only = yes
	# hide_window = yes

	# immediate = {
		# random_list = {
			# 30 = { #250
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 2 }
				# }
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 4 }
				# }
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 6 }
				# }
				# modifier = {
					# factor = 0.7
					# martial = 15
				# }
				# modifier = {
					# factor = 0.7
					# martial = 18
				# }
				# modifier = {
					# factor = 0.7
					# martial = 21
				# }
				# modifier = {
					# factor = 0.7
					# martial = 24
				# }
				# spawn_unit = {
					# province = event_target:target_province
					# home = event_target:target_province
					# owner = ROOT
					# #leader = none
					# attrition = 0
# #					disband_on_peace = yes
					# reinforces = yes
					# is_looter = yes
					# can_toggle_looting = no
					# cannot_inherit = yes
					# merge = yes
					# troops = {
						# archers = { 70 70 }
						# light_infantry = { 170 170 }
						# heavy_infantry = { 10 10 }
					# }
				# }
			# }
			# 30 = { #380
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 4 }
				# }
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 6 }
				# }
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 8 }
				# }
				# modifier = {
					# factor = 0.7
					# martial = 17
				# }
				# modifier = {
					# factor = 0.7
					# martial = 20
				# }
				# modifier = {
					# factor = 0.7
					# martial = 23
				# }
				# modifier = {
					# factor = 0.7
					# martial = 26
				# }
				# spawn_unit = {
					# province = event_target:target_province
					# home = event_target:target_province
					# owner = ROOT
					# #leader = none
					# attrition = 0
# #					disband_on_peace = yes
					# reinforces = yes
					# is_looter = yes
					# can_toggle_looting = no
					# cannot_inherit = yes
					# merge = yes
					# troops = {
						# archers = { 90 90 }
						# light_infantry = { 215 215 }
						# heavy_infantry = { 15 15 }
					# }
				# }

			# }
			# 30 = { #420
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 9 }
				# }
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 12 }
				# }
				# modifier = {
					# factor = 1.3
					# NOT = { martial = 15 }
				# }
				# modifier = {
					# factor = 0.7
					# martial = 20
				# }
				# modifier = {
					# factor = 0.7
					# martial = 24
				# }
				# spawn_unit = {
					# province = event_target:target_province
					# home = event_target:target_province
					# owner = ROOT
					# #leader = none
					# attrition = 0
# #					disband_on_peace = yes
					# reinforces = yes
					# is_looter = yes
					# can_toggle_looting = no
					# cannot_inherit = yes
					# merge = yes
					# troops = {
						# archers = { 100 100 }
						# light_infantry = { 225 225 }
						# heavy_infantry = { 15 15 }
					# }
				# }
			# }
			# 30 = { #490
				# modifier = {
					# factor = 1.3
					# martial = 24
				# }
				# modifier = {
					# factor = 1.3
					# martial = 28
				# }
				# modifier = {
					# factor = 0.5
					# NOT = { martial = 10 }
				# }
				# modifier = {
					# factor = 0.5
					# NOT = { martial = 15 }
				# }
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 20 }
				# }
				# spawn_unit = {
					# province = event_target:target_province
					# home = event_target:target_province
					# owner = ROOT
					# #leader = none
					# attrition = 0
# #					disband_on_peace = yes
					# reinforces = yes
					# is_looter = yes
					# can_toggle_looting = no
					# cannot_inherit = yes
					# merge = yes
					# troops = {
						# archers = { 140 140 }
						# light_infantry = { 330 330 }
						# heavy_infantry = { 20 20 }
					# }
				# }
			# }
			# 30 = { #570
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 14 }
				# }
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 20 }
				# }
				# modifier = {
					# factor = 0.7
					# NOT = { martial = 26 }
				# }
				# spawn_unit = {
					# province = event_target:target_province
					# home = event_target:target_province
					# owner = ROOT
					# #leader = none
					# attrition = 0
# #					disband_on_peace = yes
					# reinforces = yes
					# is_looter = yes
					# can_toggle_looting = no
					# cannot_inherit = yes
					# merge = yes
					# troops = {
						# archers = { 170 170 }
						# light_infantry = { 360 360 }
						# heavy_infantry = { 40 40 }
					# }
				# }
			# }
		# }
	# }
# }

character_event = {
	id = DR_pirates.104

	is_triggered_only = yes
	hide_window=yes
	trigger = {
		FROMFROM={primary_title={title=FROM}}
		FROMFROM={government=pirate_government}
		government=pirate_government
		any_dynasty_member={has_minor_title=title_designatedheir}
		any_demesne_title={
			tier=COUNT
			can_be_given_away = yes
		}
	}
	immediate={
		FROMFROM={save_event_target_as=former_captain}
		#		limit = {
		#			NOT = { trait = has_nurgles_rot }
		#			is_ruler = no
		#			is_adult = yes
		#			host = { character = ROOT }
		#			NOT = { is_heir = ROOT }
		#		}
		#		save_event_target_as = scoped_war_sacrifice
		ROOT={
			random_dynasty_member={
				limit={
					has_minor_title=title_designatedheir
				}
				save_event_target_as=designated_heir
			}
			any_demesne_title={
				limit={
					tier=COUNT
					can_be_given_away = yes
				}
				usurp_title = {
					target = event_target:designated_heir
					type = invasion
				}
			}
			any_demesne_title={
				limit={
					higher_tier_than=COUNT
					NOT={primary_title={title=FROM}}
				}
				usurp_title = {
					target = event_target:designated_heir
					type = invasion
				}
			}
		}
		event_target:designated_heir={
			wealth=80
			prestige=250
		}
		narrative_event={id=DR_pirates.105 days=1}
	}
}
narrative_event = {
	id = DR_pirates.105
	title = title_pirates_105
	desc = DESCDR_pirates_105
	picture = GFX_evt_pirate_fleet

	is_triggered_only = yes

	option = {
		name = EVTOPTAPirates_105
		ROOT={
			prestige=250
			wealth=65
			add_trait=disinherited
		}
		show_trait=disinherited
		ai_chance = { factor = 1 }
	}
	option = {
		name = EVTOPTBPirates_105
		event_target:designated_heir={
			show_portrait = yes
		}
		ROOT={
			prestige=125
			wealth=35
		}
		set_player_character = event_target:designated_heir
		ai_chance = { factor = 1 }
	}
}

character_event = {
	id = DR_pirates.106
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		government = pirate_government
		OR = {
			AND = {
				trait = one_eyed
				NOT = { has_character_modifier = one_eyed_pirate }
			}
			AND = {
				trait = one_handed
				NOT = { has_character_modifier = one_handed_pirate }
			}
			AND = {
				trait = one_legged
				NOT = { has_character_modifier = one_legged_pirate }
			}
		}
	}

	immediate = {
		if = {
			limit = {
				trait = one_eyed
				NOT = { has_character_modifier = one_eyed_pirate }
			}
			add_character_modifier = {
				name = one_eyed_pirate
				duration = -1
			}
		}
		if = {
			limit = {
				trait = one_handed
				NOT = { has_character_modifier = one_handed_pirate }
			}
			add_character_modifier = {
				name = one_handed_pirate
				duration = -1
			}
		}
		if = {
			limit = {
				trait = one_legged
				NOT = { has_character_modifier = one_legged_pirate }
			}
			add_character_modifier = {
				name = one_legged_pirate
				duration = -1
			}
		}
	}
}

character_event = {
	id = DR_pirates.107
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		government = pirate_government
		OR = {
			AND = {
				NOT = { trait = one_eyed }
				has_character_modifier = one_eyed_pirate
			}
			AND = {
				NOT = { trait = one_handed }
				has_character_modifier = one_handed_pirate
			}
			AND = {
				NOT = { trait = one_legged }
				has_character_modifier = one_legged_pirate
			}
		}
	}

	immediate = {
		if = {
			limit = {
				NOT = { trait = one_eyed }
				has_character_modifier = one_eyed_pirate
			}
			remove_character_modifier = one_handed_pirate
		}
		else_if = {
			limit = {
				NOT = { trait = one_handed }
				has_character_modifier = one_handed_pirate
			}
			remove_character_modifier = one_handed_pirate
		}
		else = { remove_character_modifier = one_legged_pirate }
	}
}
