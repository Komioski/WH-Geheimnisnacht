namespace = MageAp
############################################
##################################
#1-30 Wandering Mage
#Becoming an Apprentice MageAp.1-MageAp.7
#A Mage wanders to court --- MageAp.100-MageAp.105
###################################################################################################
#####GENERIC APPRENTICE EVENTS FOR HUMANS LEARNING MAGIC FROM A WIZARD GUARDIAN

# on_adolescence_pulse on_childhood_pulse ping Child wants to become a apprentice
character_event = {
	id = MageAp.1
	desc = EVTDESCsorcererapprentice2
	picture = "GFX_evt_apprentice"

	min_age = 6

	is_triggered_only = yes

	trigger = {
		gender_is_allowed_magic_trigger = yes
		OR = {
			AND = {
				learning = 2
				age = 6
			}
			AND = {
				learning = 4
				age = 11
			}
			AND = {
				trait = creature_elf
				learning = 14
				age = 20
			}
		}
		OR = {
			age < 26
			check_variable = {
				which = "mage_teaching"
				value = 1
			}
			trait = creature_elf
		}
		OR = {
			AND = {
				guardian = {
					is_trained_mage_trigger = yes
				}
			}
			AND = {
				is_landed = yes
				any_courtier_or_vassal = {
					has_minor_title = title_teacher_mage
				}
			}
			AND = {
				is_landed = no
				liege = {
					any_courtier_or_vassal = {
						has_minor_title = title_teacher_mage
					}
				}
			}
		}
		NOR = {
			trait = hedge_wizard
			trait = mage_apprentice
			has_character_flag = failed_mage
			has_character_flag = priority_ice_witch
			has_character_modifier = apprenticeship_refused
			has_epidemic = yes
			is_ill = yes
			is_incapable = yes
			is_trained_mage_trigger = yes
		}
	}

	weight_multiplier = {
		days = 1
		modifier = {
			factor = 4
			trait = genius
		}
		modifier = {
			factor = 2
			trait = brilliant
		}
		modifier = {
			factor = 1.5
			trait = bright
		}
		modifier = {
			factor = 4
			trait = ambitious
		}
		modifier = {
			factor = 1.25
			trait = quick
		}
		modifier = {
			factor = 10
			culture_group = kislevite_group
			is_female = yes
			any_courtier_or_vassal = {
				has_minor_title = title_teacher_mage
				trait = ice_witch
			}
		}
		modifier = {
			factor = 10
			trait = creature_elf
			holder_scope = {
				top_liege = { trait = malekith }
			}
			is_female = yes
			any_courtier_or_vassal = {
				has_minor_title = title_teacher_mage
			}
		}
		modifier = {
			factor = 5
			learning = 6
			is_female = no
			guardian = {
				is_trained_mage_trigger = yes
				trait = arabyan_scholar
			}
		}
		modifier = {
			factor = 1.25
			trait = smart
		}
		modifier = {
			factor = 1.25
			is_ruler = yes
			any_courtier_or_vassal = {
				has_minor_title = title_teacher_mage
			}
		}
		modifier = {
			factor = 1.25
			is_ruler = no
			liege = {
				any_courtier_or_vassal = {
					has_minor_title = title_teacher_mage
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				trait = imbecile
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slothful
				trait = idiot
			}
		}
	}

	option = {
		name = EVTOPTAsorcererapprentice2
		hidden_tooltip = {
			if = {
				limit = {
					has_guardian = yes
					guardian = {
						is_trained_mage_trigger = yes
					}
				}
				#Notify Guardian, Child wants to study magic
				guardian = {
					character_event = {
						id = MageAp.2
					}
				}
			}
			else_if = {
				is_landed = yes
				random_courtier_or_vassal = {
					limit = {
						has_minor_title = title_teacher_mage
						is_trained_mage_trigger = yes
					}
					#Notify Guardian, Child wants to study magic
					character_event = {
						id = MageAp.2
					}
				}
			}
			else_if = {
				is_landed = no
				liege = {
					random_courtier_or_vassal = {
						limit = {
							has_minor_title = title_teacher_mage
							is_trained_mage_trigger = yes
						}
						#Notify Guardian, Child wants to study magic
						character_event = {
							id = MageAp.2
						}
					}
				}
			}
		}
	}
}

# Notify Guardian, Child wants to study magic
character_event = {
	id = MageAp.2
	desc = EVTDESCsorcererapprentice3
	picture = "GFX_evt_apprentice"

	is_triggered_only = yes

	# Accept
	option = {
		name = EVTOPTAsorcererapprentice3
		ai_chance = {
			factor = 1.2
		}
		if = {
			limit = {
				trait = proud
			}
			prestige = 10
		}
		FROM = {
			hidden_tooltip = {
				character_event = {
					id = MageAp.5
				}
			}
			opinion = {
				modifier = opinion_happy_with_guardian
				who = ROOT
				years = 2
			}
		}
	}
	# Decline
	option = {
		name = EVTOPTBsorcererapprentice3
		ai_chance = {
			factor = 0
		}
		prestige = -10
		FROM = {
			add_character_modifier = {
				name = apprenticeship_refused
				duration = 3650
			}
			hidden_tooltip = {
				character_event = {
					id = MageAp.4
				}
			}
		}
	}
}

#Child notification, refused to be an apprentice.
character_event = {
	id = MageAp.4
	desc = EVTDESCsorcererapprentice5
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice5
	}
}

#Accepted apprenticeship (Ward Notification)
character_event = {
	id = MageAp.5
	desc = EVTDESCsorcererapprentice6
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice6
		add_friend = FROM
		add_trait = mage_apprentice
		FROM = {
			save_event_target_as = mage_tutor
		}
		save_event_target_as = mage_ward
		set_character_flag = mage_master@FROM
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.6
					days = 250
					random = 150
				}
			}
		}		#Start training
	}
}

#Training, decide how.
character_event = {
	id = MageAp.6
	desc = EVTDESCsorcererapprentice7
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	trigger = {
		event_target:mage_ward = {
			is_alive = yes
			#Incase they pass and the events continue.
			NOT = { is_trained_mage_trigger = yes }
			NOT = {
				has_character_flag = failed_mage
			}
		}
	}
	immediate = {
		FROM = {
			if = {
				limit = {
					is_adult = yes
				}
				join_magic_society_effect = yes
				ROOT = {
					#TODO add notification for teacher
				}
			}
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice7		#Teach caution
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 14
					}
					magic_training_years_over = yes
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.71
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice7		#Teach to experiment
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 14
					}
					magic_training_years_over = yes
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.72
				}
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice7		#Teach focus
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 14
					}
					magic_training_years_over = yes
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.73
				}
			}
		}
	}
	option = {
		name = EVTOPTDsorcererapprentice7		#Test student
		trigger = {
			FROM = {
				NOT = {
					age <= 15
				}
				OR = {
					check_variable = {
						which = "mage_teaching"
						value = 14
					}
					magic_training_years_over = yes
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				set_variable = {
					which = "mage_teaching"
					value = 0
				}
				character_event = {
					id = MageAp.74
				}
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice7		#Almost there ( fallback event if student is under the age of 16)
		trigger = {
			FROM = {
				check_variable = {
					which = "mage_teaching"
					value = 14
				}
				age < 16
			}
		}
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.75
				}
			}
		}
	}
}

###Teaching###
#Ward - The Master teaches caution
character_event = {
	id = MageAp.71
	desc = EVTDESCsorcererapprentice70001
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	trigger = {
		event_target:mage_tutor = {
			is_alive = yes
		}
	}
	fail_trigger_effect = {
		character_event = {
			id = MageAp.74
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice70001
		hidden_tooltip = {
			FROM = {
				random_list = {
					50 = {
						character_event = {
							id = MageAp.6
							days = 250
							random = 150
						}
					}
					50 = {
						character_event = {
							id = MageAp.6
							days = 200
							random = 75
						}
					}
				}
			}
			change_variable = {
				which = magicxp
				value = 1
			}
			random_list = {
				50 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				5 = {
					change_learning = 1
					change_variable = {
						which = magicxp
						value = 1
					}
				}
				50 = {
					magic_learning_reduce_bad_outcome = yes
				}
			}
		}
	}
}

#Ward - The Master teaches to experiment
character_event = {
	id = MageAp.72
	desc = EVTDESCsorcererapprentice70002
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	trigger = {
		event_target:mage_tutor = {
			is_alive = yes
		}
	}
	fail_trigger_effect = {
		character_event = {
			id = MageAp.74
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice70002
		hidden_tooltip = {
			FROM = {
				random_list = {
					50 = {
						character_event = {
							id = MageAp.6
							days = 250
							random = 150
						}
					}
					50 = {
						character_event = {
							id = MageAp.6
							days = 200
							random = 75
						}
					}
				}
			}
			change_variable = {
				which = magicxp
				value = 1
			}
			random_list = {
				20 = {
					if = {
						limit = {
							NOT = {
								learning = 18
							}
						}
						change_learning = 2
					}
					else = {
						add_character_modifier = {
							name = nocturnal_studies
							duration = 1095
						}
					}
					change_variable = {
						which = magicxp
						value = 1
					}
				}
				30 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				50 = {
					magic_learning_reduce_bad_outcome = yes
				}
			}
		}
	}
}

#Ward - The Master teaches to focus
character_event = {
	id = MageAp.73
	desc = EVTDESCsorcererapprentice70003
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	trigger = {
		event_target:mage_tutor = {
			is_alive = yes
		}
	}
	fail_trigger_effect = {
		character_event = {
			id = MageAp.74
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice70003
		hidden_tooltip = {
			FROM = {
				random_list = {
					50 = {
						character_event = {
							id = MageAp.6
							days = 250
							random = 150
						}
					}
					50 = {
						character_event = {
							id = MageAp.6
							days = 200
							random = 75
						}
					}
				}
			}
			change_variable = {
				which = magicxp
				value = 1
			}
			random_list = {
				10 = {
					if = {
						limit = {
							NOT = {
								learning = 20
							}
						}
						change_learning = 3
					}
					else = {
						add_character_modifier = {
							name = nocturnal_studies
							duration = 1095
						}
					}
					change_variable = {
						which = magicxp
						value = 1
					}
				}
				40 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				50 = {
					magic_learning_reduce_bad_outcome = yes
				}
			}
		}
	}
}

#Check if the Mage Apprentice has managed to achieve his or her goals
character_event = {
	id = MageAp.74
	picture = "GFX_evt_apprentice"
	desc = {
		text = EVTDESCAsorcererapprentice70004
		trigger = {
			is_incapable = no
			event_target:mage_tutor = {
				is_alive = yes
			}
			AND = {
				NOT = {
					has_character_flag = recessive_mage
				}
				OR = {
				#elves are naturally more magic magnets
					AND = {
						trait = creature_elf
						OR = {
							learning = 10
							check_variable = {
								which = magicxp
								value = 11
							}
						}
					}
					AND = {
						OR = {
							trait = magic_potential_1
							has_character_flag = magic_potential_flag_1
						}
						OR = {
							learning = 16
							check_variable = {
								which = magicxp
								value = 20
							}
						}
					}
					AND = {
						OR = {
							trait = magic_potential_2
							has_character_flag = magic_potential_flag_2
						}
						OR = {
							learning = 14
							check_variable = {
								which = magicxp
								value = 17
							}
						}
					}
					AND = {
						OR = {
							trait = magic_potential_3
							has_character_flag = magic_potential_flag_3
						}
						OR = {
							learning = 12
							check_variable = {
								which = magicxp
								value = 15
							}
						}
					}
					AND = {
						OR = {
							trait = magic_potential_4
							has_character_flag = magic_potential_flag_4
						}
						OR = {
							learning = 10
							check_variable = {
								which = magicxp
								value = 13
							}
						}
					}
				}
			}
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice70004
		trigger = {
			event_target:mage_tutor = {
				is_alive = yes
			}
			OR = {
				has_character_flag = recessive_mage
				AND = {
					OR = {
						trait = magic_potential_1
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						learning = 16
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 20
						}
					}
				}
				AND = {
					OR = {
						trait = magic_potential_2
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						learning = 14
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 17
						}
					}
				}
				AND = {
					OR = {
						trait = magic_potential_3
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						learning = 12
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 15
						}
					}
				}
				AND = {
					OR = {
						trait = magic_potential_4
						has_character_flag = magic_potential_flag_4
					}
					NOT = {
						learning = 10
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 13
						}
					}
				}
			}
		}
	}
	desc = {
		text = EVTDESCBmageap74_dead_tutor
		trigger = {
			event_target:mage_tutor = {
				is_alive = no
			}
		}
	}
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice70004
		trigger = {
			NOT = {
				has_character_flag = recessive_mage
			}
			AND = {
				OR = {
					AND = {
						OR = {
							trait = magic_potential_1
							has_character_flag = magic_potential_flag_1
						}
						OR = {
							learning = 16
							check_variable = {
								which = magicxp
								value = 20
							}
						}
					}
					AND = {
						OR = {
							trait = magic_potential_2
							has_character_flag = magic_potential_flag_2
						}
						OR = {
							learning = 14
							check_variable = {
								which = magicxp
								value = 17
							}
						}
					}
					AND = {
						OR = {
							trait = magic_potential_3
							has_character_flag = magic_potential_flag_3
						}
						OR = {
							learning = 12
							check_variable = {
								which = magicxp
								value = 15
							}
						}
					}
					AND = {
						OR = {
							trait = magic_potential_4
							has_character_flag = magic_potential_flag_4
						}
						OR = {
							learning = 10
							check_variable = {
								which = magicxp
								value = 13
							}
						}
					}
				}
				is_incapable = no
			}
		}
		remove_trait = mage_apprentice
		prestige = 150
		if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_ice
				}
			}
			add_trait = lore_ice
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_hag
				}
			}
			add_trait = lore_hag
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_fire
				}
			}
			add_trait = lore_fire
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_beasts
				}
			}
			add_trait = lore_beasts
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_metal
				}
			}
			add_trait = lore_metal
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_life
				}
			}
			add_trait = lore_life
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_heavens
				}
			}
			add_trait = lore_heavens
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_death
				}
			}
			add_trait = lore_death
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_tzeentch
				}
				religion = tzeentch
			}
			add_trait = lore_tzeentch
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_tzeentch
				}
				NOT = {
					religion = tzeentch
				}
			}
			add_trait = lore_chaos
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_nurgle
				}
				religion = nurgle
			}
			add_trait = lore_tzeentch
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_nurgle
				}
				NOT = {
					religion = nurgle
				}
			}
			add_trait = lore_chaos
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_slaanesh
				}
				religion = slaanesh
			}
			add_trait = lore_slaanesh
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_slaanesh
				}
				NOT = {
					religion = slaanesh
				}
			}
			add_trait = lore_chaos
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = lore_chaos
				}
			}
			add_trait = lore_chaos
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					OR = {
						trait = lore_light
						trait = lore_high_magic
					}
				}
			}
			random_list = {
				50 = {
					add_trait = lore_light
					modifier = {
						factor = 0
						trait = creature_elf
					}
				}
				50 = {
					add_trait = lore_high_magic
					modifier = {
						factor = 0
						trait = creature_human
					}
				}
			}
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					OR = {
						trait = lore_shadows
						trait = lore_dark_magic
					}
				}
			}
			random_list = {
				50 = {
					add_trait = lore_shadows
					modifier = {
						factor = 0
						trait = creature_elf
					}
				}
				50 = {
					add_trait = lore_dark_magic
					modifier = {
						factor = 0
						trait = creature_human
					}
				}
			}
		}
		if = {
			limit = {
				event_target:mage_tutor = {
					trait = arabyan_scholar
				}
				is_female = no
			}
			add_trait = arabyan_scholar
		}
		else_if = {
			limit = {
				event_target:mage_tutor = {
					trait = astromancer
				}
			}
			add_trait = astromancer
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_4
			}
			add_trait = magic_potential_4
			clr_character_flag = magic_potential_flag_4
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_3
			}
			add_trait = magic_potential_3
			clr_character_flag = magic_potential_flag_3
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_2
			}
			add_trait = magic_potential_2
			clr_character_flag = magic_potential_flag_2
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_1
			}
			add_trait = magic_potential_1
			clr_character_flag = magic_potential_flag_1
		}
		magic_lvl_increase_effect = yes
		enable_magic_xp_effect = yes
		event_target:mage_tutor = {
			character_event = {
				id = MageAp.8
			}
		}
		father = {
			character_event = {
				id = MageAp.85
				days = 1
			}
		}
		mother = {
			character_event = {
				id = MageAp.85
				days = 1
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice70004
		trigger = {
			OR = {
				has_character_flag = recessive_mage
				AND = {
					OR = {
						trait = magic_potential_1
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						learning = 16
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 20
						}
					}
				}
				AND = {
					OR = {
						trait = magic_potential_2
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						learning = 14
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 17
						}
					}
				}
				AND = {
					OR = {
						trait = magic_potential_3
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						learning <= 12
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 15
						}
					}
				}
				AND = {
					OR = {
						trait = magic_potential_4
						has_character_flag = magic_potential_flag_4
					}
					NOT = {
						learning = 10
					}
					NOT = {
						check_variable = {
							which = magicxp
							value = 13
						}
					}
				}
			}
		}
		set_character_flag = failed_mage
		remove_trait = mage_apprentice
		prestige = -150
		event_target:mage_tutor = {
			character_event = {
				id = MageAp.86
			}
		}
		father = {
			character_event = {
				id = MageAp.87
				days = 1
			}
		}
		mother = {
			character_event = {
				id = MageAp.87
				days = 1
			}
		}
	}
}

#Ward - The Master extends the  training
character_event = {
	id = MageAp.75
	desc = EVTDESCsorcererapprentice70005
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTDESCsorcererapprentice70005
		hidden_tooltip = {
			FROM = {
				random_list = {
					50 = {
						character_event = {
							id = MageAp.6
							days = 250
							random = 150
						}
					}
					50 = {
						character_event = {
							id = MageAp.6
							days = 200
							random = 100
						}
					}
				}
			}
			random_list = {
				10 = {
					change_variable = {
						which = magicxp
						value = 2
					}
				}
				30 = {
					change_variable = {
						which = magicxp
						value = 1
					}
				}
				60 = {
				}
			}
		}
	}
}

#Notify Master the Apprentice has succeeded
character_event = {
	id = MageAp.8
	desc = EVTDESCsorcererapprentice8
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice8
		prestige = 50
		if = {
			limit = {
				is_college_of_magic_member = yes
			}
			add_society_currency_minor_effect = yes
		}
		remove_friend = FROM
	}
}

#Notify parents the Apprentice has succeeded
character_event = {
	id = MageAp.85
	desc = EVTDESCsorcererapprentice80005
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice80005
		prestige = 75
	}
}

#Notify Master the Apprentice has failed
character_event = {
	id = MageAp.86
	desc = EVTDESCsorcererapprentice80006
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice80006
		prestige = -50
		remove_friend = FROM
	}
}

#Notify parents the Apprentice has failed
character_event = {
	id = MageAp.87
	desc = EVTDESCsorcererapprentice80007
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice80007
		prestige = -75
	}
}

#The Tzeentchian 9 blesses the sorceror's apprentice
character_event = {
	id = MageAp.9
	desc = EVTDESCsorcererapprentice9
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice9		#Teach about the Patron
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 20
					}
				}
			}
			FROM = {
				NOT = {
					religion = ROOT
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.91
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice9		#Teach the tenets
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 20
					}
				}
			}
			FROM = {
				religion = ROOT
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.94
				}
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice9		#Teach spells
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 20
					}
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.95
				}
			}
		}
	}
	option = {
		name = EVTOPTDsorcererapprentice9		#Test student
		trigger = {
			FROM = {
				check_variable = {
					which = "mage_teaching"
					value = 20
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				set_variable = {
					which = "mage_teaching"
					value = 0
				}
				character_event = {
					id = MageAp.96
				}
			}
		}
	}
}

#Ward - Preached about the god
character_event = {
	id = MageAp.91
	desc = {
		text = EVTDESCAsorcererapprentice90001
		trigger = {
			FROM = {
				religion = tzeentch
			}
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice90001
		trigger = {
			FROM = {
				religion = nurgle
			}
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice90001
		trigger = {
			FROM = {
				religion = slaanesh
			}
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice90001
		FROM = {
			character_event = {
				id = MageAp.92
			}
			character_event = {
				id = MageAp.9
				days = 250
				random = 150
			}
		}
		if = {
			limit = {
				FROM = {
					religion = slaanesh
				}
			}
			religion = slaanesh
		}
		if = {
			limit = {
				FROM = {
					religion = tzeentch
				}
			}
			religion = tzeentch
		}
		if = {
			limit = {
				FROM = {
					religion = nurgle
				}
			}
			religion = nurgle
		}
		if = {
			limit = {
				religion = khorne
			}
			piety = -500
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.75
				FROM = {
					religion_group = ROOT
				}
			}
			modifier = {
				factor = 0.75
				religion = sigmarite
			}
			modifier = {
				factor = 1.25
				religion = northern_gods
			}
			modifier = {
				factor = 0.25
				religion = khorne
			}
			modifier = {
				factor = 0.15
				FROM = {
					religion = tzeentch
				}
				religion = khorne
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = ambitious
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = deceitful
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = paranoid
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = cruel
			}
			modifier = {
				factor = 1.5
				FROM = {
					religion = tzeentch
				}
				trait = lunatic_1
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = lunatic_2
			}
			modifier = {
				factor = 1.95
				FROM = {
					religion = tzeentch
				}
				trait = lunatic_3
			}
			modifier = {
				factor = 1.5
				FROM = {
					religion = tzeentch
				}
				trait = craven
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = envious
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = greedy
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = tzeentch
				}
				trait = proud
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = tzeentch
				}
				trait = kind
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = tzeentch
				}
				trait = charitable
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = tzeentch
				}
				trait = slothful
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = tzeentch
				}
				trait = content
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = tzeentch
				}
				trait = humble
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = tzeentch
				}
				trait = trusting
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = tzeentch
				}
				trait = honest
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = nurgle
				}
				trait = charitable
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = nurgle
				}
				trait = kind
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = nurgle
				}
				trait = trusting
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = nurgle
				}
				trait = gregarious
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = nurgle
				}
				trait = content
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = nurgle
				}
				trait = honest
			}
			modifier = {
				factor = 1.95
				FROM = {
					religion = nurgle
				}
				is_ill = yes
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = nurgle
				}
				trait = wroth
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = nurgle
				}
				trait = shy
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = nurgle
				}
				trait = proud
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = nurgle
				}
				trait = envious
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = nurgle
				}
				trait = ambitious
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = nurgle
				}
				trait = cruel
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = slaanesh
				}
				trait = lustful
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = slaanesh
				}
				trait = greedy
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = slaanesh
				}
				trait = gluttonous
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = slaanesh
				}
				trait = proud
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = slaanesh
				}
				trait = slothful
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = slaanesh
				}
				trait = envious
			}
			modifier = {
				factor = 1.75
				FROM = {
					religion = slaanesh
				}
				trait = cruel
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = slaanesh
				}
				trait = chaste
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = slaanesh
				}
				trait = shy
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = slaanesh
				}
				trait = temperate
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = slaanesh
				}
				trait = kind
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = slaanesh
				}
				trait = diligent
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = slaanesh
				}
				trait = charitable
			}
			modifier = {
				factor = 0.75
				FROM = {
					religion = slaanesh
				}
				trait = humble
			}
			#The Master's traits
			modifier = {
				factor = 1.75
				FROM = {
					trait = genius
				}
			}
			modifier = {
				factor = 1.65
				FROM = {
					trait = brilliant
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					trait = quick
				}
			}
			modifier = {
				factor = 1.45
				FROM = {
					trait = smart
				}
			}
			modifier = {
				factor = 1.35
				FROM = {
					trait = bright
				}
			}
			modifier = {
				factor = 0.85
				FROM = {
					trait = dim
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					trait = dumb
				}
			}
			modifier = {
				factor = 0.65
				FROM = {
					trait = slow
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					trait = idiot
				}
			}
			modifier = {
				factor = 0.45
				FROM = {
					trait = imbecile
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice90001
		FROM = {
			character_event = {
				id = MageAp.93
			}
			character_event = {
				id = MageAp.9
				days = 250
				random = 150
			}
		}
		ai_chance = {
			factor = 50
		}
	}
}

#Master - The Ward converted
character_event = {
	id = MageAp.92
	desc = {
		text = EVTDESCAsorcererapprentice90002
		trigger = {
			religion = tzeentch
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice90002
		trigger = {
			religion = nurgle
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice90002
		trigger = {
			religion = slaanesh
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice90002
		piety = 50
	}
}

#Master - The Ward did not convert
character_event = {
	id = MageAp.93
	desc = {
		text = EVTDESCAsorcererapprentice90003
		trigger = {
			religion = tzeentch
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice90003
		trigger = {
			religion = nurgle
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice90003
		trigger = {
			religion = slaanesh
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice90003
		piety = -25
	}
}

#Ward - The Master teaches you the tenets of the faith
character_event = {
	id = MageAp.94
	desc = {
		text = EVTDESCAsorcererapprentice90004
		trigger = {
			religion = tzeentch
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice90004
		trigger = {
			religion = nurgle
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice90004
		trigger = {
			religion = slaanesh
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice90004
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.9
					days = 250
					random = 150
				}
			}
			if = {
				limit = {
					religion = tzeentch
				}
				random_list = {
					10 = {
						add_trait = ambitious
					}
					10 = {
						add_trait = deceitful
					}
					10 = {
						add_trait = cruel
					}
					10 = {
						add_trait = paranoid
					}
					10 = {
						add_trait = envious
					}
					10 = {
						add_trait = stressed
					}
					10 = {
						add_trait = wounded
					}
					10 = {
						character_event = {
							id = mutate.5
						}
					}
					10 = {
						add_trait = arbitrary
					}
					10 = {
						add_trait = craven
					}
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				random_list = {
					10 = {
						add_trait = proud
					}
					10 = {
						add_trait = lustful
					}
					10 = {
						add_trait = gluttonous
					}
					10 = {
						add_trait = arbitrary
					}
					10 = {
						add_trait = gregarious
					}
					10 = {
						add_trait = stressed
					}
					10 = {
						add_trait = wounded
					}
					10 = {
						character_event = {
							id = mutate.5
						}
					}
					10 = {
						add_trait = addict
					}
					10 = {
						add_trait = drunkard
					}
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				random_list = {
					10 = {
						add_trait = kind
					}
					10 = {
						add_trait = charitable
					}
					10 = {
						add_trait = diligent
					}
					10 = {
						add_trait = patient
					}
					10 = {
						add_trait = humble
					}
					10 = {
						add_trait = depressed
					}
					10 = {
						add_trait = wounded
					}
					10 = {
						add_trait = has_nurgles_rot
					}
					10 = {
						add_trait = leper
					}
					10 = {
						add_trait = has_measles
					}
				}
			}
		}
	}
}

#Ward - The Master teaches to spells
character_event = {
	id = MageAp.95
	desc = EVTDESCsorcererapprentice90005
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice90005
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.9
					days = 250
					random = 150
				}
			}
			random_list = {
				50 = {
					if = {
						limit = {
							NOT = {
								learning = 20
							}
						}
						change_learning = 2
					}
					else = {
						add_character_modifier = {
							name = nocturnal_studies
							duration = 1095
						}
					}
				}
				50 = {
					magic_learning_reduce_bad_outcome = yes
				}
			}
		}
	}
}

#Ward - Test to see if the Gods favor you
character_event = {
	id = MageAp.96
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = {
				religion = tzeentch
			}
			random_list = {
				60 = {
					FROM = {
						character_event = {
							id = MageAp.97
						}
					}
					modifier = {
						factor = 0
						NOT = {
							trait = magic_potential_1
						}
						NOT = {
							trait = magic_potential_2
						}
						NOT = {
							trait = magic_potential_3
						}
						NOT = {
							trait = magic_potential_4
						}
						NOT = {
							has_character_flag = magic_potential_flag_1
						}
						NOT = {
							has_character_flag = magic_potential_flag_2
						}
						NOT = {
							has_character_flag = magic_potential_flag_3
						}
						NOT = {
							has_character_flag = magic_potential_flag_4
						}
					}
					modifier = {
						factor = 0
						NOT = {
							religion = tzeentch
						}
					}
				}
				40 = {
					chaos_spawn_effect = yes
					FROM = {
						character_event = {
							id = MageAp.98
						}
					}
					modifier = {
						factor = 0.5
						trait = genius
					}
					modifier = {
						factor = 0.65
						trait = brilliant
					}
					modifier = {
						factor = 0.75
						trait = quick
					}
					modifier = {
						factor = 0.85
						trait = smart
					}
					modifier = {
						factor = 0.95
						trait = bright
					}
					modifier = {
						factor = 1.25
						trait = dim
					}
					modifier = {
						factor = 1.35
						trait = dumb
					}
					modifier = {
						factor = 1.5
						trait = slow
					}
					modifier = {
						factor = 1.75
						trait = idiot
					}
					modifier = {
						factor = 1.95
						trait = imbecile
					}
					modifier = {
						factor = 1.5
						NOT = {
							learning = 20
						}
					}
					modifier = {
						factor = 1.5
						NOT = {
							learning = 15
						}
					}
					modifier = {
						factor = 1.75
						NOT = {
							learning = 10
						}
					}
					modifier = {
						factor = 1.95
						NOT = {
							learning = 5
						}
					}
					modifier = {
						factor = 0
						trait = magic_potential_4						#Tzeentch cares about potential
					}
					modifier = {
						factor = 0.25
						trait = magic_potential_3						#Tzeentch cares about potential
					}
					modifier = {
						factor = 0.5
						trait = magic_potential_2						#Tzeentch cares about potential
					}
					modifier = {
						factor = 0
						has_character_flag = magic_potential_flag_4						#Tzeentch cares about potential
					}
					modifier = {
						factor = 0.25
						has_character_flag = magic_potential_flag_3						#Tzeentch cares about potential
					}
					modifier = {
						factor = 0.5
						has_character_flag = magic_potential_flag_2						#Tzeentch cares about potential
					}
					modifier = {
						factor = 0.5
						trait = ambitious
					}
					modifier = {
						factor = 0.75
						trait = deceitful
					}
					modifier = {
						factor = 0.75
						trait = cruel
					}
					modifier = {
						factor = 0.75
						trait = envious
					}
					modifier = {
						factor = 0.75
						trait = paranoid
					}
					modifier = {
						factor = 0.75
						trait = arbitrary
					}
					modifier = {
						factor = 1.5
						trait = just
					}
					modifier = {
						factor = 1.5
						trait = kind
					}
					modifier = {
						factor = 1.75
						trait = content
					}
					modifier = {
						factor = 1.5
						trait = trusting
					}
					modifier = {
						factor = 1.75
						trait = honest
					}
				}
			}
		}
		if = {
			limit = {
				religion = nurgle
			}
			random_list = {
				80 = {
					FROM = {
						character_event = {
							id = MageAp.97
						}
					}
					modifier = {
						factor = 0
						NOT = {
							trait = magic_potential_1
						}
						NOT = {
							trait = magic_potential_2
						}
						NOT = {
							trait = magic_potential_3
						}
						NOT = {
							trait = magic_potential_4
						}
						NOT = {
							has_character_flag = magic_potential_flag_1
						}
						NOT = {
							has_character_flag = magic_potential_flag_2
						}
						NOT = {
							has_character_flag = magic_potential_flag_3
						}
						NOT = {
							has_character_flag = magic_potential_flag_4
						}
					}
					modifier = {
						factor = 0
						NOT = {
							religion = nurgle
						}
					}
				}
				20 = {
					FROM = {
						character_event = {
							id = MageAp.98
						}
					}
					if = {
						limit = {
							is_invincible_trigger = yes
						}
						antideath_effect = yes
						break = yes
					}
					death = {
						death_reason = death_murder_unknown
					}
					modifier = {
						factor = 0.5
						trait = hunchback						#Papa Nurgle loves all
					}
					modifier = {
						factor = 0.65
						trait = dwarf
					}
					modifier = {
						factor = 0.75
						trait = maimed
					}
					modifier = {
						factor = 0.85
						trait = lisp
					}
					modifier = {
						factor = 0.95
						trait = wounded
					}
					modifier = {
						factor = 1.25
						trait = hardy
					}
					modifier = {
						factor = 1.35
						trait = tough
					}
					modifier = {
						factor = 1.5
						trait = strong
					}
					modifier = {
						factor = 1.5
						trait = tall
					}
					modifier = {
						factor = 1.25
						NOT = {
							learning = 20
						}
					}
					modifier = {
						factor = 1.25
						NOT = {
							learning = 15
						}
					}
					modifier = {
						factor = 1.5
						NOT = {
							learning = 10
						}
					}
					modifier = {
						factor = 1.5
						NOT = {
							learning = 5
						}
					}
					modifier = {
						factor = 0.25
						trait = magic_potential_4
					}
					modifier = {
						factor = 0.5
						trait = magic_potential_3
					}
					modifier = {
						factor = 0.75
						trait = magic_potential_2
					}
					modifier = {
						factor = 0.25
						has_character_flag = magic_potential_flag_4
					}
					modifier = {
						factor = 0.5
						has_character_flag = magic_potential_flag_3
					}
					modifier = {
						factor = 0.75
						has_character_flag = magic_potential_flag_2
					}
					modifier = {
						factor = 0.5
						trait = charitable
					}
					modifier = {
						factor = 0.75
						trait = diligent
					}
					modifier = {
						factor = 0.75
						trait = kind
					}
					modifier = {
						factor = 0.75
						trait = humble
					}
					modifier = {
						factor = 0.75
						trait = content
					}
					modifier = {
						factor = 0.75
						trait = patient
					}
					modifier = {
						factor = 0.75
						trait = gregarious
					}
					modifier = {
						factor = 1.75
						trait = cruel
					}
					modifier = {
						factor = 1.5
						trait = greedy
					}
					modifier = {
						factor = 1.75
						trait = ambitious
					}
					modifier = {
						factor = 1.5
						trait = arbitrary
					}
					modifier = {
						factor = 1.5
						trait = shy
					}
					modifier = {
						factor = 1.5
						trait = slothful
					}
				}
			}
		}
		if = {
			limit = {
				religion = slaanesh
			}
			random_list = {
				70 = {
					FROM = {
						character_event = {
							id = MageAp.97
						}
					}
					modifier = {
						factor = 0
						NOT = {
							trait = magic_potential_1
						}
						NOT = {
							trait = magic_potential_2
						}
						NOT = {
							trait = magic_potential_3
						}
						NOT = {
							trait = magic_potential_4
						}
						NOT = {
							has_character_flag = magic_potential_flag_1
						}
						NOT = {
							has_character_flag = magic_potential_flag_2
						}
						NOT = {
							has_character_flag = magic_potential_flag_3
						}
						NOT = {
							has_character_flag = magic_potential_flag_4
						}
					}
					modifier = {
						factor = 0
						NOT = {
							religion = slaanesh
						}
					}
				}
				30 = {
					FROM = {
						character_event = {
							id = MageAp.98
						}
					}
					add_trait = disfigured
					modifier = {
						factor = 0.5
						trait = beautiful
					}
					modifier = {
						factor = 0.75
						trait = pretty
					}
					modifier = {
						factor = 0.85
						trait = fair
					}
					modifier = {
						factor = 2
						trait = plain						#The worst crime of all.
					}
					modifier = {
						factor = 1.85
						NOT = {
							trait = beautiful
						}
						NOT = {
							trait = pretty
						}
						NOT = {
							trait = fair
						}
						NOT = {
							trait = plain
						}
						NOT = {
							trait = ugly
						}
						NOT = {
							trait = unsightly
						}
						NOT = {
							trait = monstrous
						}
					}
					modifier = {
						factor = 0.85
						trait = ugly
					}
					modifier = {
						factor = 0.75
						trait = unsightly
					}
					modifier = {
						factor = 0.5
						trait = monstrous
					}
					modifier = {
						factor = 1.15
						NOT = {
							learning = 20
						}						#Slaanesh doesn't really care for learning
					}
					modifier = {
						factor = 1.15
						NOT = {
							learning = 15
						}
					}
					modifier = {
						factor = 1.25
						NOT = {
							learning = 10
						}
					}
					modifier = {
						factor = 1.25
						NOT = {
							learning = 5
						}
					}
					modifier = {
						factor = 0.45
						trait = magic_potential_4
					}
					modifier = {
						factor = 0.75
						trait = magic_potential_3
					}
					modifier = {
						factor = 0.85
						trait = magic_potential_2
					}
					modifier = {
						factor = 0.45
						has_character_flag = magic_potential_flag_4
					}
					modifier = {
						factor = 0.75
						has_character_flag = magic_potential_flag_3
					}
					modifier = {
						factor = 0.85
						has_character_flag = magic_potential_flag_2
					}
					modifier = {
						factor = 0.5
						trait = lustful
					}
					modifier = {
						factor = 0.75
						trait = gluttonous
					}
					modifier = {
						factor = 0.75
						trait = greedy
					}
					modifier = {
						factor = 0.75
						trait = proud
					}
					modifier = {
						factor = 0.75
						trait = gregarious
					}
					modifier = {
						factor = 0.75
						trait = drunkard
					}
					modifier = {
						factor = 0.75
						trait = addict
					}
					modifier = {
						factor = 1.75
						trait = chaste
					}
					modifier = {
						factor = 1.5
						trait = kind
					}
					modifier = {
						factor = 1.75
						trait = temperate
					}
					modifier = {
						factor = 1.5
						trait = charitable
					}
					modifier = {
						factor = 1.5
						trait = shy
					}
					modifier = {
						factor = 1.5
						trait = diligent
					}
				}
			}
		}
	}
}

#Master - The Ward became a mage
character_event = {
	id = MageAp.97
	desc = {
		text = EVTDESCAsorcererapprentice90007
		trigger = {
			religion = tzeentch
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice90007
		trigger = {
			religion = nurgle
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice90007
		trigger = {
			religion = slaanesh
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice90007
		FROM = {
			character_event = {
				id = MageAp.10
			}
		}
		piety = 50
	}
}

#Master - The Ward did not become a mage
character_event = {
	id = MageAp.98
	desc = {
		text = EVTDESCAsorcererapprentice90008
		trigger = {
			religion = tzeentch
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice90008
		trigger = {
			religion = nurgle
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice90008
		trigger = {
			religion = slaanesh
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice90008
		FROM = {
			character_event = {
				id = MageAp.11
			}
		}
		piety = -50
	}
}

#Ward - You're a mage
character_event = {
	id = MageAp.10
	desc = {
		text = EVTDESCAsorcererapprentice10
		trigger = {
			religion = tzeentch
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice10
		trigger = {
			religion = nurgle
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice10
		trigger = {
			religion = slaanesh
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice10
		piety = 150
		remove_friend = FROM
		remove_trait = mage_apprentice
		if = {
			limit = {
				FROM = {
					trait = lore_tzeentch
				}
			}
			add_trait = lore_tzeentch
		}
		if = {
			limit = {
				FROM = {
					trait = lore_nurgle
				}
			}
			add_trait = lore_nurgle
		}
		if = {
			limit = {
				FROM = {
					trait = lore_slaanesh
				}
			}
			add_trait = lore_slaanesh
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_4
			}
			add_trait = magic_potential_4
			clr_character_flag = magic_potential_flag_4
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_3
			}
			add_trait = magic_potential_3
			clr_character_flag = magic_potential_flag_3
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_2
			}
			add_trait = magic_potential_2
			clr_character_flag = magic_potential_flag_2
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_1
			}
			add_trait = magic_potential_1
			clr_character_flag = magic_potential_flag_1
		}
		magic_lvl_increase_effect = yes
		enable_magic_xp_effect = yes
	}
}

#Ward - You're not a mage
character_event = {
	id = MageAp.11
	desc = {
		text = EVTDESCAsorcererapprentice11
		trigger = {
			religion = tzeentch
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice11
		trigger = {
			religion = nurgle
		}
	}
	desc = {
		text = EVTDESCCsorcererapprentice11
		trigger = {
			religion = slaanesh
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice11
		piety = -150
		remove_friend = FROM
		remove_trait = mage_apprentice
	}
}

#####################################################
###Learn by yourself
#Which lore?
character_event = {
	id = MageAp.12
	desc = EVTDESCAsorcererapprentice12
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice12
		trigger = {
			culture_group = kislevite_group
		}
		set_character_flag = learning_lore_ice
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTHAGsorcererapprentice12
		trigger = {
			always = no
			culture_group = kislevite_group
		}		#Lore of Hag Users seek apprentices - Religious Lore
		set_character_flag = learning_lore_hag
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice12
		set_character_flag = learning_lore_metal
		if = {
			limit = {
				NOR = {
					has_character_modifier = experimenting_alchemist
					has_character_modifier = theoretical_alchemist
					has_artifact = magnum_opus_alchemy_panacea_1
					has_artifact = magnum_opus_alchemy_panacea_2
					has_artifact = magnum_opus_alchemy_panacea_3
					has_artifact = magnum_opus_alchemy_panacea_4
					has_artifact = magnum_opus_alchemy_transmutation_1
					has_artifact = magnum_opus_alchemy_transmutation_2
					has_artifact = magnum_opus_alchemy_transmutation_3
					has_artifact = magnum_opus_alchemy_transmutation_4
				}
			}
			custom_tooltip = {
				text = NOT_ALCHEMIST_UNSUCCESSFUL
			}
		}
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice12
		trigger = {
			NOR = {
				religion_group = necromantic_group
				culture = cathayan
			}
		}
		set_character_flag = learning_lore_fire
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTDsorcererapprentice12
		trigger = {
			OR = {
				NOR = {
					religion = taalite
					religion = grail
					religion = shallyan
					religion = asrai_cadai
				}
				trait = arbitrary
			}
		}
		set_character_flag = learning_lore_death
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTEsorcererapprentice12
		tooltip_info = intrigue
		trigger = {
			intrigue = 16
		}
		set_character_flag = learning_lore_shadows
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTGsorcererapprentice12
		trigger = {
			NOR = {
				culture_group = druchii_group
				religion_group = necromantic_group
			}
			OR = {
				culture_group = asur_group
				culture = cathayan
				any_friend = {
					OR = {
						culture_group = asur_group
						culture = cathayan
					}
					learning = 20					#Masterful enough to teach
					trait = lore_heavens
				}
			}
		}
		set_character_flag = learning_lore_heavens
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTIsorcererapprentice12
		trigger = {
			NOR = {
				culture_group = druchii_group
				religion_group = necromantic_group
			}
			OR = {
				culture_group = asur_group
				religion = old_faith
				trait = gardener
			}
		}
		set_character_flag = learning_lore_life
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	#Exceptional Lores
	option = {
		name = EVTOPTHsorcererapprentice12
		trigger = {
			NOR = {
				culture_group = druchii_group
				religion_group = necromantic_group
			}
			OR = {
				culture_group = asur_group
				any_friend = {
					OR = {
						culture_group = asur_group
						religion = grail
					}
					learning = 20					#Masterful enough to teach
					trait = lore_light
				}
			}
			has_character_flag = lore_light_potential
		}
		set_character_flag = learning_lore_light
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
	option = {
		name = EVTOPTIsorcererapprentice12
		trigger = {
			NOR = {
				culture_group = druchii_group
				religion_group = necromantic_group
			}
			OR = {
				culture = amazon_main
				trait = hunter
				religion = taalite
				has_character_flag = wolf_blood_inherited
				has_character_flag = wolf_blood_first_generation
				has_character_modifier = lycanthropy
				has_character_modifier = wolf_child
				has_character_modifier = wolf_blood
			}
		}
		set_character_flag = learning_lore_beasts
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 15
			}
		}
	}
}

#Training, decide how.
character_event = {
	id = MageAp.13
	desc = {
		text = EVTDESCAsorcererapprentice13
		trigger = {
			is_college_of_magic_member = no
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice13
		trigger = {
			is_college_of_magic_member = yes
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	trigger = {
		is_alive = yes
		NOT = { is_trained_mage_trigger = yes }
		OR = {
			is_college_of_magic_member = no
			AND = {
				is_college_of_magic_member = yes
				has_character_flag = college_member_learning_on_own
			}
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice13		#Buy more books and materials
		ai_chance = {
			factor = 50
		}
		trigger = {
			NOR = {
				check_variable = {
					which = "mage_learning"
					value = 8
				}
			}
			is_college_of_magic_member = no
		}
		scaled_wealth = {
			value = -1
			max = -75
		}
		hidden_tooltip = {
			change_variable = {
				which = "mage_learning"
				value = 1
			}
			character_event = {
				id = MageAp.131
				days = 15
				random = 10
			}
		}
	}
	option = {
		name = EVTOPTEsorcererapprentice13		#Head to the college library
		ai_chance = {
			factor = 50
		}
		trigger = {
			NOT = {
				check_variable = {
					which = "mage_learning"
					value = 8
				}
			}
			is_college_of_magic_member = yes
		}
		hidden_tooltip = {
			change_variable = {
				which = "mage_learning"
				value = 1
			}
			character_event = {
				id = MageAp.131
				days = 15
				random = 10
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice13		#Try to experiment
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.2
				is_smart_trigger = no
			}
			modifier = {
				factor = 2
				is_dumb_trigger = yes
			}
		}
		trigger = {
			NOT = {
				check_variable = {
					which = "mage_learning"
					value = 8
				}
			}
		}
		hidden_tooltip = {
			change_variable = {
				which = "mage_learning"
				value = 1
			}
			character_event = {
				id = MageAp.132
				days = 15
				random = 10
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice13		#Test yourself - Fake buying materials
		trigger = {
			check_variable = {
				which = "mage_learning"
				value = 8
			}
		}
		scaled_wealth = {
			value = -1
			max = -75
		}
		hidden_tooltip = {
			set_variable = {
				which = "mage_learning"
				value = 0
			}
			clr_character_flag = learning_as_kid
			character_event = {
				id = MageAp.14
				days = 15
				random = 10
			}
		}
	}
	option = {
		name = EVTOPTDsorcererapprentice13		#Test yourself - Fake experimenting
		trigger = {
			check_variable = {
				which = "mage_learning"
				value = 8
			}
		}
		hidden_tooltip = {
			set_variable = {
				which = "mage_learning"
				value = 0
			}
			clr_character_flag = learning_as_kid
			character_event = {
				id = MageAp.14
				days = 15
				random = 10
			}
		}
	}
}

#Buying more materials - Safer, but with less chance of success
character_event = {
	id = MageAp.131
	desc = {
		text = EVTDESCAsorcererapprentice13001
		trigger = {
			is_college_of_magic_member = no
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice13001
		trigger = {
			is_college_of_magic_member = yes
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice13001
		hidden_tooltip = {
			character_event = {
				id = MageAp.13
				days = 150
				random = 350
			}
			random_list = {
				15 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				85 = {
					magic_learning_reduce_bad_outcome = yes
				}
			}
		}
	}
}

#Experimenting - Riskier, but with higher chance of success
character_event = {
	id = MageAp.132
	desc = {
		text = EVTDESCAsorcererapprentice13002
		trigger = {
			is_college_of_magic_member = no
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice13002
		trigger = {
			is_college_of_magic_member = yes
		}
	}
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice13002
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.13
					days = 250
					random = 150
				}
			}
			random_list = {
				10 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 2
					}
					else = {
						add_character_modifier = {
							name = nocturnal_studies
							duration = 1095
						}
					}
				}
				15 = {
					if = {
						limit = {
							NOT = {
								learning = 20
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				70 = {
					magic_learning_reduce_bad_outcome = yes
				}
				25 = {
					magic_learning_reduce_bad_outcome = yes
					character_event = {
						id = MageAp.133
					}
				}				#wounded
				20 = {
					magic_learning_reduce_bad_outcome = yes
					character_event = {
						id = MageAp.134
					}
				}				#disfigured
				5 = {
					magic_learning_reduce_bad_outcome = yes
					character_event = {
						id = MageAp.135
					}
				}				#killed
			}
		}
	}
}

#Wounded by experiment
character_event = {
	id = MageAp.133
	desc = EVTDESCsorcererapprentice13003
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice13003
		if = {
			limit = {
				NOT = {
					trait = wounded
				}
			}
			add_trait = wounded
		}
		if = {
			limit = {
				trait = wounded
				NOT = {
					trait = maimed
				}
			}
			add_trait = maimed
		}
		if = {
			limit = {
				NOT = {
					trait = wounded
				}
				NOT = {
					trait = maimed
				}
			}
			health = -2
		}
		random = {
			chance = 50
			add_trait = stressed
		}
	}
}

#Disfigured by experiment
character_event = {
	id = MageAp.134
	desc = EVTDESCsorcererapprentice13004
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice13004
		if = {
			limit = {
				NOT = {
					trait = disfigured
				}
			}
			add_trait = disfigured
		}
		if = {
			limit = {
				trait = disfigured
			}
			health = -2
		}
		random = {
			chance = 50
			add_trait = stressed
		}
	}
}

#Death by experiment
character_event = {
	id = MageAp.135
	desc = EVTDESCsorcererapprentice13005
	picture = "GFX_evt_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice13005
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_accident
		}
	}
}

#Check if the Mage Apprentice has managed to achieve his goals
character_event = {
	id = MageAp.14
	picture = "GFX_evt_apprentice"
	desc = {
		text = EVTDESCAsorcererapprentice14
		trigger = {
			learning = 21
			is_incapable = no
			OR = {
				trait = magic_potential_1
				trait = magic_potential_2
				trait = magic_potential_3
				trait = magic_potential_4
				has_character_flag = magic_potential_flag_1
				has_character_flag = magic_potential_flag_2
				has_character_flag = magic_potential_flag_3
				has_character_flag = magic_potential_flag_4
			}
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice14
		trigger = {
			OR = {
				is_incapable = yes
				NOT = {
					learning = 21
				}
				AND = {
					NOT = {
						trait = magic_potential_1
					}
					NOT = {
						trait = magic_potential_2
					}
					NOT = {
						trait = magic_potential_3
					}
					NOT = {
						trait = magic_potential_4
					}
					NOT = {
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						has_character_flag = magic_potential_flag_4
					}
				}
			}
		}
	}
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice14
		trigger = {
			learning = 21
			is_incapable = no
			OR = {
				trait = magic_potential_1
				trait = magic_potential_2
				trait = magic_potential_3
				trait = magic_potential_4
				has_character_flag = magic_potential_flag_1
				has_character_flag = magic_potential_flag_2
				has_character_flag = magic_potential_flag_3
				has_character_flag = magic_potential_flag_4
			}
		}
		prestige = 100
		if = {
			limit = {
				has_character_flag = learning_lore_beasts
			}
			add_trait = lore_beasts
			clr_character_flag = learning_lore_beasts
		}
		if = {
			limit = {
				has_character_flag = learning_lore_ice
			}
			add_trait = lore_ice
			clr_character_flag = learning_lore_ice
		}
		if = {
			limit = {
				has_character_flag = learning_lore_fire
			}
			add_trait = lore_fire
			clr_character_flag = learning_lore_fire
		}
		if = {
			limit = {
				has_character_flag = learning_lore_metal
			}
			add_trait = lore_metal
			clr_character_flag = learning_lore_metal
		}
		if = {
			limit = {
				has_character_flag = learning_lore_beasts
			}
			add_trait = lore_beasts
			clr_character_flag = learning_lore_beasts
		}
		if = {
			limit = {
				has_character_flag = learning_lore_light
			}
			add_trait = lore_light
			clr_character_flag = learning_lore_light
		}
		if = {
			limit = {
				has_character_flag = learning_lore_shadows
			}
			add_trait = lore_shadows
			clr_character_flag = learning_lore_shadows
		}
		if = {
			limit = {
				has_character_flag = learning_lore_death
			}
			add_trait = lore_death
			clr_character_flag = learning_lore_death
		}
		if = {
			limit = {
				has_character_flag = learning_lore_heavens
			}
			add_trait = lore_heavens
			clr_character_flag = learning_lore_heavens
		}
		if = {
			limit = {
				has_character_flag = learning_lore_life
			}
			add_trait = lore_life
			clr_character_flag = learning_lore_life
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_1
			}
			add_trait = magic_potential_1
			clr_character_flag = magic_potential_flag_1
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_2
			}
			add_trait = magic_potential_2
			clr_character_flag = magic_potential_flag_2
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_3
			}
			add_trait = magic_potential_3
			clr_character_flag = magic_potential_flag_3
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_4
			}
			add_trait = magic_potential_4
			clr_character_flag = magic_potential_flag_4
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice14
		trigger = {
			OR = {
				NOT = {
					learning = 21
				}
				is_incapable = yes
				AND = {
					NOT = {
						trait = magic_potential_1
					}
					NOT = {
						trait = magic_potential_2
					}
					NOT = {
						trait = magic_potential_3
					}
					NOT = {
						trait = magic_potential_4
					}
					NOT = {
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						has_character_flag = magic_potential_flag_4
					}
				}
			}
		}
		remove_trait = hedge_wizard
		prestige = -150
	}
}

########################################################################
##############################Necromancy Training#######################
#Necromancy Training, decide how.
character_event = {
	id = MageAp.15
	desc = EVTDESCsorcererapprentice15
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15		#Buy more books and materials
		ai_chance = {
			factor = 50
		}
		trigger = {
			NOT = {
				check_variable = {
					which = "necromancy_learning"
					value = 8
				}
			}
		}
		scaled_wealth = {
			value = -1
			max = -75
		}
		hidden_tooltip = {
			change_variable = {
				which = "necromancy_learning"
				value = 1
			}
			character_event = {
				id = MageAp.15001
				days = 15
				random = 10
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice15		#Try to experiment
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.2
				is_smart_trigger = no
			}
			modifier = {
				factor = 2
				is_dumb_trigger = yes
			}
		}
		trigger = {
			NOT = {
				check_variable = {
					which = "necromancy_learning"
					value = 8
				}
			}
		}
		hidden_tooltip = {
			change_variable = {
				which = "necromancy_learning"
				value = 1
			}
			character_event = {
				id = MageAp.15002
				days = 15
				random = 10
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice15		#Test yourself - Fake buying materials
		trigger = {
			check_variable = {
				which = "necromancy_learning"
				value = 8
			}
		}
		scaled_wealth = {
			value = -1
			max = -75
		}
		hidden_tooltip = {
			set_variable = {
				which = "necromancy_learning"
				value = 0
			}
			clr_character_flag = learning_as_kid
			character_event = {
				id = MageAp.16
				days = 15
				random = 10
			}
		}
	}
	option = {
		name = EVTOPTDsorcererapprentice15		#Test yourself - Fake experimenting
		trigger = {
			check_variable = {
				which = "necromancy_learning"
				value = 8
			}
		}
		hidden_tooltip = {
			set_variable = {
				which = "necromancy_learning"
				value = 0
			}
			clr_character_flag = learning_as_kid
			character_event = {
				id = MageAp.16
				days = 15
				random = 10
			}
		}
	}
}

#Buying more materials - Safer, but with less chance of success
character_event = {
	id = MageAp.15001
	desc = EVTDESCsorcererapprentice15001
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15001
		hidden_tooltip = {
			character_event = {
				id = MageAp.15
				days = 150
				random = 350
			}
			if = {
				limit = {
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
					NOT = {
						has_character_flag = undead_insight
					}
					NOT = {
						has_character_flag = nagash_book_quest
					}
				}
				character_event = {
					id = MageAp.15003
					days = 80
					random = 90
				}
			}
			random_list = {
				5 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 2
					}
					else = {
						add_character_modifier = {
							name = nocturnal_studies
							duration = 1095
						}
					}
				}
				10 = {
					if = {
						limit = {
							NOT = {
								learning = 20
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				85 = {
					magic_learning_reduce_bad_outcome = yes
					modifier = {
						factor = 0.75
						has_character_modifier = the_necronomicon
					}
					modifier = {
						factor = 0.75
						religion = nagashi
					}
					modifier = {
						factor = 0.95
						religion = vampiric
					}
					modifier = {
						factor = 1.85
						NOT = {
							trait = vampire_lahmian_visible
						}
						NOT = {
							trait = vampire_carstein_visible
						}
						NOT = {
							trait = vampire_blood_visible
						}
						NOT = {
							trait = vampire_strigoi_visible
						}
						NOT = {
							trait = vampire_necrarch_visible
						}
						NOT = {
							trait = vampire_jade_visible
						}
						NOT = {
							trait = vampire_mahtmasi_visible
						}
						NOT = {
							trait = vampire_lahmian_hidden
						}
						NOT = {
							trait = vampire_carstein_hidden
						}
						NOT = {
							trait = vampire_blood_hidden
						}
						NOT = {
							trait = vampire_strigoi_hidden
						}
						NOT = {
							trait = vampire_necrarch_hidden
						}
						NOT = {
							trait = vampire_jade_hidden
						}
						NOT = {
							trait = vampire_mahtmasi_hidden
						}
					}
				}
				10 = {
					magic_learning_reduce_bad_outcome = yes
					character_event = {
						id = MageAp.135
					}
				}				#killed
			}
		}
	}
}

#Experimenting - Riskier, but with higher chance of success
character_event = {
	id = MageAp.15002
	desc = EVTDESCsorcererapprentice15002
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15002
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.15
					days = 250
					random = 150
				}
			}
			if = {
				limit = {
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
					NOT = {
						has_character_flag = undead_insight
					}
					NOT = {
						has_character_flag = nagash_book_quest
					}
				}
				character_event = {
					id = MageAp.15003
					days = 80
					random = 90
				}
			}
			random_list = {
				10 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 2
					}
					else = {
						add_character_modifier = {
							name = nocturnal_studies
							duration = 1095
						}
					}
				}
				20 = {
					if = {
						limit = {
							NOT = {
								learning = 20
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				70 = {
					magic_learning_reduce_bad_outcome = yes
					modifier = {
						factor = 0.75
						has_character_modifier = the_necronomicon
					}
					modifier = {
						factor = 0.75
						religion = nagashi
					}
					modifier = {
						factor = 0.95
						religion = vampiric
					}
					modifier = {
						factor = 1.85
						NOT = {
							trait = vampire_lahmian_visible
						}
						NOT = {
							trait = vampire_carstein_visible
						}
						NOT = {
							trait = vampire_blood_visible
						}
						NOT = {
							trait = vampire_strigoi_visible
						}
						NOT = {
							trait = vampire_necrarch_visible
						}
						NOT = {
							trait = vampire_jade_visible
						}
						NOT = {
							trait = vampire_mahtmasi_visible
						}
						NOT = {
							trait = vampire_lahmian_hidden
						}
						NOT = {
							trait = vampire_carstein_hidden
						}
						NOT = {
							trait = vampire_blood_hidden
						}
						NOT = {
							trait = vampire_strigoi_hidden
						}
						NOT = {
							trait = vampire_necrarch_hidden
						}
						NOT = {
							trait = vampire_jade_hidden
						}
						NOT = {
							trait = vampire_mahtmasi_hidden
						}
					}
				}
				20 = {
					magic_learning_reduce_bad_outcome = yes
					character_event = {
						id = MageAp.133
					}
				}				#wounded
				20 = {
					magic_learning_reduce_bad_outcome = yes
					character_event = {
						id = MageAp.134
					}
				}				#disfigured
				10 = {
					magic_learning_reduce_bad_outcome = yes
					character_event = {
						id = MageAp.135
					}
				}				#killed
			}
		}
	}
}

#The apprentice is not a vampire/vampire worshipper/nagashi
character_event = {
	id = MageAp.15003
	desc = EVTDESCsorcererapprentice15003
	picture = "GFX_evt_nagash"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15003
		wealth = -500		#search for a copy of the book
		character_event = {
			id = MageAp.15004
			days = 245
			random = 199
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice15003
		trigger = {
			trait = khemri_tomb_king
		}		#experiment with your own soldiers and liches
		character_event = {
			id = MageAp.15009
			days = 245
			random = 199
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice15003
		trigger = {
			liege = {
				OR = {
					AND = {
						religion = nagashi						#ask your undead liege for insight
						trait = khemri_tomb_king
					}
					trait = vampire_lahmian_visible
					trait = vampire_carstein_visible
					trait = vampire_blood_visible
					trait = vampire_strigoi_visible
					trait = vampire_necrarch_visible
					trait = vampire_jade_visible
					trait = vampire_mahtmasi_visible
					trait = vampire_lahmian_hidden
					trait = vampire_carstein_hidden
					trait = vampire_blood_hidden
					trait = vampire_strigoi_hidden
					trait = vampire_necrarch_hidden
					trait = vampire_jade_hidden
					trait = vampire_mahtmasi_hidden
				}
			}
		}
		liege = {
			character_event = {
				id = MageAp.15012
			}
		}
	}
	option = {
		name = EVTOPTDsorcererapprentice15003		#pursue research on your own
	}
}

#Found Nagash's book
character_event = {
	id = MageAp.15004
	desc = EVTDESCsorcererapprentice15004
	picture = "GFX_evt_nagash"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15004		#Dare to open
		hidden_tooltip = {
			random_list = {
				10 = {
					modifier = {
						factor = 1.75
						trait = khemri_tomb_king
					}
					modifier = {
						factor = 1.5
						trait = genius
					}
					modifier = {
						factor = 1.25
						trait = brilliant
					}
					modifier = {
						factor = 1.25
						trait = brave
					}
					character_event = {
						id = MageAp.15005
						days = 45
						random = 99
					}
				}
				#critical success
				30 = {
					modifier = {
						factor = 1.5
						trait = khemri_tomb_king
					}
					modifier = {
						factor = 1.25
						trait = genius
					}
					modifier = {
						factor = 1.05
						trait = brilliant
					}
					modifier = {
						factor = 1.05
						trait = brave
					}
					character_event = {
						id = MageAp.15006
						days = 45
						random = 99
					}
				}
				#success
				40 = {
					character_event = {
						id = MageAp.15007
						days = 15
						random = 39
					}
				}				#insanity
				20 = {
					character_event = {
						id = MageAp.15008
						days = 5
						random = 4
					}
				}				#death
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice15004		#Dare not
		random = {
			chance = 10
			add_trait = craven
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Nagash's book - Critical success
character_event = {
	id = MageAp.15005
	desc = EVTDESCsorcererapprentice15005
	picture = "GFX_evt_nagash"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15005
		change_learning = 4
		set_character_flag = undead_insight
		clr_character_flag = nagash_book_quest
		religion = nagashi
	}
}

#Nagash's book - Success
character_event = {
	id = MageAp.15006
	desc = EVTDESCsorcererapprentice15006
	picture = "GFX_evt_nagash"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15006
		change_learning = 1
		set_character_flag = undead_insight
		clr_character_flag = nagash_book_quest
		religion = nagashi
	}
}

#Nagash's book - Insanity
character_event = {
	id = MageAp.15007
	desc = EVTDESCsorcererapprentice15007
	picture = "GFX_evt_nagash"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15007
		change_learning = 1
		set_character_flag = undead_insight
		clr_character_flag = nagash_book_quest
		religion = nagashi
		hidden_tooltip = {
			change_variable = {
				which = "lunatic_counter"
				value = 9
			}
			character_event = {
				id = mutate.5
			}
		}
		#lunacy
	}
}

#Nagash's book - Death
character_event = {
	id = MageAp.15008
	desc = EVTDESCsorcererapprentice15008
	picture = "GFX_evt_nagash"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15008
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_murder_unknown
		}
	}
}

#Tomb King experiments on his own servants
character_event = {
	id = MageAp.15009
	desc = EVTDESCsorcererapprentice15009
	picture = GFX_evt_khemri_king
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15009		#Dare to experiment
		hidden_tooltip = {
			random_list = {
				70 = {
					character_event = {
						id = MageAp.15010
						days = 145
						random = 199
					}
				}				#success
				30 = {
					character_event = {
						id = MageAp.15011
						days = 145
						random = 199
					}
				}				#failure
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice15009		#Dare not
		piety = 50
		random = {
			chance = 30
			add_trait = kind
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Experimenting on servants - Success
character_event = {
	id = MageAp.15010
	desc = EVTDESCsorcererapprentice15010
	picture = GFX_evt_khemri_king
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15010
		prestige = -500
		piety = -500
		change_learning = 1
		set_character_flag = undead_insight
		clr_character_flag = nagash_book_quest
		religion = nagashi
	}
}

#Experimenting on servants - Failure
character_event = {
	id = MageAp.15011
	desc = EVTDESCsorcererapprentice15011
	picture = GFX_evt_khemri_king
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15011
		prestige = -500
		piety = -500
	}
}

#Liege notified an apprentice necromancer asks for assistance
character_event = {
	id = MageAp.15012
	desc = EVTDESCsorcererapprentice15012
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTDsorcererapprentice15012		#Sure
		trigger = {
			FROM = {
				religion_group = ROOT
			}
		}
		FROM = {
			character_event = {
				id = MageAp.15016
				days = 1
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				trait = paranoid
			}
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice15012		#Only if you convert
		trigger = {
			FROM = {
				NOT = {
					religion_group = ROOT
				}
			}
		}
		FROM = {
			character_event = {
				id = MageAp.15013
				days = 1
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0.5
				trait = paranoid
			}
			modifier = {
				factor = 0.1
				FROM = {
					trait = creature_nehekharan
				}
			}
			modifier = {
				factor = 0				#Vampire will desire to turn, not just convert, unless just
				FROM = {
					trait = creature_human
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
				}
				trait = just
				OR = {
					trait = vampire_lahmian_visible
					trait = vampire_carstein_visible
					trait = vampire_blood_visible
					trait = vampire_strigoi_visible
					trait = vampire_necrarch_visible
					trait = vampire_jade_visible
					trait = vampire_mahtmasi_visible
					trait = vampire_lahmian_hidden
					trait = vampire_carstein_hidden
					trait = vampire_blood_hidden
					trait = vampire_strigoi_hidden
					trait = vampire_necrarch_hidden
					trait = vampire_jade_hidden
					trait = vampire_mahtmasi_hidden
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice15012		#Only if you turn
		trigger = {
			FROM = {
				NOT = {
					trait = creature_nehekharan
				}
				trait = creature_human
				NOT = {
					trait = vampire_lahmian_visible
				}
				NOT = {
					trait = vampire_carstein_visible
				}
				NOT = {
					trait = vampire_blood_visible
				}
				NOT = {
					trait = vampire_strigoi_visible
				}
				NOT = {
					trait = vampire_necrarch_visible
				}
				NOT = {
					trait = vampire_jade_visible
				}
				NOT = {
					trait = vampire_mahtmasi_visible
				}
				NOT = {
					trait = vampire_lahmian_hidden
				}
				NOT = {
					trait = vampire_carstein_hidden
				}
				NOT = {
					trait = vampire_blood_hidden
				}
				NOT = {
					trait = vampire_strigoi_hidden
				}
				NOT = {
					trait = vampire_necrarch_hidden
				}
				NOT = {
					trait = vampire_jade_hidden
				}
				NOT = {
					trait = vampire_mahtmasi_hidden
				}
			}
			OR = {
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
			}
		}
		FROM = {
			character_event = {
				id = MageAp.15017
				days = 1
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = just
			}
			modifier = {
				factor = 0.5
				trait = kind
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice15012		#Not worthy
		FROM = {
			character_event = {
				id = MageAp.15020
				days = 1
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 1.25
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = lunatic_2
			}
			modifier = {
				factor = 0.5
				trait = lunatic_3
			}
			modifier = {
				factor = 0.9
				ROOT = {
					opinion = {
						who = FROM
						value = 20
					}
				}
			}
			modifier = {
				factor = 0.8
				ROOT = {
					opinion = {
						who = FROM
						value = 40
					}
				}
			}
			modifier = {
				factor = 0.7
				ROOT = {
					opinion = {
						who = FROM
						value = 60
					}
				}
			}
			modifier = {
				factor = 0.6
				ROOT = {
					opinion = {
						who = FROM
						value = 80
					}
				}
			}
			modifier = {
				factor = 0.5
				ROOT = {
					opinion = {
						who = FROM
						value = 100
					}
				}
			}
		}
	}
}

#Liege asks conversion for assistance
character_event = {
	id = MageAp.15013
	desc = EVTDESCsorcererapprentice15013
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15013		#Yes
		religion = FROM
		set_character_flag = undead_insight
		change_learning = 1
		FROM = {
			character_event = {
				id = MageAp.15014
			}
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 1.25
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = lunatic_2
			}
			modifier = {
				factor = 0.5
				trait = lunatic_3
			}
			modifier = {
				factor = 0.1
				trait = khemri_tomb_king
			}
			modifier = {
				factor = 0.75
				trait = proud
			}
			modifier = {
				factor = 0
				has_character_flag = ai_flag_refuse_conversion
			}
			modifier = {
				factor = 1.25
				ROOT = {
					opinion = {
						who = FROM
						value = 20
					}
				}
			}
			modifier = {
				factor = 1.5
				ROOT = {
					opinion = {
						who = FROM
						value = 40
					}
				}
			}
			modifier = {
				factor = 1.75
				ROOT = {
					opinion = {
						who = FROM
						value = 60
					}
				}
			}
			modifier = {
				factor = 1.85
				ROOT = {
					opinion = {
						who = FROM
						value = 80
					}
				}
			}
			modifier = {
				factor = 1.95
				ROOT = {
					opinion = {
						who = FROM
						value = 100
					}
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice15013		#No
		FROM = {
			character_event = {
				id = MageAp.15015
			}
		}
		ai_chance = {
			factor = 30
		}
	}
}

#Apprentice accepts conversion
character_event = {
	id = MageAp.15014
	desc = EVTDESCsorcererapprentice15014
	picture = GFX_evt_old_apprentice
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15014
		prestige = 250
		piety = 250
	}
}

#Apprentice refuses conversion
character_event = {
	id = MageAp.15015
	desc = EVTDESCsorcererapprentice15015
	picture = GFX_evt_old_apprentice
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15015
		prestige = -250
		piety = -250
	}
}

#Liege allows study without requests
character_event = {
	id = MageAp.15016
	desc = EVTDESCsorcererapprentice15016
	picture = GFX_evt_old_apprentice
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15016
		set_character_flag = undead_insight
		change_learning = 1
	}
}

#Liege ask turning for assistance
character_event = {
	id = MageAp.15017
	desc = EVTDESCsorcererapprentice15017
	picture = "GFX_evt_vampire_kiss"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15017		#Yes
		FROM = {
			character_event = {
				id = MageAp.15018
			}
		}
		change_learning = 1
		opinion = {
			modifier = opinion_sired_me
			who = FROM
			months = 240000
		}
		ai_chance = {
			factor = 60
			modifier = {
				factor = 0.75
				trait = paranoid
			}
			modifier = {
				factor = 1.5
				trait = craven
			}
			modifier = {
				factor = 1.5
				age = 40
			}
			modifier = {
				factor = 1.75
				religion_group = FROM
			}
			modifier = {
				factor = 1.5
				trait = lunatic_2
			}
			modifier = {
				factor = 1.5
				trait = lunatic_3
			}
			modifier = {
				factor = 0.75
				trait = proud
			}
			modifier = {
				factor = 0
				has_character_flag = ai_flag_refuse_conversion
			}
			modifier = {
				factor = 1.25
				ROOT = {
					opinion = {
						who = FROM
						value = 20
					}
				}
			}
			modifier = {
				factor = 1.5
				ROOT = {
					opinion = {
						who = FROM
						value = 40
					}
				}
			}
			modifier = {
				factor = 1.75
				ROOT = {
					opinion = {
						who = FROM
						value = 60
					}
				}
			}
			modifier = {
				factor = 1.85
				ROOT = {
					opinion = {
						who = FROM
						value = 80
					}
				}
			}
			modifier = {
				factor = 1.95
				ROOT = {
					opinion = {
						who = FROM
						value = 100
					}
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice15017		#No
		FROM = {
			character_event = {
				id = MageAp.15019
			}
		}
		ai_chance = {
			factor = 40
		}
	}
}

#Apprentice accepts to be turned
character_event = {
	id = MageAp.15018
	title = UNDEATH
	desc = EVTDESCsorcererapprentice15018
	picture = "GFX_evt_vampire_kiss"
	is_triggered_only = yes
	option = {
		name = EXCELLENT
		root_makes_from_vampire_effect = yes
	}
}

#Apprentice refuses to be turned
character_event = {
	id = MageAp.15019
	desc = EVTDESCsorcererapprentice15019
	picture = GFX_evt_old_apprentice
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15019
		prestige = -50
	}
}

#Liege considers apprentice unworthy
character_event = {
	id = MageAp.15020
	desc = EVTDESCsorcererapprentice15020
	picture = GFX_evt_old_apprentice
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice15020
		prestige = -50
	}
}

#Check if the Necromancer Apprentice has managed to achieve his goals
character_event = {
	id = MageAp.16
	picture = "GFX_evt_old_apprentice"
	desc = {
		text = EVTDESCAsorcererapprentice16
		trigger = {
			OR = {
				learning = 29
				AND = {
					learning = 21
					OR = {
						trait = vampire_lahmian_visible
						trait = vampire_carstein_visible
						trait = vampire_blood_visible
						trait = vampire_strigoi_visible
						trait = vampire_necrarch_visible
						trait = vampire_jade_visible
						trait = vampire_mahtmasi_visible
						trait = vampire_lahmian_hidden
						trait = vampire_carstein_hidden
						trait = vampire_blood_hidden
						trait = vampire_strigoi_hidden
						trait = vampire_necrarch_hidden
						trait = vampire_jade_hidden
						trait = vampire_mahtmasi_hidden
						has_character_flag = undead_insight
					}
				}
			}
			is_incapable = no
			OR = {
				trait = magic_potential_1
				trait = magic_potential_2
				trait = magic_potential_3
				trait = magic_potential_4
				has_character_flag = magic_potential_flag_1
				has_character_flag = magic_potential_flag_2
				has_character_flag = magic_potential_flag_3
				has_character_flag = magic_potential_flag_4
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
				trait = khemri_tomb_king
			}
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice16
		trigger = {
			OR = {
				AND = {
					NOT = {
						learning = 29
					}
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
					NOT = {
						has_character_flag = undead_insight
					}
				}
				AND = {
					NOT = {
						learning = 21
					}
					OR = {
						trait = vampire_lahmian_visible
						trait = vampire_carstein_visible
						trait = vampire_blood_visible
						trait = vampire_strigoi_visible
						trait = vampire_necrarch_visible
						trait = vampire_jade_visible
						trait = vampire_mahtmasi_visible
						trait = vampire_lahmian_hidden
						trait = vampire_carstein_hidden
						trait = vampire_blood_hidden
						trait = vampire_strigoi_hidden
						trait = vampire_necrarch_hidden
						trait = vampire_jade_hidden
						trait = vampire_mahtmasi_hidden
					}
				}
				is_incapable = yes
				AND = {
					NOT = {
						trait = magic_potential_1
					}
					NOT = {
						trait = magic_potential_2
					}
					NOT = {
						trait = magic_potential_3
					}
					NOT = {
						trait = magic_potential_4
					}
					NOT = {
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						has_character_flag = magic_potential_flag_4
					}
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
				}
			}
		}
	}
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice16
		trigger = {
			OR = {
				learning = 29
				AND = {
					learning = 21
					OR = {
						trait = vampire_lahmian_visible
						trait = vampire_carstein_visible
						trait = vampire_blood_visible
						trait = vampire_strigoi_visible
						trait = vampire_necrarch_visible
						trait = vampire_jade_visible
						trait = vampire_mahtmasi_visible
						trait = vampire_lahmian_hidden
						trait = vampire_carstein_hidden
						trait = vampire_blood_hidden
						trait = vampire_strigoi_hidden
						trait = vampire_necrarch_hidden
						trait = vampire_jade_hidden
						trait = vampire_mahtmasi_hidden
						has_character_flag = undead_insight
					}
				}
			}
			is_incapable = no
			OR = {
				trait = magic_potential_1
				trait = magic_potential_2
				trait = magic_potential_3
				trait = magic_potential_4
				has_character_flag = magic_potential_flag_1
				has_character_flag = magic_potential_flag_2
				has_character_flag = magic_potential_flag_3
				has_character_flag = magic_potential_flag_4
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
				trait = khemri_tomb_king
			}
		}
		prestige = 100
		add_trait = lore_necromancy
		if = {
			limit = {
				OR = {
					trait = vampire_lahmian_visible
					trait = vampire_carstein_visible
					trait = vampire_blood_visible
					trait = vampire_strigoi_visible
					trait = vampire_necrarch_visible
					trait = vampire_jade_visible
					trait = vampire_mahtmasi_visible
					trait = vampire_lahmian_hidden
					trait = vampire_carstein_hidden
					trait = vampire_blood_hidden
					trait = vampire_strigoi_hidden
					trait = vampire_necrarch_hidden
					trait = vampire_jade_hidden
					trait = vampire_mahtmasi_hidden
					trait = khemri_tomb_king
				}
			}
			remove_trait = hedge_wizard
		}
		#Undead are naturals
		if = {
			limit = {
				has_character_flag = magic_potential_flag_4
			}
			add_trait = magic_potential_4
			clr_character_flag = magic_potential_flag_4
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_3
			}
			add_trait = magic_potential_3
			clr_character_flag = magic_potential_flag_3
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_2
			}
			add_trait = magic_potential_2
			clr_character_flag = magic_potential_flag_2
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_1
			}
			add_trait = magic_potential_1
			clr_character_flag = magic_potential_flag_1
		}
		magic_lvl_increase_effect = yes
		enable_magic_xp_effect = yes
		clr_character_flag = nagash_book_quest
		clr_character_flag = undead_insight
	}
	option = {
		name = EVTOPTBsorcererapprentice16
		trigger = {
			OR = {
				AND = {
					NOT = {
						learning = 29
					}
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
					NOT = {
						has_character_flag = undead_insight
					}
				}
				AND = {
					NOT = {
						learning = 21
					}
					OR = {
						trait = vampire_lahmian_visible
						trait = vampire_carstein_visible
						trait = vampire_blood_visible
						trait = vampire_strigoi_visible
						trait = vampire_necrarch_visible
						trait = vampire_jade_visible
						trait = vampire_mahtmasi_visible
						trait = vampire_lahmian_hidden
						trait = vampire_carstein_hidden
						trait = vampire_blood_hidden
						trait = vampire_strigoi_hidden
						trait = vampire_necrarch_hidden
						trait = vampire_jade_hidden
						trait = vampire_mahtmasi_hidden
					}
				}
				is_incapable = yes
				AND = {
					NOT = {
						trait = magic_potential_1
					}
					NOT = {
						trait = magic_potential_2
					}
					NOT = {
						trait = magic_potential_3
					}
					NOT = {
						trait = magic_potential_4
					}
					NOT = {
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						has_character_flag = magic_potential_flag_4
					}
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
				}
			}
		}
		remove_trait = hedge_wizard
		prestige = -150
		clr_character_flag = nagash_book_quest
		clr_character_flag = undead_insight
	}
}

############################
#Necromancer/Vampire asks if you want to learn the dark magic from him
character_event = {
	id = MageAp.17
	desc = EVTDESCsorcererapprentice17
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	trigger = {
		FROMFROM = {
			is_alive = yes
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice17		#Yes
		religion = FROMFROM
		set_character_flag = undead_insight
		change_learning = 1
		hidden_tooltip = {
			add_friend = FROMFROM
			add_trait = mage_apprentice
			set_character_flag = mage_master@FROMFROM
			FROMFROM = {
				character_event = {
					id = MageAp.19
					days = 350
				}
			}			#Start teaching
			if = {
				limit = {
					FROMFROM = {
						religion_group = cadai_group
					}
					e_ulthuan = {
						holder_scope = {
							religion_group = cadai_group
						}
					}
				}
				e_ulthuan = {
					holder_scope = {
						opinion = {
							modifier = opinion_unauthorized_tutoring
							who = FROMFROM
						}
					}
				}
			}
			if = {
				limit = {
					FROMFROM = {
						religion_group = cytharai_group
						is_female = yes
					}
					e_naggaroth = {
						holder_scope = {
							trait = malekith
						}
					}
				}
				e_naggaroth = {
					holder_scope = {
						opinion = {
							modifier = opinion_unauthorized_tutoring
							who = FROMFROM
						}
					}
				}
			}
			if = {
				limit = {
					trait = creature_elf
					is_female = no
					e_naggaroth = {
						holder_scope = {
							trait = malekith
						}
					}
				}
				e_naggaroth = {
					holder_scope = {
						opinion = {
							modifier = opinion_sorcerous_rival
							who = ROOT
						}
					}
				}
			}
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 1.25
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = lunatic_2
			}
			modifier = {
				factor = 0.5
				trait = lunatic_3
			}
			modifier = {
				factor = 0.25
				trait = khemri_tomb_king
			}
			modifier = {
				factor = 0.75
				trait = proud
			}
			modifier = {
				factor = 0
				has_character_flag = ai_flag_refuse_conversion
			}
			modifier = {
				factor = 1.25
				ROOT = {
					opinion = {
						who = FROMFROM
						value = 20
					}
				}
			}
			modifier = {
				factor = 1.5
				ROOT = {
					opinion = {
						who = FROMFROM
						value = 40
					}
				}
			}
			modifier = {
				factor = 1.75
				ROOT = {
					opinion = {
						who = FROMFROM
						value = 60
					}
				}
			}
			modifier = {
				factor = 1.85
				ROOT = {
					opinion = {
						who = FROMFROM
						value = 80
					}
				}
			}
			modifier = {
				factor = 1.95
				ROOT = {
					opinion = {
						who = FROMFROM
						value = 100
					}
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice17		#No
		hidden_tooltip = {
			FROMFROM = {
				character_event = {
					id = MageAp.18
				}
			}
		}
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				trait = vampire_necrarch_visible
			}
			modifier = {
				factor = 1.25
				NOT = {
					opinion = {
						who = FROMFROM
						value = -20
					}
				}
			}
			modifier = {
				factor = 1.5
				NOT = {
					opinion = {
						who = FROMFROM
						value = -40
					}
				}
			}
			modifier = {
				factor = 1.75
				NOT = {
					opinion = {
						who = FROMFROM
						value = -60
					}
				}
			}
			modifier = {
				factor = 1.85
				NOT = {
					opinion = {
						who = FROMFROM
						value = -80
					}
				}
			}
			modifier = {
				factor = 1.95
				NOT = {
					opinion = {
						who = FROMFROM
						value = -99
					}
				}
			}
		}
	}
}

#Subject refused apprenticeship
character_event = {
	id = MageAp.18
	desc = EVTDESCsorcererapprentice18
	picture = GFX_evt_old_apprentice
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice18
		prestige = -50
		add_character_modifier = {
			name = apprenticeship_refused_necr
			hidden = yes
			duration = 36500
		}
	}
}

#Training, decide how.
character_event = {
	id = MageAp.19
	desc = EVTDESCsorcererapprentice19
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	trigger = {
		FROM = {
			is_alive = yes
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice19		#Teach caution
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 20
					}
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.19001
				}
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice19		#Teach to experiment
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 20
					}
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.19002
				}
			}
		}
	}
	option = {
		name = EVTOPTCsorcererapprentice19		#Teach focus
		trigger = {
			NOT = {
				FROM = {
					check_variable = {
						which = "mage_teaching"
						value = 20
					}
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = {
					which = "mage_teaching"
					value = 1
				}
				character_event = {
					id = MageAp.19003
				}
			}
		}
	}
	option = {
		name = EVTOPTDsorcererapprentice19		#Test student
		trigger = {
			FROM = {
				check_variable = {
					which = "mage_teaching"
					value = 20
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				set_variable = {
					which = "mage_teaching"
					value = 0
				}
				character_event = {
					id = MageAp.19004
				}
			}
		}
	}
}

#Ward - The Master teaches caution
character_event = {
	id = MageAp.19001
	desc = EVTDESCsorcererapprentice19001
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	trigger = {
		FROM = {
			is_alive = yes
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice19001
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.19
					days = 250
					random = 150
				}
			}
			random_list = {
				50 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				50 = {
					magic_learning_reduce_bad_outcome = yes
					modifier = {
						factor = 1.35
						NOT = {
							trait = vampire_lahmian_visible
						}
						NOT = {
							trait = vampire_carstein_visible
						}
						NOT = {
							trait = vampire_blood_visible
						}
						NOT = {
							trait = vampire_strigoi_visible
						}
						NOT = {
							trait = vampire_necrarch_visible
						}
						NOT = {
							trait = vampire_jade_visible
						}
						NOT = {
							trait = vampire_mahtmasi_visible
						}
						NOT = {
							trait = vampire_lahmian_hidden
						}
						NOT = {
							trait = vampire_carstein_hidden
						}
						NOT = {
							trait = vampire_blood_hidden
						}
						NOT = {
							trait = vampire_strigoi_hidden
						}
						NOT = {
							trait = vampire_necrarch_hidden
						}
						NOT = {
							trait = vampire_jade_hidden
						}
						NOT = {
							trait = vampire_mahtmasi_hidden
						}
						NOT = {
							trait = khemri_tomb_king
						}
					}
					modifier = {
						factor = 0.95
						FROM = {
							OR = {
								trait = vampire_lahmian_visible
								trait = vampire_carstein_visible
								trait = vampire_blood_visible
								trait = vampire_strigoi_visible
								trait = vampire_necrarch_visible
								trait = vampire_jade_visible
								trait = vampire_mahtmasi_visible
								trait = vampire_lahmian_hidden
								trait = vampire_carstein_hidden
								trait = vampire_blood_hidden
								trait = vampire_strigoi_hidden
								trait = vampire_necrarch_hidden
								trait = vampire_jade_hidden
								trait = vampire_mahtmasi_hidden
							}
						}
					}
					modifier = {
						factor = 0.95
						FROM = {
							religion = nagashi
						}
					}
					modifier = {
						factor = 1.45
						FROM = {
							NOT = {
								has_character_modifier = magic_power_1
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_2
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_3
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_4
							}
						}
					}
				}
			}
		}
	}
}

#Ward - The Master teaches to experiment
character_event = {
	id = MageAp.19002
	desc = EVTDESCsorcererapprentice19002
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	trigger = {
		FROM = {
			is_alive = yes
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice19002
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.19
					days = 250
					random = 150
				}
			}
			random_list = {
				20 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 2
					}
					else = {
						add_character_modifier = {
							name = nocturnal_studies
							duration = 1095
						}
					}
				}
				20 = {
					if = {
						limit = {
							NOT = {
								learning = 20
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				60 = {
					magic_learning_reduce_bad_outcome = yes
					modifier = {
						factor = 1.35
						NOT = {
							trait = vampire_lahmian_visible
						}
						NOT = {
							trait = vampire_carstein_visible
						}
						NOT = {
							trait = vampire_blood_visible
						}
						NOT = {
							trait = vampire_strigoi_visible
						}
						NOT = {
							trait = vampire_necrarch_visible
						}
						NOT = {
							trait = vampire_jade_visible
						}
						NOT = {
							trait = vampire_mahtmasi_visible
						}
						NOT = {
							trait = vampire_lahmian_hidden
						}
						NOT = {
							trait = vampire_carstein_hidden
						}
						NOT = {
							trait = vampire_blood_hidden
						}
						NOT = {
							trait = vampire_strigoi_hidden
						}
						NOT = {
							trait = vampire_necrarch_hidden
						}
						NOT = {
							trait = vampire_jade_hidden
						}
						NOT = {
							trait = vampire_mahtmasi_hidden
						}
						NOT = {
							trait = khemri_tomb_king
						}
					}
					modifier = {
						factor = 0.95
						FROM = {
							OR = {
								trait = vampire_lahmian_visible
								trait = vampire_carstein_visible
								trait = vampire_blood_visible
								trait = vampire_strigoi_visible
								trait = vampire_necrarch_visible
								trait = vampire_jade_visible
								trait = vampire_mahtmasi_visible
								trait = vampire_lahmian_hidden
								trait = vampire_carstein_hidden
								trait = vampire_blood_hidden
								trait = vampire_strigoi_hidden
								trait = vampire_necrarch_hidden
								trait = vampire_jade_hidden
								trait = vampire_mahtmasi_hidden
							}
						}
					}
					modifier = {
						factor = 0.95
						FROM = {
							religion = nagashi
						}
					}
					modifier = {
						factor = 1.45
						FROM = {
							NOT = {
								has_character_modifier = magic_power_1
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_2
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_3
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_4
							}
						}
					}
				}
			}
		}
	}
}

#Ward - The Master teaches to focus
character_event = {
	id = MageAp.19003
	desc = EVTDESCsorcererapprentice19003
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	trigger = {
		FROM = {
			is_alive = yes
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice19003
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = MageAp.19
					days = 250
					random = 150
				}
			}
			random_list = {
				50 = {
					if = {
						limit = {
							NOT = {
								learning = 15
							}
						}
						change_learning = 1
					}
					else = {
						add_character_modifier = {
							name = new_insights
							duration = 1095
						}
					}
				}
				50 = {
					magic_learning_reduce_bad_outcome = yes
					modifier = {
						factor = 1.35
						NOT = {
							trait = vampire_lahmian_visible
						}
						NOT = {
							trait = vampire_carstein_visible
						}
						NOT = {
							trait = vampire_blood_visible
						}
						NOT = {
							trait = vampire_strigoi_visible
						}
						NOT = {
							trait = vampire_necrarch_visible
						}
						NOT = {
							trait = vampire_jade_visible
						}
						NOT = {
							trait = vampire_mahtmasi_visible
						}
						NOT = {
							trait = vampire_lahmian_hidden
						}
						NOT = {
							trait = vampire_carstein_hidden
						}
						NOT = {
							trait = vampire_blood_hidden
						}
						NOT = {
							trait = vampire_strigoi_hidden
						}
						NOT = {
							trait = vampire_necrarch_hidden
						}
						NOT = {
							trait = vampire_jade_hidden
						}
						NOT = {
							trait = vampire_mahtmasi_hidden
						}
						NOT = {
							trait = khemri_tomb_king
						}
					}
					modifier = {
						factor = 0.95
						FROM = {
							OR = {
								trait = vampire_lahmian_visible
								trait = vampire_carstein_visible
								trait = vampire_blood_visible
								trait = vampire_strigoi_visible
								trait = vampire_necrarch_visible
								trait = vampire_jade_visible
								trait = vampire_mahtmasi_visible
								trait = vampire_lahmian_hidden
								trait = vampire_carstein_hidden
								trait = vampire_blood_hidden
								trait = vampire_strigoi_hidden
								trait = vampire_necrarch_hidden
								trait = vampire_jade_hidden
								trait = vampire_mahtmasi_hidden
							}
						}
					}
					modifier = {
						factor = 0.95
						FROM = {
							religion = nagashi
						}
					}
					modifier = {
						factor = 1.45
						FROM = {
							NOT = {
								has_character_modifier = magic_power_1
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_2
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_3
							}
						}
						FROM = {
							NOT = {
								has_character_modifier = magic_power_4
							}
						}
					}
				}
			}
		}
	}
}

#Check if the Mage Apprentice has managed to achieve his goals
character_event = {
	id = MageAp.19004
	picture = "GFX_evt_old_apprentice"
	desc = {
		text = EVTDESCAsorcererapprentice19004
		trigger = {
			learning = 21
			is_incapable = no
			OR = {
				trait = magic_potential_1
				trait = magic_potential_2
				trait = magic_potential_3
				trait = magic_potential_4
				has_character_flag = magic_potential_flag_1
				has_character_flag = magic_potential_flag_2
				has_character_flag = magic_potential_flag_3
				has_character_flag = magic_potential_flag_4
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
				trait = khemri_tomb_king
			}
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice19004
		trigger = {
			OR = {
				is_incapable = yes
				NOT = {
					learning = 21
				}
				AND = {
					NOT = {
						trait = magic_potential_1
					}
					NOT = {
						trait = magic_potential_2
					}
					NOT = {
						trait = magic_potential_3
					}
					NOT = {
						trait = magic_potential_4
					}
					NOT = {
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						has_character_flag = magic_potential_flag_4
					}
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
					NOT = {
						trait = khemri_tomb_king
					}
				}
			}
		}
	}
	is_triggered_only = yes
	trigger = {
		FROM = {
			is_alive = yes
		}
	}
	option = {
		name = EVTOPTAsorcererapprentice19004
		trigger = {
			learning = 21
			is_incapable = no
			OR = {
				trait = magic_potential_1
				trait = magic_potential_2
				trait = magic_potential_3
				trait = magic_potential_4
				has_character_flag = magic_potential_flag_1
				has_character_flag = magic_potential_flag_2
				has_character_flag = magic_potential_flag_3
				has_character_flag = magic_potential_flag_4
				trait = vampire_lahmian_visible
				trait = vampire_carstein_visible
				trait = vampire_blood_visible
				trait = vampire_strigoi_visible
				trait = vampire_necrarch_visible
				trait = vampire_jade_visible
				trait = vampire_mahtmasi_visible
				trait = vampire_lahmian_hidden
				trait = vampire_carstein_hidden
				trait = vampire_blood_hidden
				trait = vampire_strigoi_hidden
				trait = vampire_necrarch_hidden
				trait = vampire_jade_hidden
				trait = vampire_mahtmasi_hidden
				trait = khemri_tomb_king
			}
		}
		remove_trait = mage_apprentice
		prestige = 150
		add_trait = lore_necromancy
		if = {
			limit = {
				has_character_flag = magic_potential_flag_4
			}
			add_trait = magic_potential_4
			clr_character_flag = magic_potential_flag_4
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_3
			}
			add_trait = magic_potential_3
			clr_character_flag = magic_potential_flag_3
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_2
			}
			add_trait = magic_potential_2
			clr_character_flag = magic_potential_flag_2
		}
		if = {
			limit = {
				has_character_flag = magic_potential_flag_1
			}
			add_trait = magic_potential_1
			clr_character_flag = magic_potential_flag_1
		}
		magic_lvl_increase_effect = yes
		enable_magic_xp_effect = yes
		FROM = {
			character_event = {
				id = MageAp.20
			}
		}
		father = {
			character_event = {
				id = MageAp.20005
				days = 1
			}
		}
		mother = {
			character_event = {
				id = MageAp.20005
				days = 1
			}
		}
	}
	option = {
		name = EVTOPTBsorcererapprentice19004
		trigger = {
			OR = {
				NOT = {
					learning = 21
				}
				is_incapable = yes
				AND = {
					NOT = {
						trait = magic_potential_1
					}
					NOT = {
						trait = magic_potential_2
					}
					NOT = {
						trait = magic_potential_3
					}
					NOT = {
						trait = magic_potential_4
					}
					NOT = {
						has_character_flag = magic_potential_flag_1
					}
					NOT = {
						has_character_flag = magic_potential_flag_2
					}
					NOT = {
						has_character_flag = magic_potential_flag_3
					}
					NOT = {
						has_character_flag = magic_potential_flag_4
					}
					NOT = {
						trait = vampire_lahmian_visible
					}
					NOT = {
						trait = vampire_carstein_visible
					}
					NOT = {
						trait = vampire_blood_visible
					}
					NOT = {
						trait = vampire_strigoi_visible
					}
					NOT = {
						trait = vampire_necrarch_visible
					}
					NOT = {
						trait = vampire_jade_visible
					}
					NOT = {
						trait = vampire_mahtmasi_visible
					}
					NOT = {
						trait = vampire_lahmian_hidden
					}
					NOT = {
						trait = vampire_carstein_hidden
					}
					NOT = {
						trait = vampire_blood_hidden
					}
					NOT = {
						trait = vampire_strigoi_hidden
					}
					NOT = {
						trait = vampire_necrarch_hidden
					}
					NOT = {
						trait = vampire_jade_hidden
					}
					NOT = {
						trait = vampire_mahtmasi_hidden
					}
					NOT = {
						trait = khemri_tomb_king
					}
				}
			}
		}
		remove_trait = mage_apprentice
		prestige = -150
		FROM = {
			character_event = {
				id = MageAp.20006
			}
		}
		father = {
			character_event = {
				id = MageAp.20007
				days = 1
			}
		}
		mother = {
			character_event = {
				id = MageAp.20007
				days = 1
			}
		}
	}
}

#Notify Master the Apprentice has succeeded
character_event = {
	id = MageAp.20
	desc = EVTDESCsorcererapprentice20
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice20
		prestige = 50
		remove_friend = FROM
	}
}

#Notify parents the Apprentice has succeeded
character_event = {
	id = MageAp.20005
	desc = EVTDESCsorcererapprentice20005
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice20005
		prestige = 75
	}
}

#Notify Master the Apprentice has failed
character_event = {
	id = MageAp.20006
	desc = EVTDESCsorcererapprentice20006
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice20006
		prestige = -50
		remove_friend = FROM
	}
}

#Notify parents the Apprentice has failed
character_event = {
	id = MageAp.20007
	desc = EVTDESCsorcererapprentice20007
	picture = "GFX_evt_old_apprentice"
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice20007
		prestige = -75
	}
}

character_event = {
	id = MageAp.100
	hide_window = yes
	is_triggered_only = yes
	only_rulers = yes
	capable_only = yes
	min_age = 12
	max_age = 90
	trigger = {
		prisoner = no
		higher_tier_than = COUNT
		trait = creature_human
		NOT = {
			any_courtier = {
				OR = {
					has_character_modifier = magic_power_1
					has_character_modifier = magic_power_2
					has_character_modifier = magic_power_3
					has_character_modifier = magic_power_4
				}
			}
		}
		NOT = {
			religion = taalite
		}
		NOT = {
			religion = ulrican
		}
		NOT = {
			religion = manannite
		}
		NOT = {
			religion = shallyan
		}
		NOT = {
			religion = myrmidian
		}
		NOT = {
			religion = grail
		}
		NOT = {
			religion = sigmarite
		}
		OR = {
			religion = kislev_gods
			religion_group = chaos_gods_group
			religion = northern_gods
			religion_group = ormazd_gods_group
		}
		OR = {
			independent = yes
			liege = {
				NOT = {
					religion = taalite
				}
				NOT = {
					religion = ulrican
				}
				NOT = {
					religion = manannite
				}
				NOT = {
					religion = shallyan
				}
				NOT = {
					religion = myrmidian
				}
				NOT = {
					religion = grail
				}
				NOT = {
					religion = sigmarite
				}
			}
		}
	}
	immediate = {
		if = {
			limit = {
				religion_group = chaos_gods_group
			}
			character_event = {
				id = MageAp.101
			}
		}
		if = {
			limit = {
				religion = northern_gods
			}
			character_event = {
				id = MageAp.102
			}
		}
		if = {
			limit = {
				religion_group = ormazd_gods_group
			}
			character_event = {
				id = MageAp.103
			}
		}
		if = {
			limit = {
				religion = kislev_gods
			}
			character_event = {
				id = MageAp.104
			}
		}
	}
}

# A chaos worshipper gets visited by a shaman
character_event = {
	id = MageAp.101
	desc = EVTDESCsorcererapprentice10001
	picture = GFX_evt_wandering_mage
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice10001
		trigger = {
			wealth = 150
		}
		wealth = -150
		hidden_tooltip = {
			random_list = {
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = ROOT
						culture = khazag
						female = yes
						age = 35
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = ROOT
						culture = kul
						female = yes
						age = 61
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = ROOT
						culture = yusak
						female = no
						age = 43
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = ROOT
						culture = aghol
						female = no
						age = 57
					}
				}
			}
			new_character = {
				piety = 20
				prestige = 50
				add_trait = creature_human
				random_list = {
					30 = {
					}
					60 = {
						add_trait = hedge_wizard
					}
				}
				random_list = {
					30 = {
						add_trait = magic_potential_1
					}
					60 = {
						add_trait = magic_potential_2
					}
				}
				random_list = {
					50 = {
						add_trait = lore_tzeentch
						religion = tzeentch
					}
					25 = {
						add_trait = lore_nurgle
						religion = nurgle
					}
					25 = {
						add_trait = lore_slaanesh
						religion = slaanesh
					}
				}
				magic_power_random_effect = yes
				random_list = {
					# Small chance of having some unusual trait
					2 = {
						add_trait = blinded
					}
					1 = {
						add_trait = disfigured
					}
					1 = {
						add_trait = arbitrary
					}
					1 = {
						add_trait = cruel
					}
					1 = {
						add_trait = berserker
					}
					1 = {
						add_trait = zealous
					}
					2 = {
						add_trait = cynical
					}
					5 = {
						add_trait = mystic
					}
					1 = {
						add_trait = bright
					}
					1 = {
						add_trait = quick
					}
					48 = {
					}
				}
				custom_tooltip = {
					text = mutations_test_tt
					mutation_toughness_test_effect = yes
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				religion = khorne
			}
		}
	}
	option = {
		#Cannot afford it
		name = EVTOPTBsorcererapprentice10001
		ai_chance = {
			factor = 50
		}
	}
}

# A Norscan gets visited by a shaman
character_event = {
	id = MageAp.102
	desc = {
		text = EVTDESCsorcererapprentice10002
		trigger = {
			NOT = {
				religion = stromfels
			}
		}
	}
	desc = {
		text = EVTDESCBsorcererapprentice10002
		trigger = {
			religion = stromfels
		}
	}
	picture = GFX_evt_wandering_mage
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice10002
		trigger = {
			wealth = 150
		}
		wealth = -150
		hidden_tooltip = {
			random_list = {
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = ROOT
						culture = ROOT
						female = yes
						age = 27
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = ROOT
						culture = ROOT
						female = yes
						age = 54
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = ROOT
						culture = ROOT
						female = no
						age = 33
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = ROOT
						culture = ROOT
						female = no
						age = 67
					}
				}
			}
			new_character = {
				piety = 20
				prestige = 50
				add_trait = creature_human
				random_list = {
					30 = {
					}
					60 = {
						add_trait = hedge_wizard
					}
				}
				random_list = {
					30 = {
						add_trait = magic_potential_1
					}
					60 = {
						add_trait = magic_potential_2
					}
				}
				random_list = {
					15 = {
						add_trait = lore_beasts
					}
					15 = {
						add_trait = lore_metal
					}
					20 = {
						add_trait = lore_life
					}
					20 = {
						add_trait = lore_death
					}
					20 = {
						add_trait = lore_fire
					}
					10 = {
						add_trait = lore_shadows
					}
				}
				magic_power_random_effect = yes
				random_list = {
					# Small chance of having some unusual trait
					2 = {
						add_trait = blinded
					}
					1 = {
						add_trait = disfigured
					}
					1 = {
						add_trait = arbitrary
					}
					1 = {
						add_trait = cruel
					}
					1 = {
						add_trait = berserker
					}
					1 = {
						add_trait = zealous
					}
					2 = {
						add_trait = cynical
					}
					5 = {
						add_trait = scarred
					}
					1 = {
						add_trait = bright
					}
					1 = {
						add_trait = quick
					}
					48 = {
					}
				}
				custom_tooltip = {
					text = mutations_test_tt
					mutation_toughness_test_effect = yes
				}
			}
		}
		#closes hiddentooltip
		ai_chance = {
			factor = 50
		}
	}
	option = {
		#Cannot afford it
		name = EVTOPTBsorcererapprentice10002
		ai_chance = {
			factor = 50
		}
	}
}

# An Arabyan is visited by a Scholar
character_event = {
	id = MageAp.103
	desc = EVTDESCsorcererapprentice10003
	picture = GFX_evt_wandering_mage
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice10003
		trigger = {
			wealth = 175
		}
		wealth = -175
		hidden_tooltip = {
			random_list = {
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = ROOT
						culture = ROOT
						female = no
						age = 42
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = ROOT
						culture = ROOT
						female = no
						age = 22
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = ROOT
						culture = ROOT
						female = no
						age = 48
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = ROOT
						culture = ROOT
						female = no
						age = 57
					}
				}
			}
			new_character = {
				piety = 50
				prestige = 75
				add_trait = creature_human
				add_trait = arabyan_scholar
				random_list = {
					60 = {
					}
					30 = {
						add_trait = hedge_wizard
					}
				}
				random_list = {
					30 = {
						add_trait = magic_potential_1
					}
					60 = {
						add_trait = magic_potential_2
					}
				}
				random_list = {
					20 = {
						add_trait = lore_light
					}
					20 = {
						add_trait = lore_metal
					}
					10 = {
						add_trait = lore_heavens
					}
					50 = {
						add_trait = lore_fire
					}
				}
				magic_power_random_effect = yes
				random_list = {
					# Small chance of having some unusual trait
					2 = {
						add_trait = blinded
					}
					1 = {
						add_trait = disfigured
					}
					1 = {
						add_trait = eunuch
					}
					1 = {
						add_trait = cruel
					}
					1 = {
						add_trait = just
					}
					1 = {
						add_trait = zealous
					}
					2 = {
						add_trait = cynical
					}
					5 = {
						add_trait = kind
					}
					1 = {
						add_trait = bright
					}
					1 = {
						add_trait = quick
					}
					48 = {
					}
				}
				random_list = {
					# Small chance of having some unusual trait
					3 = {
						add_trait = lunatic_1
						set_variable = {
							which = "lunatic_counter"
							value = 6
						}
					}
					1 = {
						add_trait = lunatic_2
						set_variable = {
							which = "lunatic_counter"
							value = 12
						}
					}
					1 = {
						add_trait = lunatic_2
						set_variable = {
							which = "lunatic_counter"
							value = 17
						}
						add_character_modifier = {
							name = despairing_laughter
							duration = -1
						}
					}
					1 = {
						add_trait = lunatic_2
						set_variable = {
							which = "lunatic_counter"
							value = 15
						}
						add_character_modifier = {
							name = blind_virtue
							duration = -1
						}
					}
					94 = {
					}
				}
			}
		}
		#closes hiddentooltip
		ai_chance = {
			factor = 50
		}
	}
	option = {
		#Cannot afford it
		name = EVTOPTBsorcererapprentice10003
		ai_chance = {
			factor = 50
		}
	}
}

# A Kislevite is visited by a Witch
character_event = {
	id = MageAp.104
	desc = EVTDESCsorcererapprentice10004
	picture = GFX_evt_wandering_mage
	is_triggered_only = yes
	option = {
		name = EVTOPTAsorcererapprentice10004
		wealth = -100
		hidden_tooltip = {
			random_list = {
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = kislev_gods
						culture = kislevite
						female = yes
						age = 25
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = kislev_gods
						culture = kislevite
						female = yes
						age = 32
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = RANDOM
						religion = kislev_gods
						culture = kislevite
						female = yes
						age = 51
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						learning = 13
						dynasty = NONE
						religion = kislev_gods
						culture = kislevite
						female = yes
						age = 77
					}
				}
			}
			new_character = {
				piety = 50
				prestige = 75
				add_trait = creature_human
				random_list = {
					40 = {
						modifier = {
							factor = 0.5
							not = {
								religion = northern_gods
							}
						}
						religion = northern_gods
						random_list = {
							50 = {
								culture = ungol
							}
							50 = {
								culture = ROOT
							}
						}
						add_trait = hag_witch
						add_trait = lore_hag
					}
					10 = {
						add_trait = witch
						add_trait = lore_ice
					}
					50 = {
						add_trait = ice_witch
						join_society = ice_witch_sisterhood
						add_trait = lore_ice
					}
				}
				random_list = {
					30 = {
						add_trait = magic_potential_1
					}
					60 = {
						add_trait = magic_potential_2
					}
				}
				magic_power_random_effect = yes
				random_list = {
					# Small chance of having some unusual trait
					2 = {
						add_trait = blinded
					}
					1 = {
						add_trait = scarred
					}
					1 = {
						add_trait = envious
					}
					1 = {
						add_trait = cruel
					}
					1 = {
						add_trait = just
					}
					1 = {
						add_trait = zealous
					}
					2 = {
						add_trait = cynical
					}
					5 = {
						add_trait = kind
					}
					1 = {
						add_trait = bright
					}
					1 = {
						add_trait = quick
					}
					48 = {
					}
				}
				random_list = {
					# Small chance of having some unusual trait
					1 = {
						add_trait = lunatic_1
						set_variable = {
							which = "lunatic_counter"
							value = 6
						}
					}
					1 = {
						add_trait = lunatic_2
						set_variable = {
							which = "lunatic_counter"
							value = 12
						}
					}
					1 = {
						add_trait = lunatic_2
						set_variable = {
							which = "lunatic_counter"
							value = 15
						}
						add_character_modifier = {
							name = blind_virtue
							duration = -1
						}
					}
					97 = {
					}
				}
			}
		}
		#closes hiddentooltip
		ai_chance = {
			factor = 1
		}
	}
}
