###########################################
#                                         #
# M&M Monastic Artifacts Events           #
#                                         #
# ID ARMS.9000-ARMS.9999		              #
#                                         #
###########################################

#IDs:
#1-200 Deadly
#9000-9199 Mathilda
#9200-9399 Henrik / Milla
#9400-9599 David
#9600-9799 / 9030-9032 Drikus
#9800-9898 Axel
#9899-9999 Joel

namespace = ARMS
character_event = {
    id = ARMS.1
    desc = EVTDESC_ARMS_1
    picture = GFX_evt_greenskin_mound
    border = GFX_event_normal_frame_economy
    hide_from = yes
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = {

    }

    option = {
        name = EVTOPTA_MNM_9105
		random_list={
			25={
				trigger={not={has_artifact=club}}
				modifier = { factor = 1.5 culture = orc_savage }
				add_artifact = club
			}
			25={
				trigger={not={has_artifact=dirk}}
				modifier = {
                    factor = 0.5
                    NOR = {
                        trait = creature_goblin
                        trait = creature_hobgoblin
                    }
                }
				add_artifact = dirk
			}
			10={
				trigger={not={has_artifact=greenskin_ax}}
				modifier = { factor = 2 trait = creature_orc }
				add_artifact = greenskin_ax
			}
			10={
				trigger={not={has_artifact=goblin_stabba}}
				modifier = {
                    factor = 2
                    OR = {
                        trait = creature_goblin
                        trait = creature_hobgoblin
                    }
                }
				modifier = {
                    factor = 0.6
                    NOR = {
                        trait = creature_goblin
                        trait = creature_hobgoblin
                    }
                }
				add_artifact = goblin_stabba
			}
			10={
				trigger={not={has_artifact=orc_choppa}}
				modifier = { factor = 2 trait = creature_orc }
				modifier = { factor = 0.6 NOT={trait=creature_orc}}
				add_artifact = orc_choppa
			}
		}
    }
}
#On-action battle_won: Banner Found
character_event = {
	id = ARMS.2
	picture = GFX_evt_battle
	border = GFX_event_normal_frame_war
	desc=EVTDESCARMS2_good_battle_omen

	hide_from = yes

	is_triggered_only = yes


	trigger = {
		NOT = { trait = creature_nehekharan }
        NOT = { culture_group = daemonic_group }
		is_alive = yes
		NOT={any_artifact = { has_artifact_flag = standard }}
	}
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			trait = patient
		}
		modifier = {
			factor = 1.5
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = diligent
		}
		modifier = {
			factor = 0.2
			trait = deceitful
		}
		modifier = {
			factor = 0.2
			trait = arbitrary
		}
		modifier = {
			factor = 2
			has_character_modifier = good_battle_omen
		}
		modifier = {
			factor = 0.9
			has_character_modifier = bad_battle_omen
		}
	}

	option = {
		name = EXCELLENT
		random_list={
		10={add_artifact=rampagers_standard}
		10={add_artifact=rangers_standard}
		10={add_artifact=razor_standard}
		10={add_artifact=wailing_banner}
		10={add_artifact=banner_of_swiftness}
		10={add_artifact=lichebone_pennant}
		10={add_artifact=standard_of_discipline}
		10={add_artifact=banner_of_eternal_flame}
		10={add_artifact=scarecrow_banner}
		10={add_artifact=gleaming_pennant}
		10={trigger={religion_group=chaos_gods_group}
		add_artifact=gleaming_pennant}
		10={trigger={trait=creature_beastman}
		add_artifact=beastmen_artifact_beast_banner}
		}
	}
	after = {
		remove_scrying_omen_modifiers_effect = yes
	}
}
###WEAPON EVENTS###
character_event = {
    id = ARMS.10
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy
    hide_from = yes
    is_triggered_only = yes
    picture = {
		trigger = {
			OR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
		}
		picture = GFX_evt_greenskinhuts
    }
	desc = {
		text = EVTDESC_ARMS_10_GRNSK
		trigger = {
			OR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
		}
	}


	desc = {
		text = EVTDESC_MNM_9115
		trigger = {
			any_courtier_or_vassal = {
				has_job_title = job_marshal
			}
			NOR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
		}
	}
	desc = {
		text = EVTDESC_MNM_9115_b
		trigger = {
			NOT = { any_courtier_or_vassal = {
				has_job_title = job_marshal
			} }
			NOR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
		}
	}

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = { #Selecting gender of the weapon smith
    	hidden_effect = {
    		job_marshal = {
    			save_event_target_as = my_helpful_marshal
    		}
	    	random_list = {
				15 = { #Woman
					modifier = { factor = 2 primary_title = { has_law = status_of_women_2 } }
					modifier = { factor = 2 primary_title = { has_law = status_of_women_3 } }
					modifier = { factor = 2 primary_title = { has_law = status_of_women_4 } }
					modifier = { factor = 6 has_game_rule = { name = gender value = all } }
					modifier = { #Snotling Theiflings
						factor = 0.75
						OR={
						culture_group=orc_group
						culture_group=goblin_group
						}
					}
					create_random_steward  = {
	        			age = 45
		        		random_traits = yes
		        		female = yes
		        		dynasty = none
		        		attributes = {
		        			stewardship = 3
		        		}
		        		historical = yes
		        	}
		        	new_character = {
		        		save_event_target_as = smith
		        		set_character_flag = ai_flag_refuse_marriage
		        		set_character_flag = ai_flag_refuse_concubinage
		        		set_character_flag = cannot_marry
               			set_character_flag = no_court_invites
						will_not_marry_effect = yes
		        	}
				}
				85 = { #Man
		        	create_random_steward  = {
		        		age = 45
		        		random_traits = yes
		        		female = no
		        		dynasty = none
		        		attributes = {
		        			stewardship = 3
		        		}
		        		historical = yes
					}
		        	new_character = {
		        		save_event_target_as = smith
		        		set_character_flag = ai_flag_refuse_marriage
		        		set_character_flag = cannot_marry
               			set_character_flag = no_court_invites
						will_not_marry_effect = yes
					}
				}
			}
			event_target:smith = {
				health = 3
        		ROOT = {
        			trigger_switch = {
	        			on_trigger = has_character_flag
	        			weaponsmith = { PREV = { give_nickname = nick_the_weaponsmith } }
	        			armorsmith = { PREV = { give_nickname = nick_the_armorsmith } }
	        		}
        		}
				if={limit={ROOT={government=greenskin_government}}
        			25 = { culture = goblin_main }
        			25 = { culture = orc_main }
        			25 = { culture = goblin_night }
        			25 = { culture = root }
				}
        		random_list = { #Stewardship
        			15 = { change_stewardship = 1 }
        			25 = { change_stewardship = 3 }
        			20 = {
        				change_stewardship = 5
        				artisan_craftsmen_bloodline_increase_score = yes
        			}
        			10 = {
        				change_stewardship = 7
        				artisan_craftsmen_bloodline_increase_score = yes
        			}
        		}
        		random_list = { #Stewardship
        			15 = { change_stewardship = 1 }
        			25 = { change_stewardship = 3 }
        			20 = {
        				change_stewardship = 5
        				artisan_craftsmen_bloodline_increase_score = yes
        			}
        			10 = {
        				change_stewardship = 7
        				artisan_craftsmen_bloodline_increase_score = yes
        			}
        		}
        		random_list = { #Personality
        			1 = { add_trait = greedy }
        			1 = { add_trait = envious }
        			1 = {
        				add_trait = charitable
        				artisan_craftsmen_bloodline_increase_score = yes
        			}
        			1 = {
        				add_trait = diligent
        				artisan_craftsmen_bloodline_increase_score = yes
        			}
        			1 = { add_trait = deceitful }
        		}
        		random = {
        			chance = 30
        			modifier = {
        				factor = 2
        				trait = indulgent_wastrel
        			}
        			artisan_craftsmen_bloodline_increase_score = yes
        			upgrade_education_effect = yes
        		}
			}
    	}

    	#Province for loc
    	random_province = {
    		limit = { owner = { is_within_diplo_range = ROOT } }
    		save_event_target_as = neighbor_province
    	}
    	random_demesne_province = {
    		limit = { any_neighbor_province = { NOT = { owner = { character = ROOT } } } }
    		random_neighbor_province = {
    			limit = { NOT = { owner = { character = ROOT } } }
    			save_event_target_as = neighbor_province
    		}
    	}
    	#If the player has an armory
    	random_realm_wonder_upgrade = {
			limit = {
				has_wonder_upgrade = upgrade_armory
				is_active = yes
			}
			save_event_target_as = the_armory
			wonder = { save_event_target_as = the_wonder }
		}
    }

    #Yes, invite them!
    option = {
        name = EVTOPTA_MNM_9115
        custom_tooltip = { text = EVTOPTA_MNM_9115_TT }
        event_target:my_helpful_marshal = {
        	show_portrait = yes
        }
        reverse_opinion = {
        	who = event_target:my_helpful_marshal
        	modifier = opinion_was_praised
        }
        hidden_effect = {
        	save_event_target_as = smith_employer
        	event_target:smith = {
        		character_event = { id = ARMS.9116 days = 7 }
        	}
        }
		trigger = {
			any_courtier_or_vassal = {
				has_job_title = job_marshal
			}
			NOR={
			culture_group=orc_group
			culture_group=goblin_group
			}
		}
    }
    #Yes, invite them!
    option = {
        name = EVTOPTA_ARMS_10
        custom_tooltip = { text = EVTOPTA_MNM_9115_TT }
        event_target:my_helpful_marshal = {
        	show_portrait = yes
        }
        reverse_opinion = {
        	who = event_target:my_helpful_marshal
        	modifier = opinion_was_praised
        }
        hidden_effect = {
        	save_event_target_as = smith_employer
        	event_target:smith = {
        		character_event = { id = ARMS.9116 days = 7 }
        	}
        }
		trigger = {
			OR={
			culture_group=orc_group
			culture_group=goblin_group
			}
		}
    }

	option = {
		name = EVTOPTA_MNM_9115_b
		 custom_tooltip = { text = EVTOPTA_MNM_9115_TT }
		  hidden_effect = {
        	save_event_target_as = smith_employer
        	event_target:smith = {
        		character_event = { id = ARMS.9116 days = 7 }
        	}
        }
		trigger = {
			NOT = {
				any_courtier_or_vassal = {
					has_job_title = job_marshal
				}
			}
			NOR={
			culture_group=orc_group
			culture_group=goblin_group
			}
		}
	}

    #Don't invite them
    option = {
        name = EVTOPTB_MNM_9115
       # trigger = {
       # NOT = { event_target:the_armory = { always = yes } }
       # }
        custom_tooltip = { text = EVTOPTB_MNM_9115_TT }
        hidden_effect = {
        	event_target:smith = {
        		leave_court_and_die_effect = yes
        	}
        }

		if = {
			limit = {
				has_character_flag = weaponsmith
				NOR = {
					has_artifact = terrible_sword
					has_character_flag = got_terrible_sword
				}
			}
			character_event = { id = ARMS.9999 days = 7 }
			set_character_flag = got_terrible_sword
		}
		else_if = {
			limit = {
				has_character_flag = armorsmith
				NOR = {
					has_artifact = terrible_armor
					has_character_flag = got_terrible_armor
				}
			}
			character_event = { id = ARMS.9999 days = 7 }
			set_character_flag = got_terrible_armor
		}

		clr_character_flag = weaponsmith
        clr_character_flag = armorsmith

		ai_chance = {
            factor = 0
        }
    }

    #I can do it in my armory, after all!
    option = {
        name = EVTOPTC_MNM_9115
        trigger = {
			always = no
        	#event_target:the_armory = { always = yes }
			#NOR={ #for Now? adjust later?
			#culture_group=orc_group
			#culture_group=goblin_group
			#}
        }
        tooltip_info_custom = EVTOPTC_MNM_9115_TT
        custom_tooltip = { text = EVTOPTB_MNM_9115_TT }
        hidden_effect = {
        	event_target:smith = {
        		leave_court_and_die_effect = yes
        	}

        	#Create the Armory Master Weaponsmith
        	random_list = {
				15 = { #Woman
					modifier = { factor = 2 primary_title = { has_law = status_of_women_2 } }
					modifier = { factor = 2 primary_title = { has_law = status_of_women_3 } }
					modifier = { factor = 2 primary_title = { has_law = status_of_women_4 } }
					modifier = { factor = 6 has_game_rule = { name = gender value = all } }
					create_random_steward  = {
	        			age = 45
		        		random_traits = yes
		        		female = yes
		        		dynasty = none
		        		attributes = {
		        			stewardship = 3
		        		}
		        	}
		        	new_character = {
		        		save_event_target_as = smith
		        		set_character_flag = ai_flag_refuse_concubinage
		        	}
				}
				85 = { #Man
		        	create_random_steward  = {
		        		age = 45
		        		random_traits = yes
		        		female = no
		        		dynasty = none
		        		attributes = {
		        			stewardship = 3
		        		}
					}
		        	new_character = {
		        		save_event_target_as = smith
					}
				}
			}
			event_target:smith = {
				health = 3
				set_character_flag = ai_flag_refuse_marriage
				set_character_flag = cannot_marry
               	set_character_flag = no_court_invites
				will_not_marry_effect = yes

        		ROOT = {
        			trigger_switch = {
	        			on_trigger = has_character_flag
	        			weaponsmith = { PREV = { give_nickname = nick_the_weaponsmith } }
	        			armorsmith = { PREV = { give_nickname = nick_the_armorsmith } }
	        		}
        		}
        	}
        }

        character_event = { id = LT.20201 days = 7 }

		ai_chance = {
            factor = 100
        }
    }
}
#What kind of smith?
character_event = {
	id = ARMS.11
    border = GFX_event_normal_frame_economy
	is_triggered_only = yes

    desc = {
    	trigger = {
			NOR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVT_DESC_MNM_9130
    }
    desc = {
    	trigger = {
			OR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVT_DESC_ARMSA_11
    }
    picture = {
		trigger = {
			OR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
		}
		picture = GFX_evt_orcthrone
    }
    picture = {
		trigger = {
			NOR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
		}
		picture = GFX_evt_treasure_chamber
    }
	trigger = {
		OR = {
			has_dlc = "Mystics"
			has_dlc = "Jade Dragon"
		}
	}

	option = { #Orcish Armoury
		name = EVT_OPTA_ARMS_10
	    trigger = {
	    	job_marshal = { always = yes }
		    have_all_greenskin_artifacts_all_flags_trigger = no
			OR={
				culture_group=orc_group
				culture_group=goblin_group
			}
			wealth=100
	    }
	    custom_tooltip = {
	    	text = employ_a_smith_weapon_search_tt
	    	hidden_effect = {
	    		set_character_flag = weaponsmith
	    		character_event = { id = ARMS.10 days = 50 random = 50 }
	    	}
	   	}
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0.1
                any_artifact = { has_artifact_flag = combat_weapon }
            }
        }
	}
	option = { #Salvaged
		name = EVT_OPTA_ARMS_1
	    trigger = {
	    	job_marshal = { always = yes }
		    have_any_greenskin_salvaged_weapons_all_flags_trigger = no
			OR={
				culture_group=orc_group
				culture_group=goblin_group
			}
	    }
	    custom_tooltip = {
	    	text = employ_a_smith_weapon_search_tt
	    	hidden_effect = {
	    		set_character_flag = weaponsmith
	    		character_event = { id = ARMS.1 days = 30 random = 30 }
	    	}
	   	}
		trigger_switch={
			on_trigger = tier
			EMPEROR={prestige=-500}
			KING={prestige=-300}
			DUKE={prestige=-200}
			COUNT={prestige=-100}
		}
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0
                any_artifact = { has_artifact_flag = combat_weapon }
            }
        }
	}
	option = { #Weapon
		name = EVT_OPTA_MNM_9310
	    trigger = {
	    	job_marshal = { always = yes }
	    	OR = {
		    	have_all_weaponsmith_artifacts_all_flags_trigger = no
			}
			NOR={
				culture_group=orc_group
				culture_group=goblin_group
			}
	    }
	    custom_tooltip = {
	    	text = employ_a_smith_weapon_search_tt
	    	hidden_effect = {
	    		set_character_flag = weaponsmith
	    		character_event = { id =  ARMS.10 days = 50 random = 50 }
	    	}
	   	}
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0
                any_artifact = { has_artifact_flag = combat_weapon }
            }
        }
	}
	option = { #Armorsmith
		name = EVT_OPTB_MNM_9310
	    trigger = {
	    	job_marshal = { always = yes }

			NOR={
				culture_group=orc_group
				culture_group=goblin_group
				culture_group=beastman_group
			}
		    have_all_armorsmith_artifacts_all_flags_trigger = no
	    }
	    custom_tooltip = {
	    	text = employ_a_smith_armor_search_tt
	    	hidden_effect = {
	    		set_character_flag = armorsmith
	    		character_event = { id = ARMS.10 days = 50 random = 50 }
	    	}
	   	}
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0
                any_artifact = { has_artifact_flag = armor_set }
            }
        }
	}
	option = { #Runesmith
		name = EVT_OPTG_DAWI_9310
	    trigger = {
	    	job_treasurer = { always = yes }
			wealth=300
			culture_group=dwarf_group
		    have_all_armorsmith_artifacts_all_flags_trigger = no
	    }
	    custom_tooltip = {
	    	text = employ_a_smith_rune_search_tt
	    	hidden_effect = {
	    		set_character_flag = gromrilsmith
	    		character_event = { id = ARMS.20 days = 25 random = 50 }
	    	}
	   	}
		ai_chance = {
            factor = 2
        }
	}
	option = { #Gold
		name = EVT_OPTC_MNM_9310
		trigger = {
			# Block out this option if character already has all available tiers of jewelry
			OR = {
				have_duplicate_goldsmith_artifacts_flag_okay_trigger = no
				have_duplicate_goldsmith_artifacts_flag_good_trigger = no
				have_duplicate_goldsmith_artifacts_flag_expensive_trigger = no
				have_duplicate_goldsmith_artifacts_flag_amazing_trigger = no
			}
			NOR={
				culture_group=orc_group
				culture_group=goblin_group
				culture_group=beastman_group
				culture_group=lizardman_group
			}
		}
	    custom_tooltip = {
	    	text = employ_a_smith_gold_search_tt
	    	hidden_effect = {
	    		character_event = { id = ARMS.9100 days = 50 random = 50 }
	    	}
	   	}
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0
                any_artifact = { has_artifact_flag = crown_jewel }
            }
        }
	}
	option = {
		name = EVT_OPTD_MNM_9310
		custom_tooltip = {
			text = employ_smith_cd_reset_tt
			hidden_effect = {
				remove_character_modifier = employ_a_smith_cd
			}
		}
		ai_chance = {
            factor = 0
        }
	}
}
#What kind of weapon would you like?
character_event = {
    id =  ARMS.12
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    desc = {
    	trigger = {
			NOR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVTDESC_MNM_9118
    }
    desc = {
    	trigger = {
			OR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVT_DESC_ARMSA_12
    }
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    #Sword
    option = {
        trigger = {
        	NOR = {
			religion_group = ormazd_gods_group
			has_dharmic_religion_trigger = yes
			trait=creature_goblin
			trait=creature_orc
            trait=creature_hobgoblin
			trait=creature_dwarf
			}
			has_character_flag = weaponsmith
        	have_all_weaponsmith_swords_all_flags_trigger = no
        }
        name = EVTOPTA_MNM_9118
        custom_tooltip = { text = EVTOPTA_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_sword } }
        ai_chance = { factor = 2 }
    }

    #Scimitar
    option = {
        trigger = {
        	OR = { religion_group = ormazd_gods_group has_dharmic_religion_trigger = yes } has_character_flag = weaponsmith
        	have_all_weaponsmith_scimitar_all_flags_trigger = no
			NOR={
			trait=creature_goblin
			trait=creature_orc
            trait=creature_hobgoblin
			trait=creature_dwarf
			}
    	}
        name = EVTOPTB_MNM_9118
        custom_tooltip = { text = EVTOPTB_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_scimitar } }
        ai_chance = { factor = 2 }
    }

    #Lance
    option = {
    	trigger = {
    		has_character_flag = weaponsmith
    		have_all_weaponsmith_lance_all_flags_trigger = no
			NOR={
			culture_group=druchi_group
			trait=creature_goblin
			trait=creature_orc
            trait=creature_hobgoblin
			trait=creature_dwarf
			}
    	}
        name = EVTOPTC_MNM_9118
        custom_tooltip = { text = EVTOPTC_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_lance } }
        ai_chance = {
        	factor = 1
        	modifier = { is_nomadic = yes factor = 2 }
        }
    }

    #Axe
    option = {
    	trigger = {
    		has_character_flag = weaponsmith
    		have_all_weaponsmith_axe_all_flags_trigger = no
			NOR={
			trait=creature_goblin
			trait=creature_orc
            trait=creature_hobgoblin
			}
    	}
        name = EVTOPTD_MNM_9118
        custom_tooltip = { text = EVTOPTD_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_axe } }
        ai_chance = {
        	factor = 1
        	modifier = { is_tribal = yes factor = 3 }
        }
    }

    #Mace
    option = {
        trigger = {
        	is_nomadic = no
        	has_character_flag = weaponsmith
        	have_all_weaponsmith_mace_all_flags_trigger = no
			NOR={
			culture_group=druchi_group
			trait=creature_goblin
			trait=creature_orc
            trait=creature_hobgoblin
			}
        }
        name = EVTOPTE_MNM_9118
        custom_tooltip = { text = EVTOPTE_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_mace } }
        ai_chance = {
        	factor = 1
        	modifier = { religion = norse_pagan factor = 5 }
        	modifier = { religion = norse_pagan_reformed factor = 5 }
        }
    }

    #Bow
    option = {
        trigger = {
			OR={
        	is_nomadic = yes
			culture_group=asur_group
			culture_group=asrai_group
			}
        	has_character_flag = weaponsmith
        	have_all_weaponsmith_bow_all_flags_trigger = no
			NOR={
			culture_group=druchi_group
			trait=creature_goblin
			trait=creature_orc
            trait=creature_hobgoblin
			}
        }
        name = EVTOPTF_MNM_9118
        custom_tooltip = { text = EVTOPTF_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_bow } }
        ai_chance = { factor = 5 }
    }
	##Greenskins
    #Choppa
    option = {
        trigger = {
        	has_character_flag = weaponsmith
        	have_all_greenskinweaps_swords_all_flags_trigger = no
			OR={
			trait=creature_goblin
			trait=creature_orc
            trait=creature_hobgoblin
			}
			nor={
				has_artifact=orc_big_choppa
				has_artifact=giant_choppa
				has_artifact=giant_club
			}
        }
        name = EVTOPTA_ARMS_12
        custom_tooltip = { text = EVTOPTE_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_choppa } }
        ai_chance = {
        	factor = 1
        	modifier = { trait = creature_orc factor = 5 }
        	modifier = { trait = creature_goblin factor = 0 }
            modifier = { trait = creature_hobgoblin factor = 0.2 }
			modifier = {
				factor = 1.5
				any_artifact = {
				NOT={has_artifact_flag = combat_weapon }
				}
			}
			modifier = {
				factor = 0
				any_artifact = {
				has_artifact_flag = combat_weapon
				}
			}
        }
    }
    #Ax
    option = {
        trigger = {
        	has_character_flag = weaponsmith
        	have_all_greenskinweaps_swords_all_flags_trigger = no
			trait=creature_orc
			nor={
				has_artifact=greenskin_ax
				has_artifact=giant_ax
			}
        }
        name = EVTOPTB_ARMS_12
        custom_tooltip = { text = EVTOPTE_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_ax } }
        ai_chance = {
        	factor = 1
			modifier = {
				factor = 1.5
				any_artifact = {
				NOT={has_artifact_flag = combat_weapon }
				}
			}
			modifier = {
				factor = 0
				any_artifact = {
				has_artifact_flag = combat_weapon
				}
			}
        }
    }
    #Club
    option = {
        trigger = {
        	has_character_flag = weaponsmith
        	have_all_greenskinweaps_swords_all_flags_trigger = no
			OR={
			trait=creature_goblin
            trait=creature_hobgoblin
			trait=creature_orc
			}
			nor={
				has_artifact=club
				has_artifact=big_club
				has_artifact=giant_club
			}
        }
        name = EVTOPTC_ARMS_12
        custom_tooltip = { text = EVTOPTE_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_club } }
        ai_chance = {
        	factor = 1
        	modifier = { culture = orc_savage factor = 5 }
			modifier = {
				factor = 1.5
				any_artifact = {
				NOT={has_artifact_flag = combat_weapon }
				}
			}
			modifier = {
				factor = 0
				any_artifact = {
				has_artifact_flag = combat_weapon
				}
			}
        }
    }
    #Stabba
    option = {
        trigger = {
        	has_character_flag = weaponsmith
        	have_all_gobweaps_swords_all_flags_trigger = no
            OR = {
                trait=creature_hobgoblin
                trait=creature_goblin
            }
			NOR={
				has_artifact=dirk
				has_artifact=goblin_stabba
				has_artifact=back_stabba_blade
			}
        }
        name = EVTOPTD_ARMS_12
        custom_tooltip = { text = EVTOPTE_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_stabba } }
        ai_chance = {
        	factor = 1
        	modifier = { trait = creature_goblin factor = 5 }
            modifier = { trait = creature_hobgoblin factor = 5 }
			modifier = {
				factor = 1.5
				any_artifact = {
				NOT={has_artifact_flag = combat_weapon }
				}
			}
			modifier = {
				factor = 0
				any_artifact = {
				has_artifact_flag = combat_weapon
				}
			}
        }
    }
    #Armor
    option = {
    	trigger = {
			OR={
			trait=creature_goblin
            trait=creature_hobgoblin
			trait=creature_orc
			}
			NAND={
				or={
					has_artifact=greenskin_ard_armour
					has_artifact=greenskin_ard_armour_2
					has_artifact=greenskin_ard_armour_3
				}
				has_artifact=greenskin_gnashas
			}
		}
        name = EVTOPTE_ARMS_12
        custom_tooltip = { text = EVTOPTG_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = ard_armour } }
        ai_chance = {
        	factor = 1
			modifier = {
			factor = 5
			any_artifact = {
			NOT={has_artifact_flag = armor }
			}
			}
			modifier = {
				factor = 0
				any_artifact = {
				has_artifact_flag = armor
				}
			}
        }
    }

    #Armor
    option = {
    	trigger = { has_character_flag = armorsmith }
        name = EVTOPTG_MNM_9118
        custom_tooltip = { text = EVTOPTG_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = armor_set } }
    }

    after = {
        hidden_effect = { FROM = { character_event = { id = ARMS.9119 days = 7 } } }
    }
}
#Smith steals item and decides who to give it to
character_event = {
	id = ARMS.13
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		OR = {
			has_dlc = "Mystics"
			has_dlc = "Jade Dragon"
		}
	}

	immediate = {
		if = {
			limit = { NOT = { event_target:smith_employer = { is_alive = yes } } }
    		liege = { save_event_target_as = smith_employer }
		}
		trigger_switch = {
			on_trigger = has_character_flag
			expensive_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
					weapon_ax = {
						random_list = {
			        		1 = { add_artifact = giant_ax }
			        		1 = { add_artifact = ze_greenskin_ax }
						}
						new_artifact = { set_artifact_flag = stolen_by_smith }
					}
			        weapon_choppa = {
			        	random_list = {
			        		1 = { add_artifact = giant_choppa }
			        		1 = { add_artifact = ze_orc_choppa }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_club = {
						add_artifact = giant_club
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_stabba = {
			        	random_list = {
			        		1 = { add_artifact = goblin_stabba }
			        		1 = { add_artifact = back_stabba_blade }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        ard_armour = {
			        	random_list = {
			        		1 = { add_artifact = greenskin_ard_armour_2 }
			        		1 = { add_artifact = greenskin_ard_armour_3 }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
				}
			}
			good_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
			        ard_armour = {
			        	random_list = {
			        		2 = { add_artifact = greenskin_gnashas }
			        		1 = { add_artifact = greenskin_ard_armour }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_stabba = { add_artifact = scimitar_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_club = { add_artifact = lance_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_choppa = { add_artifact = axe_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_ax = { add_artifact = giant_ax new_artifact = { set_artifact_flag = stolen_by_smith } }
			    }
			}
			cheap_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
			        ard_armour = { add_artifact = greenskin_gnashas new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_stabba = { add_artifact = dirk new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_club = { add_artifact = lance_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_choppa = { add_artifact = orc_choppa new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_ax = { add_artifact = greenskin_ax new_artifact = { set_artifact_flag = stolen_by_smith } }
			    }
			}
		}
		save_event_target_as = smith_steal_target
		any_artifact = {
			limit = { has_artifact_flag = stolen_by_smith }
			set_original_owner = event_target:smith_employer
			transfer_artifact = {
				to = event_target:smith_steal_target
				from = ROOT
			}
		}
		event_target:smith_employer = { character_event = { id = ARMS.14 } }
		#clear_event_target = smith_employer
		clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = amazing_jewels
		clr_character_flag = expensive_jewels
		clr_character_flag = good_jewels
		clr_character_flag = cheap_jewels
	}
}
#Smith wants to keep the item Duel or no?
character_event = {
	id = ARMS.14
	desc = EVT_DESC_ARMS_13
    picture = GFX_evt_orc_boss
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }
    option = {
    	name = EVT_OPTA_ARMS_13
    	event_target:smith_steal_target = {
    		show_scope_change = no
			add_character_modifier = {
				modifier = recent_duel_timer
				duration = 720
				hidden = yes
			}
			save_event_target_as = combatant_1
			set_character_flag = duel
			set_character_flag = flag_duel_no_draws
			set_character_flag = deadly_duel@event_target:combatant_2
    		any_artifact = {
    			limit = { has_artifact_flag = stolen_by_smith }
    			clr_artifact_flag = stolen_by_smith
    		}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_thief
				years = 10
			}
    	}
    	FROM = {
    		show_scope_change = no
			reverse_opinion = {
				who = ROOT
				modifier = opinion_thief
				years = 10
			}
			hidden_effect = { remove_nickname = yes }
		}
		ROOT = {
			save_event_target_as = combatant_2
			set_character_flag = flag_duel_no_draws
			set_character_flag = duel
			hidden_tooltip = { character_event = { id = HFP.10095 } }
			hidden_tooltip = { character_event = { id = DR_greenskins.212 days = 10 } }
		}
    }

	option = {
    	event_target:smith_steal_target = {
		banish = yes
		}
		name = EVT_OPTB_ARMS_13

	}
}
#Expensive weapon done
character_event = {
    id = ARMS.15
    picture = GFX_evt_greenskinhuts
    border = GFX_event_normal_frame_economy
	desc = EVTDESC_ARMS_15

    is_triggered_only = yes
    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }
    option = {
        name = EVTOPTA_ARMS_15_GREENSKIN_WEAPON
		FROM={
		trigger_switch = {
			on_trigger = has_character_flag
			expensive_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
					weapon_ax = {
						random_list = {
			        		1 = {ROOT={ add_artifact = giant_ax }}
			        		1 = {ROOT={ add_artifact = ze_greenskin_ax }}
						}
						ROOT={set_character_flag = weapon_ax_2}
					}
			        weapon_choppa = {
			        	random_list = {
			        		1 = { ROOT={add_artifact = giant_choppa }      }
			        		1 = {ROOT={ add_artifact = ze_orc_choppa }}
			        	}
						ROOT={set_character_flag = weapon_choppa_2}
			        }
			        weapon_club = {
						ROOT={add_artifact = giant_club}
						ROOT={set_character_flag = weapon_club_2}
			        }
			        weapon_stabba = {
			        	random_list = {
			        		1 = { ROOT={add_artifact = goblin_stabba }}
			        		1 = { ROOT={add_artifact = back_stabba_blade }}
			        	}
						ROOT={set_character_flag = weapon_stabba_2}
			        }
			        ard_armour = {
			        	random_list = {
			        		1 = {
								trigger={
									NOR={
									has_artifact=greenskin_ard_armour
									has_artifact=greenskin_ard_armour_2
									has_artifact=greenskin_ard_armour_3
									}
								}
								ROOT={add_artifact = greenskin_ard_armour_2
								set_character_flag=armour_ard}
							}
			        		1 = {
								trigger={
									NOR={
									has_artifact=greenskin_ard_armour
									has_artifact=greenskin_ard_armour_2
									has_artifact=greenskin_ard_armour_3
									}
								}
								ROOT={add_artifact = greenskin_ard_armour_3
								set_character_flag=armour_ard}
							}
							1 = {
								trigger={
									OR={
									has_artifact=greenskin_ard_armour
									has_artifact=greenskin_ard_armour_2
									has_artifact=greenskin_ard_armour_3
									}
								}
								ROOT={add_artifact = greenskin_gnashas
								set_character_flag=armour_gnashas}
							}
			        	}
						ROOT={set_character_flag = ard_armour_2 }
			        }
				}
			}
			good_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
			        ard_armour = {
			        	random_list = {
			        		1 = {
								trigger={
									OR={
									has_artifact=greenskin_ard_armour
									has_artifact=greenskin_ard_armour_2
									has_artifact=greenskin_ard_armour_3
									}
								}
								ROOT={add_artifact = greenskin_gnashas
								set_character_flag=armour_gnashas}
							}
			        		1 = {
								trigger={
									NOR={
									has_artifact=greenskin_ard_armour
									has_artifact=greenskin_ard_armour_2
									has_artifact=greenskin_ard_armour_3
									}
								}
								ROOT={add_artifact = greenskin_ard_armour
								set_character_flag=armour_ard}
							}
			        	}
			        }
			        weapon_stabba = { add_artifact = scimitar_tier_1_new }
			        weapon_club = { add_artifact = lance_tier_1_new }
			        weapon_choppa = { add_artifact = axe_tier_1_new }
			        weapon_ax = { add_artifact = giant_ax }
			    }
			}
			cheap_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
			        ard_armour = { ROOT={add_artifact = greenskin_gnashas set_character_flag=armour_gnashas}}
			        weapon_stabba = { ROOT={add_artifact = dirk }          }
			        weapon_club = { ROOT={add_artifact = lance_tier_1_new }}
			        weapon_choppa = { ROOT={add_artifact = orc_choppa }}
			        weapon_ax = { ROOT={add_artifact = greenskin_ax }}
			    }
			}
			new_artifact = {
				set_name = artifact_name_greenskin
				set_description = artifact_description_smith_greenskin
			}
		}
		}
    }
    after = {
    	hidden_effect = { FROM = { character_event = { id = ARMS.9127 days = 5 } } }
    	clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
        clr_character_flag = armour_ard
        clr_character_flag = armour_gnashas
        clr_character_flag = weapon_stabba
        clr_character_flag = weapon_ax
        clr_character_flag = weapon_club
        clr_character_flag = weapon_choppa
    }
}
#Asur-Druchii Armour Choice
character_event = {
	id = ARMS.16
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy
    desc = {
    	trigger = {
			culture_group=druchi_group
    	}
    	text = EVTDESC_ARMS_16A
    }
    desc = {
    	trigger = {
			culture_group=asur_group
			NOT={culture=nagarythi}
    	}
    	text = EVTDESC_ARMS_16B
    }
    desc = {
    	trigger = {
			culture=nagarythi
    	}
    	text = EVTDESC_ARMS_16C
    }

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    	event_target:smith = { is_alive = yes }
    }
    #druchii_meteorite_armour
    option = {
        name = EVTOPTA_ARMS_16
        trigger = {
        	event_target:smith={has_character_flag = armor_set}
			culture_group=druchi_group
			nor={
				has_artifact=druchii_meteorite_armour
				has_artifact=druchii_sea_dragon_cloak
			}
			wealth = 625
        }
        custom_tooltip = { text = EVTOPTA_DRUCHII_ARMS_16_A }

		scaled_wealth = { value = -4.5 min = -625 max = -2000 }
        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_weapons }
        	set_character_flag = expensive_weapons
			random_list = {
				55 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				45 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
			event_target:smith={set_character_flag = druchii_meteorite_armour_flag }
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 400
    				yearly_income = 40
    			}
    			factor = 0
    		}
    	}
    }
    #druchii_sea_dragon_cloak
    option = {
        name = EVTOPTB_ARMS_16
        trigger = {
        	event_target:smith={has_character_flag = armor_set}
			culture_group=druchi_group
			nor={
				has_artifact=druchii_meteorite_armour
				has_artifact=druchii_sea_dragon_cloak
			}
			wealth = 400
        }
		scaled_wealth = { value = -3.5 min = -400 max = -2000 }
        custom_tooltip = { text = EVTOPTA_DRUCHII_ARMS_16_B }
        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_weapons }
        	set_character_flag = expensive_weapons
			random_list = {
				55 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				45 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
			event_target:smith={set_character_flag = druchii_sea_dragon_cloak_flag }
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 400
    				yearly_income = 40
    			}
    			factor = 0
    		}
    	}
    }
	#asur_artifact_dragon_armour
    option = {
        name = EVTOPTC_ARMS_16
        trigger = {
        	event_target:smith={has_character_flag = armor_set}
			culture_group=asur_group
			nor={
				has_artifact=asur_artifact_dragon_armour
				has_artifact=asur_artifact_ithilmar_armour
				has_artifact=asur_artifact_shadow_armour
			}
			OR={
				AND={
				wealth=550
				culture=caledori
				}
				AND={
				wealth=750
				NOT={culture=caledori}
				}
			}
        }
		if={limit={culture=caledori}
		scaled_wealth = { value = -4.5 min = -550 max = -2000 }

		}
		else={
			scaled_wealth = { value = -6.5 min = -750 max = -2000 }
		}
        custom_tooltip = { text = EVTOPTA_ASUR_ARMS_16_A }
        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_weapons }
        	set_character_flag = expensive_weapons
			random_list = {
				55 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				45 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
			event_target:smith={set_character_flag = asur_artifact_dragon_armour_flag }
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 400
    				yearly_income = 40
    			}
    			factor = 0
    		}
    	}
    }
	#asur_artifact_ithilmar_armour
    option = {
        name = EVTOPTD_ARMS_16
        trigger = {
        	event_target:smith={has_character_flag = armor_set}
			culture_group=asur_group
			nor={
				has_artifact=asur_artifact_dragon_armour
				has_artifact=asur_artifact_ithilmar_armour
				has_artifact=asur_artifact_shadow_armour
			}
			wealth=450
        }
		scaled_wealth = { value = -4.2 min = -450 max = -2000 }
        custom_tooltip = { text = EVTOPTA_ASUR_ARMS_16_B }
        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_weapons }
        	set_character_flag = expensive_weapons
			random_list = {
				55 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				45 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
			event_target:smith={set_character_flag = asur_artifact_ithilmar_armour_flag }
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 400
    				yearly_income = 40
    			}
    			factor = 0
    		}
    	}
    }
	#asur_artifact_shadow_armour
    option = {
        name = EVTOPTE_ARMS_16
        trigger = {
        	event_target:smith={has_character_flag = armor_set}
			culture=nagarythi
			not={
				has_artifact=asur_artifact_shadow_armour
			}
			wealth=600
        }
		scaled_wealth = { value = -4.8 min = -600 max = -2000 }
        custom_tooltip = { text = EVTOPTA_ASUR_ARMS_16_C }
        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_weapons }
        	set_character_flag = expensive_weapons
			random_list = {
				55 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				45 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
			event_target:smith={set_character_flag = asur_artifact_shadow_armour_flag }
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 400
    				yearly_income = 40
    			}
    			factor = 0
    		}
    	}
    }
    #Actually, no
    option = {
        name = EVTOPTD_MNM_9120
        custom_tooltip = { text = EVTOPTD_MNM_9120_TT }
        clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
        hidden_effect = { event_target:smith={ character_event = { id = ARMS.9110 days = 5 } } }
    }
}
#20-30 Gromril & Runesmithing
#Summon Smith
character_event = {
    id = ARMS.20
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    desc = {
    	trigger = {
			NOR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVT_DESC_ARMSA_20
    }
    desc = {
    	trigger = {
			OR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVT_DESC_ARMSB_20
    }
    immediate = { #Selecting gender of the weapon smith
    	hidden_effect = {
    		job_treasurer = {
    			save_event_target_as = my_helpful_marshal
    		}
			if = { #Best case... (Your Own Courtier Runesmith)
				limit = {
					any_courtier = {
						OR={
						trait=creature_dwarf
						trait=creature_chaos_dwarf
						}
						OR={
						trait=runelord
						trait=runesmith
						}
						is_inaccessible_or_incapable_trigger = no
						is_adult = yes
						is_within_diplo_range = ROOT
					}
				}
				any_courtier = {
					limit = {
						OR={
						trait=creature_dwarf
						trait=creature_chaos_dwarf
						}
						OR={
						trait=runelord
						trait=runesmith
						}
						is_inaccessible_or_incapable_trigger = no
						is_adult = yes
						is_within_diplo_range = ROOT
					}
					save_event_target_as = smith
					set_character_flag = preparing_crafting
					break = yes
				}
			}
			if = { #Member of Society of Runesmiths
				limit = {
					any_realm_lord = {
						OR={
						trait=creature_dwarf
						trait=creature_chaos_dwarf
						}
						OR={
						trait=runelord
						trait=runesmith
						}
						society_member_of = runesmiths_society
						is_inaccessible_or_incapable_trigger = no
						is_adult = yes
						is_within_diplo_range = ROOT
					}
				}
				any_realm_lord = {
					limit = {
						OR={
						trait=creature_dwarf
						trait=creature_chaos_dwarf
						}
						OR={
						trait=runelord
						trait=runesmith
						}
						society_member_of = runesmiths_society
						is_inaccessible_or_incapable_trigger = no
						is_adult = yes
						is_within_diplo_range = ROOT
					}
					save_event_target_as = smith
					set_character_flag = preparing_crafting
					break = yes
				}
			}
			if = { #Member of Society of Runesmiths
				limit = {
					runesmiths_society = {
						any_society_member={
							OR={
							trait=creature_dwarf
							trait=creature_chaos_dwarf
							}
							OR={
							trait=runelord
							trait=runesmith
							}
							society_member_of = runesmiths_society
							is_inaccessible_or_incapable_trigger = no
							is_adult = yes
							is_within_diplo_range = ROOT
							NOT={has_character_flag=preparing_crafting}
						}
					}
				}
				runesmiths_society = {
					any_society_member={
						limit = {
							OR={
							trait=creature_dwarf
							trait=creature_chaos_dwarf
							}
							OR={
							trait=runelord
							trait=runesmith
							}
							society_member_of = runesmiths_society
							is_inaccessible_or_incapable_trigger = no
							is_adult = yes
							is_within_diplo_range = ROOT
							NOT={has_character_flag=preparing_crafting}
						}
						save_event_target_as = smith
						set_character_flag = preparing_crafting
						break = yes
					}
				}
			}
    	}
    }
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

	option = {
		name = EVTOPTA_ARMS_20
		custom_tooltip = { text = EVTOPTA_MNM_9115_TT }
        save_event_target_as = smith_employer
		event_target:smith = {
			show_portrait = yes
			character_event = { id = ARMS.9116 days = 7 }
		}
	}

    #Don't invite them
    option = {
        name = EVTOPTB_MNM_9115
        custom_tooltip = { text = EVTOPTB_MNM_9115_TT }
        clr_character_flag = gromrilsmith

		ai_chance = {
            factor = 0
        }
		event_target:smith={clr_character_flag = preparing_crafting}
    }

    #I can do it my self!
    option = {
        save_event_target_as = smith_employer
        name = EVTOPTC_ARMS_20
        trigger = {
			OR={
				trait=runelord
				trait=runesmith
			}
        }
        tooltip_info_custom = EVTOPTC_MNM_9115_TT
        custom_tooltip = { text = EVTOPTB_MNM_9115_TT }

		ai_chance = {
            factor = 100
        }
		event_target:smith={clr_character_flag = preparing_crafting}
		save_event_target_as = smith
		set_character_flag = preparing_crafting
		character_event={ id=ARMS.21 }
    }
}
#What Do you want be created from Gromril?
character_event = {
    id = ARMS.21
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    desc = {
    	trigger = {
			NOR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVT_DESC_ARMSA_21
    }
    desc = {
    	trigger = {
			OR={
				trait=creature_orc
				trait=creature_goblin
                trait=creature_hobgoblin
			}
    	}
    	text = EVT_DESC_ARMSB_21
    }
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    #Axe
    option = {
    	trigger = {
    		have_all_weaponsmith_axe_all_flags_trigger = no
    	}
        name = EVTOPTA_ARMS_21
        custom_tooltip = { text = EVTOPTD_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_axe } }
        ai_chance = {
        	factor = 1
        	modifier = { is_tribal = yes factor = 3 }
        }
		IF={limit={tier=king}
			scaled_wealth = { value = -3.5 min = -680 max = -2000 }
		}
		IF={limit={tier=emperor}
			scaled_wealth = { value = -4.5 min = -740 max = -2000 }
		}
		IF={
			limit={
				OR={
					tier=duke
					tier=count
				}
			}
			prestige=-300
			scaled_wealth = { value = -2.5 min = -550 max = -1800 }
		}
		IF={
			limit={
				FROM={
					character = root
				}
			}
			scaled_wealth = { value = 1.5 min = 250 max = 800 }
		}
        hidden_effect = {
			random_list = {
				15 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
					set_character_flag=smith_success
					event_target:smith = { set_character_flag = amazing_weapons }
					set_character_flag = amazing_weapons
					character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
				}
				85 = { #Tries to take them with him
					event_target:smith = { set_character_flag = expensive_weapons }
					set_character_flag = expensive_weapons
					set_character_flag=smith_success
					character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
				}
			}
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        }
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0.1
                any_artifact = { has_artifact_flag = combat_weapon }
            }
        }
    }
    #Mace
    option = {
        trigger = {
        	is_nomadic = no
        	have_all_weaponsmith_mace_all_flags_trigger = no
        }
        name = EVTOPTB_ARMS_21
        custom_tooltip = { text = EVTOPTE_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = weapon_mace } }
        ai_chance = {
        	factor = 1
        	modifier = { religion = norse_pagan factor = 5 }
        	modifier = { religion = norse_pagan_reformed factor = 5 }
        }
		IF={limit={tier=king}
			scaled_wealth = { value = -3.5 min = -680 max = -2000 }
		}
		IF={limit={tier=emperor}
			scaled_wealth = { value = -4.5 min = -740 max = -2000 }
		}
		IF={
			limit={
				OR={
					tier=duke
					tier=count
				}
			}
			prestige=-300
			scaled_wealth = { value = -2.5 min = -550 max = -1800 }
		}
		IF={
			limit={
				FROM={
					character = root
				}
			}
			scaled_wealth = { value = 1.5 min = 250 max = 800 }
		}
        hidden_effect = {
			random_list = {
				15 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
					set_character_flag=smith_success
					event_target:smith = { set_character_flag = amazing_weapons }
					set_character_flag = amazing_weapons
					character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
				}
				85 = { #Tries to take them with him
					event_target:smith = { set_character_flag = expensive_weapons }
					set_character_flag = expensive_weapons
					set_character_flag=smith_success
					character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
				}
			}
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        }
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0.1
                any_artifact = { has_artifact_flag = combat_weapon }
            }
        }
    }
    #Armor
    option = {
        name = EVTOPTC_ARMS_21
        custom_tooltip = { text = EVTOPTG_MNM_9118_TT }
        hidden_tooltip = { FROM = { set_character_flag = armor_set } }
		IF={limit={tier=king}
			scaled_wealth = { value = -3.8 min = -980 max = -2500 }
		}
		IF={limit={tier=emperor}
			scaled_wealth = { value = -4.9 min = -1120 max = -2500 }
		}
		IF={
			limit={
				OR={
					tier=duke
					tier=count
				}
			}
			prestige=-300
			scaled_wealth = { value = -2.9 min = -800 max = -2400 }
		}
		IF={
			limit={
				FROM={
					character = root
				}
			}
			scaled_wealth = { value = 1.5 min = 250 max = 800 }
		}
        hidden_effect = {
			random_list = {
				15 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
					set_character_flag=smith_success
					event_target:smith = { set_character_flag = amazing_weapons }
					set_character_flag = amazing_weapons
					character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
				}
				85 = { #Tries to take them with him
					event_target:smith = { set_character_flag = expensive_weapons }
					set_character_flag = expensive_weapons
					set_character_flag=smith_success
					character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
				}
			}
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        }
		ai_chance = {
            factor = 10
            modifier = {
                factor = 0.1
                any_artifact = { has_artifact_flag = armor }
            }
        }
    }

    #Rune
    option = {
        name = EVTOPTD_ARMS_21
        custom_tooltip = { text = EVTOPTG_MNM_9118_TT }
        hidden_tooltip = { set_character_flag = runecraft }
		character_event={ id = ARMS.9119 days = 25 }
		IF={limit={tier=king}
			scaled_wealth = { value = -2.5 min = -320 max = -2000 }
		}
		IF={limit={tier=emperor}
			scaled_wealth = { value = -2.5 min = -380 max = -2000 }
		}
		IF={
			limit={
				OR={
					tier=duke
					tier=count
				}
			}
			prestige=-300
			scaled_wealth = { value = -1.5 min = -250 max = -1800 }
		}
		IF={
			limit={
				FROM={
					character = root
				}
			}
			scaled_wealth = { value = 1.5 min = 126 max = 400 }
		}
		ai_chance = {
            factor = 5
        }
    }
}
###What Kind of a Rune
character_event = {
	id = ARMS.24
	title = RUNECRAFT
	desc = EVTDESC_ARMS_24 # You have decided you are in need of an Rune to enhance your capabilities

	is_triggered_only = yes

	option = {
		 name = EVTOPTA_ARMS_RUNES # The world is ever changing, and everyone conspires against you, Tzeentch offers assistance against the growing tide.
		 hidden_effect={
			random_list={
				10={
					modifier = { factor = 0.7 FROM = { learning <= 2 } }
					modifier = { factor = 0.7 FROM = { learning <= 4 } }
					modifier = { factor = 0.7 FROM = { learning <= 6 } }
					modifier = { factor = 0.7 FROM = { learning <= 8 } }
					modifier = { factor = 0.7 FROM = { learning <= 10 } }
					modifier = { factor = 1.1 FROM = { learning >= 10 } }
					modifier = { factor = 1.1 FROM = { learning >= 12 } }
					modifier = { factor = 1.1 FROM = { learning >= 14 } }
					modifier = { factor = 1.1 FROM = { learning >= 16 } }
					modifier = { factor = 1.1 FROM = { learning >= 18 } }
					modifier = { factor = 1.1 FROM = { learning >= 20 } }
					set_character_flag=good_weapons
				}
				70={
					set_character_flag=cheap_weapons
				}
			}
		}
		set_character_flag=malice_rune
		character_event = { id = ARMS.26 days=38 }
	}
	option = {
		 name = EVTOPTB_ARMS_RUNES # The world is ever changing, and everyone conspires against you, Tzeentch offers assistance against the growing tide.
		 hidden_effect={
			random_list={
				10={
					modifier = { factor = 0.7 FROM = { learning <= 2 } }
					modifier = { factor = 0.7 FROM = { learning <= 4 } }
					modifier = { factor = 0.7 FROM = { learning <= 6 } }
					modifier = { factor = 0.7 FROM = { learning <= 8 } }
					modifier = { factor = 0.7 FROM = { learning <= 10 } }
					modifier = { factor = 1.1 FROM = { learning >= 10 } }
					modifier = { factor = 1.1 FROM = { learning >= 12 } }
					modifier = { factor = 1.1 FROM = { learning >= 14 } }
					modifier = { factor = 1.1 FROM = { learning >= 16 } }
					modifier = { factor = 1.1 FROM = { learning >= 18 } }
					modifier = { factor = 1.1 FROM = { learning >= 20 } }
					set_character_flag=good_weapons
				}
				70={
					set_character_flag=cheap_weapons
				}
			}
		}
		set_character_flag=honor_rune
		character_event = { id = ARMS.26 days=38 }
	}

	option = {
		 name = EVTOPTC_ARMS_RUNES # The world is ever changing, and everyone conspires against you, Tzeentch offers assistance against the growing tide.
		 hidden_effect={
			random_list={
				10={
					modifier = { factor = 0.7 FROM = { learning <= 2 } }
					modifier = { factor = 0.7 FROM = { learning <= 4 } }
					modifier = { factor = 0.7 FROM = { learning <= 6 } }
					modifier = { factor = 0.7 FROM = { learning <= 8 } }
					modifier = { factor = 0.7 FROM = { learning <= 10 } }
					modifier = { factor = 1.1 FROM = { learning >= 10 } }
					modifier = { factor = 1.1 FROM = { learning >= 12 } }
					modifier = { factor = 1.1 FROM = { learning >= 14 } }
					modifier = { factor = 1.1 FROM = { learning >= 16 } }
					modifier = { factor = 1.1 FROM = { learning >= 18 } }
					modifier = { factor = 1.1 FROM = { learning >= 20 } }
					set_character_flag=good_weapons
				}
				70={
					set_character_flag=cheap_weapons
				}
			}
		set_character_flag=might_rune
		}
		character_event = { id = ARMS.26 days=38 }
	}
}
#Runesmith finishes work
character_event = {
	id = ARMS.26
	is_triggered_only = yes
	desc = EVT_DESC_ARMSA_26
	title = RUNECRAFT
	trigger = {
		OR = {
			has_dlc = "Mystics"
			has_dlc = "Jade Dragon"
		}
	}
    option = {
        name = EVTOPTA_ARMS_26
		trigger_switch = {
			on_trigger = has_character_flag
			cheap_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
					honor_rune = {
						random_list={
						10={ trigger={NOT={has_artifact=rune_of_stoicism}}
						add_artifact=rune_of_stoicism}
						10={ trigger={NOT={has_artifact=rune_of_steel}}
						add_artifact=rune_of_steel}
						}
					}
					might_rune = {
						random_list={
						10={ trigger={NOT={has_artifact=rune_of_courage}}
						add_artifact=rune_of_courage}
						10={ trigger={NOT={has_artifact=rune_of_shielding}}
						add_artifact=rune_of_shielding}
						}
					}
					malice_rune = {
						random_list={
						10={ trigger={NOT={has_artifact=rune_of_fury}}
						add_artifact=rune_of_fury}
						10={ trigger={NOT={has_artifact=rune_of_dismay}}
						add_artifact=rune_of_dismay}
						10={ trigger={NOT={has_artifact=rune_of_swiftness}}
						add_artifact=rune_of_swiftness}
						}
					}
				}
			}
			good_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
					honor_rune = {
						random_list={
						10={ trigger={NOT={has_artifact=master_rune_of_stoicism}}
						add_artifact=master_rune_of_stoicism}
						10={ trigger={NOT={has_artifact=master_rune_of_steel}}
						add_artifact=master_rune_of_steel}
						}
					}
					might_rune = {
						random_list={
						10={ trigger={NOT={has_artifact=master_rune_of_courage}}
						add_artifact=master_rune_of_courage}
						10={ trigger={NOT={has_artifact=master_rune_of_shielding}}
						add_artifact=master_rune_of_shielding}
						}
					}
					malice_rune = {
						random_list={
						10={ trigger={NOT={has_artifact=master_rune_of_fury}}
						add_artifact=master_rune_of_fury}
						10={ trigger={NOT={has_artifact=master_rune_of_fear}}
						add_artifact=master_rune_of_fear}
						10={ trigger={NOT={has_artifact=master_rune_of_swiftness}}
						add_artifact=master_rune_of_swiftness}
						}
					}
				}
			}
		}
	}
	after={
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = gromrilsmith
		clr_character_flag = runecraft
		fromfrom={clr_character_flag = preparing_crafting}
	}
}
character_event = {
	id = ARMS.27
	title = RUNECRAFT
	desc = EVTDESC_ARMS_27 # You have decided you are in need of an Rune to enhance your capabilities

	is_triggered_only = yes

	option = {
		name = EVTOPTA_ARMS_RUNESB #
		trigger={
			OR={
			trait=school_of_thungi
			trait=school_of_grungi
			trait=school_of_valaya
			}
			NOT={has_artifact=master_rune_of_valaya}
		}
		add_artifact=master_rune_of_valaya
        ai_chance = {
        	factor = 1
		}
	}
	option = {
		name = EVTOPTB_ARMS_RUNESB #
		trigger={
			OR={
			trait=school_of_thungi
			trait=school_of_grimnir
			}
			NOT={has_artifact=master_rune_of_grimnir}
		}
		add_artifact=master_rune_of_grimnir
        ai_chance = {
        	factor = 1
		}
	}

	option = {
		name = EVTOPTC_ARMS_RUNESB #
		trigger={
			OR={
			trait=school_of_thungi
			trait=school_of_grungi
			trait=school_of_valaya
			}
		}
		add_artifact=master_rune_of_grungi
        ai_chance = {
        	factor = 1
		}
	}
	option = {
		name = EVTOPTD_ARMS_RUNESB #
		trigger={
			OR={
			trait=school_of_thungi
			trait=school_of_grungi
			trait=school_of_valaya
			}
			NOT={has_artifact=master_rune_of_thungi}
		}
		add_artifact=master_rune_of_thungi
        ai_chance = {
        	factor = 1
		}
	}
	option = {
		name = EVTOPTE_ARMS_RUNESB #
		trigger={
			OR={
			trait=school_of_grimnir
			trait=school_of_grungi
			}
			NOT={has_artifact=master_rune_of_morgrim}
		}
		add_artifact=master_rune_of_morgrim
        ai_chance = {
        	factor = 1
		}
	}
	after={clr_character_flag=choosing_warrior_training}
}
###Crown jewels events###
character_event = {
    id = ARMS.9100
    desc = EVTDESC_MNM_9100
    picture = GFX_evt_treasure_chamber
    border = GFX_event_normal_frame_economy

    hide_from = yes
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = { #Selecting gender of the goldsmith
    	hidden_effect = {
			random_list = {
				15 = { #Woman
					modifier = { factor = 2 primary_title = { has_law = status_of_women_2 } }
					modifier = { factor = 2 primary_title = { has_law = status_of_women_3 } }
					modifier = { factor = 2 primary_title = { has_law = status_of_women_4 } }
					modifier = { factor = 6 has_game_rule = { name = gender value = all } }
					create_random_steward  = {
	        			age = 45
		        		random_traits = yes
		        		female = yes
		        		dynasty = none
		        		attributes = {
		        			stewardship = 3
		        		}
		        		historical = yes
		        	}
		        	new_character = {
		        		save_event_target_as = smith
		        		set_character_flag = ai_flag_refuse_marriage
		        		set_character_flag = ai_flag_refuse_concubinage
		        		set_character_flag = cannot_marry
               			set_character_flag = no_court_invites
						will_not_marry_effect = yes
		        	}
				}
				85 = { #Man
		        	create_random_steward  = {
		        		age = 45
		        		random_traits = yes
		        		female = no
		        		dynasty = none
		        		attributes = {
		        			stewardship = 3
		        		}
		        		historical = yes
					}
		        	new_character = {
		        		save_event_target_as = smith
		        		set_character_flag = ai_flag_refuse_marriage
		        		set_character_flag = cannot_marry
               			set_character_flag = no_court_invites
						will_not_marry_effect = yes
					}
				}
			}
			event_target:smith = {
				health = 3
        		give_nickname = nick_the_goldsmith
        		random_list = { #Stewardship
        			15 = { change_stewardship = 1 }
        			25 = { change_stewardship = 3 }
        			20 = {
        				artisan_craftsmen_bloodline_increase_score = yes
        				change_stewardship = 5
        			}
        			10 = {
        				artisan_craftsmen_bloodline_increase_score = yes
        				change_stewardship = 7
        			}
        		}
        		random_list = { #Personality
        			1 = { add_trait = greedy }
        			1 = { add_trait = envious }
        			1 = {
        				artisan_craftsmen_bloodline_increase_score = yes
        				add_trait = charitable
        			}
        			1 = {
        				artisan_craftsmen_bloodline_increase_score = yes
        				add_trait = diligent
        			}
        			1 = { add_trait = deceitful }
        		}
        		random = {
        			chance = 30
        			modifier = {
        				factor = 2
        				trait = indulgent_wastrel
        			}
        			artisan_craftsmen_bloodline_increase_score = yes
        			upgrade_education_effect = yes
        		}
			}
		}
    }

    #Yes, invite them!
    option = {
        name = EVTOPTA_MNM_9100
        custom_tooltip = { text = EVTOPTA_MNM_9100_TT }
        #custom_tooltip = { text = employ_a_smith_stewardship_tt }
        hidden_effect = {
        	save_event_target_as = smith_employer
        	event_target:smith = {
        		character_event = { id = ARMS.9101 }
        	}
        }
    }

    #Don't invite them
    option = {
        name = EVTOPTB_MNM_9100
        custom_tooltip = { text = EVTOPTB_MNM_9100_TT }
        hidden_effect = {
        	event_target:smith = {
        		leave_court_and_die_effect = yes
        	}
        }
    }
}

#Ping event for goldsmith
character_event = {
    id = ARMS.9101
    hide_window = yes
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

	immediate = {
		event_target:smith_employer = { character_event = { id = ARMS.9103 } }
	}
}

#How much will I spend on the crown jewels?
character_event = {
    id = ARMS.9103
    desc = EVTDESC_MNM_9103
    picture = GFX_evt_emissary
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    #The best money can buy
    option = {
        name = EVTOPTA_MNM_9103
        trigger = {
        	tier = EMPEROR
        }
        custom_tooltip = { text = EVTOPTA_MNM_9103_TT }

        scaled_wealth = { value = -3.5 min = -300 max = -2000 }

        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_jewels }
        	set_character_flag = expensive_jewels
			random_list = {
				40 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			set_character_flag = goldsmith_success
				}
				60 = { #Fail
        			set_character_flag = goldsmith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = goldsmith_steal
				}
	    	}
        	character_event = { id = ARMS.9111 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
			}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NOR = {
    				wealth = 200
    				yearly_income = 50
    			}
    			factor = 0
    		}
    	}
    }

    #Something nice
    option = {
        name = {
        	trigger = {
        		tier = EMPEROR
        	}
        	text = EVTOPTB_MNM_9103
        }
        name = {
        	trigger = {
        		tier = KING
        	}
        	text = EVTOPTB_MNM_9103_KING
        }

        trigger = {
        	higher_tier_than = DUKE
        }
        if = {
        	limit = {
        		tier = EMPEROR
        	}
        	custom_tooltip = { text = EVTOPTB_MNM_9103_TT }
        }
        else_if = {
        	limit = {
        		tier = KING
        	}
        	custom_tooltip = { text = EVTOPTB_MNM_9103_TT_KING }
        }

        scaled_wealth = { value = -2 min = -150 max = -500 }

        hidden_effect = {
        	event_target:smith = { set_character_flag = good_jewels }
        	set_character_flag = good_jewels
        	random_list = {
				60 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			set_character_flag = goldsmith_success
				}
				40 = { #Fail
        			set_character_flag = goldsmith_fail
				}
				10 = { #Steal
				  	modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = goldsmith_steal
				}
			}
        	character_event = { id = ARMS.9111 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
		ai_chance = {
    		factor = 33
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
				}
    			factor = 10
    		}
    		modifier = {
    			lower_tier_than = DUKE
    			factor = 3
    		}
    		modifier = {
    			tier = EMPEROR
    			factor = 3
    		}
    		modifier = {
    			NOR = {
    				wealth = 150
    				yearly_income = 25
    			}
    			factor = 0
    		}
    	}
    }

   	#I can't afford that much
    option = {
        name = {
        	trigger = {
        		tier = EMPEROR
        	}
			text = EVTOPTC_MNM_9103
		}
		name = {
			trigger = {
				tier = KING
			}
			text = EVTOPTC_MNM_9103_KING
		}
		name = {
			trigger = {
				NAND = {
					tier = EMPEROR
					tier = KING
				}
			}
			text = EVTOPTC_MNM_9103_GENERIC
        }

        if = {
        	limit = {
        		tier = EMPEROR
        	}
        	custom_tooltip = { text = EVTOPTC_MNM_9103_TT }
        }
        else_if = {
        	limit = {
        		tier = KING
        	}
        	custom_tooltip = { text = EVTOPTC_MNM_9103_TT_KING }
        }
        else = {
        	custom_tooltip = { text = EVTOPTC_MNM_9103_TT_GENERIC }
        }

        scaled_wealth = { value = -1 min = -50 max = -100 }

        hidden_effect = {
        	event_target:smith = { set_character_flag = cheap_jewels }
        	set_character_flag = cheap_jewels
        	random_list = {
				100 = { #Success
        			set_character_flag = goldsmith_success
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = goldsmith_steal
				}
			}
        	character_event = { id = ARMS.9111 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }

        ai_chance = {
    		factor = 33
    		modifier = {
    			tier = COUNT
    			factor = 10
				}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
				}
    			factor = 3
			}
    		modifier = {
    			NOR = {
    				wealth = 25
    				yearly_income = 5
    				religion_group = pagan_group
				}
    			factor = 0
			}
    	}
    }

    #Actually, no
    option = {
        name = EVTOPTD_MNM_9103
        custom_tooltip = { text = EVTOPTD_MNM_9103_TT }

        hidden_effect = { FROM = { character_event = { id = ARMS.9110 days = 5 } } }

       	ai_chance = { factor = 15 }
    }
}

#Ping event for success
character_event = {
	id = ARMS.9104
    hide_window = yes

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = {
    	if = {
    		limit = { NOT = { event_target:smith_employer = { is_alive = yes } } }
    		liege = { save_event_target_as = smith_employer }
    	}

    	trigger_switch = {
    		on_trigger = has_character_flag
    		amazing_jewels		= { event_target:smith_employer = { character_event = { id = ARMS.40001 } } }
    		expensive_jewels	= { event_target:smith_employer = { character_event = { id = ARMS.9105 } } }
    		good_jewels			= { event_target:smith_employer = { character_event = { id = ARMS.9106 } } }
    		cheap_jewels		= { event_target:smith_employer = { character_event = { id = ARMS.9107 } } }
		}
    }
}
#Amazing Crown Jewels
character_event = {
    id = ARMS.40001
    desc = EVTDESC_MNM_40001
    picture = GFX_evt_treasure_chamber
    border = GFX_event_normal_frame_economy
    is_triggered_only = yes
    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = {

    }

    option = {
        name = EVTOPTA_MNM_9105
        if = {
        	limit = { have_duplicate_goldsmith_artifacts_flag_amazing_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_goldsmith_artifacts_flag_amazing_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }

        hidden_effect = {
        	event_target:smith = { character_event = { id = ARMS.9110 days = 5 } }
        	clr_character_flag = amazing_jewels
        	clr_character_flag = expensive_jewels
			clr_character_flag = good_jewels
			clr_character_flag = cheap_jewels
        }
    }
}
#Expensive crown jewels
character_event = {
    id = ARMS.9105
    picture = GFX_evt_treasure_chamber
    border = GFX_event_normal_frame_economy

    desc = {
    	trigger = { religion_group = christian }
    	text = EVTDESC_MNM_9105
    	picture = GFX_evt_holy_emperor
    }
    desc = {
    	trigger = { NOT = { religion_group = christian } }
    	text = EVTDESC_MNM_9105
    	picture = GFX_evt_treasure_chamber
    }

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
        name = EVTOPTA_MNM_9105
        if = {
        	limit = { have_duplicate_goldsmith_artifacts_flag_expensive_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_goldsmith_artifacts_flag_expensive_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }

        hidden_effect = {
        	event_target:smith = { character_event = { id = ARMS.9110 days = 5 } }
        	clr_character_flag = expensive_jewels
			clr_character_flag = good_jewels
			clr_character_flag = cheap_jewels
        }
    }
}

#Good crown jewels
character_event = {
    id = ARMS.9106
    picture = GFX_evt_treasure_chamber
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    desc = {
    	trigger = { religion_group = christian }
    	text = EVTDESC_MNM_9106
    	picture = GFX_evt_holy_emperor
    }
    desc = {
    	trigger = { NOT = { religion_group = christian } }
    	text = EVTDESC_MNM_9106
    	picture = GFX_evt_treasure_chamber
    }

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
        name = EVTOPTA_MNM_9106

        if = {
        	limit = { have_duplicate_goldsmith_artifacts_flag_good_trigger = no }
        	# If player doesn't already have all items in the given set, then give items
	        give_goldsmith_artifacts_flag_good_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 1.8 min = 100 max = 500 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }

        hidden_effect = {
        	event_target:smith = { character_event = { id = ARMS.9110 days = 5 } }
        	clr_character_flag = expensive_jewels
			clr_character_flag = good_jewels
			clr_character_flag = cheap_jewels
        }
    }
}

#Okay crown jewels
character_event = {
    id = ARMS.9107
    desc = {
    	trigger = {
    		tier = EMPEROR
    	}
    	text = EVTDESC_MNM_9107
    }
    desc = {
    	trigger = {
    		tier = KING
    	}
    	text = EVTDESC_MNM_9107_KING
    }
    desc = {
    	trigger = {
    		lower_tier_than = KING
    	}
    	text = EVTDESC_MNM_9107_GENERIC
    }
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy


    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
        name = EVTOPTA_MNM_9107

        if = {
        	limit = { have_duplicate_goldsmith_artifacts_flag_okay_trigger = no }
        	# If player doesn't already have all items in the given set, then give items
	        give_goldsmith_artifacts_flag_okay_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 0.8 min = 40 max = 100 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }

        hidden_effect = {
        	event_target:smith = { character_event = { id = ARMS.9110 days = 5 } }
        	clr_character_flag = expensive_jewels
			clr_character_flag = good_jewels
			clr_character_flag = cheap_jewels
        }
    }
}

#Ping event for problems
character_event = {
	id = ARMS.9108
    hide_window = yes

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = {
    	if = {
    		limit = { NOT = { event_target:smith_employer = { is_alive = yes } } }
    		liege = { save_event_target_as = smith_employer }
    	}

    	event_target:smith_employer = { character_event = { id = ARMS.9109 } }
    }
}

#Problems
character_event = {
    id = ARMS.9109
    desc = EVTDESC_MNM_9109_NEW
    picture = GFX_evt_merchant_caravan
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    #I want my expensive stuff
    option = {
    	trigger = { FROM  = { has_character_flag = expensive_jewels } }
        name = EVTOPTA_MNM_9109
        custom_tooltip = { text = EVTOPTA_MNM_9109_TT_NEW }

        scaled_wealth = { value = -3 min = -150 max = -1000}


        hidden_effect = {
        	FROM = {
	        	clr_character_flag = expensive_jewels
	        	set_character_flag = amazing_jewels
        	}
        	clr_character_flag = expensive_jewels
        	set_character_flag = amazing_jewels
    	}
    }

    #Settle for less expensive stuff
    option = {
    	trigger = { FROM  = { has_character_flag = expensive_jewels } }
        name = EVTOPTB_MNM_9109
        custom_tooltip = { text = EVTOPTB_MNM_9109_TT_NEW }
    }

    #I want my good stuff
    option = {
    	trigger = { FROM  = { has_character_flag = good_jewels } }
        name = EVTOPTC_MNM_9109
        custom_tooltip = { text = EVTOPTC_MNM_9109_TT_NEW }

        scaled_wealth = { value = -1.5 min = -100 max = -500}

        hidden_effect = {
        	FROM = {
	        	clr_character_flag = good_jewels
	        	set_character_flag = expensive_jewels
			}
        	clr_character_flag = good_jewels
        	set_character_flag = expensive_jewels
        }
    }

    #Settle for less good stuff
    option = {
    	trigger = { FROM  = { has_character_flag = good_jewels } }
        name = EVTOPTD_MNM_9109
        custom_tooltip = { text = EVTOPTD_MNM_9109_TT_NEW }
    }

    after = {
    	hidden_effect = {
    		clr_character_flag = goldsmith_fail
    		set_character_flag = goldsmith_success
    		character_event = { id = ARMS.9111 days = 50 random = 100 }
    	}
    }
}

character_event = {
	id = ARMS.9110
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_landed = no
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

	immediate = {
		any_spouse = {
			limit = {
				dynasty = none
			}
			leave_court_and_die_effect = yes
		}
		leave_court_and_die_effect = yes
	}
}

#Ping event for checking if Goldsmith died
character_event = {
	id = ARMS.9111
    hide_window = yes

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    	event_target:smith = { is_alive = yes }
    }

    fail_trigger_effect = { character_event = { id = ARMS.9112 } }

    immediate = {
    	trigger_switch = {
    		on_trigger = has_character_flag
    		goldsmith_success = { event_target:smith = { character_event = { id = ARMS.9104 } } }
    		goldsmith_fail = { event_target:smith = { character_event = { id = ARMS.9108 } } }
    		goldsmith_steal = { event_target:smith = { character_event = { id = ARMS.9131 } } }
		}
		clr_character_flag = goldsmith_success
		clr_character_flag = goldsmith_fail
		clr_character_flag = goldsmith_steal
    }
}

#Goldsmith died
character_event = {
    id = ARMS.9112
    desc = EVTDESC_MNM_9112
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    hide_from = yes
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    #Returned leftover money
    option = {
    	trigger = { has_character_flag = expensive_jewels }
        name = EVTOPTA_MNM_9112

        scaled_wealth = { value = 3 min = 180 }
    }

    #Returned leftover money
    option = {
    	trigger = { has_character_flag = good_jewels }
        name = EVTOPTB_MNM_9112

        scaled_wealth = { value = 1.5 min = 90 }
    }

    #Returned leftover money
    option = {
    	trigger = { has_character_flag = cheap_jewels }
        name = EVTOPTC_MNM_9112

        scaled_wealth = { value = 0.5 min = 25 }
    }
    after = {
    	clr_character_flag = amazing_jewels
    	clr_character_flag = expensive_jewels
		clr_character_flag = good_jewels
		clr_character_flag = cheap_jewels
		clr_character_flag = goldsmith_success
		clr_character_flag = goldsmith_fail
		clr_character_flag = goldsmith_steal
    }
}

character_event = { #Your own smiths have a go
    id = ARMS.9999
	desc = {
		trigger = { has_character_flag = got_terrible_sword }
		text = MNM_9999_DESC
	}
	desc = {
		trigger = { has_character_flag = got_terrible_armor }
		text = MNM_9999_DESC_armor
	}
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy
    hide_from = yes
	hide_new = yes
    is_triggered_only = yes

	trigger = {
		OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
	}

	immediate = {

	}

	option = {
		name = EVTOPTA_MNM_9999
		trigger_switch = {
			on_trigger = has_character_flag
			got_terrible_sword = { add_artifact = terrible_sword }
			got_terrible_armor = { add_artifact = terrible_armor }
		}
	}
}

#Ping event for weaponsmith
character_event = {
    id = ARMS.9116
    hide_window = yes
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

	immediate = {
		if={limit={from={has_character_flag=gromrilsmith}}
		event_target:smith_employer = { character_event = { id = ARMS.21 } }
		}
		else={
		event_target:smith_employer = { character_event = { id = ARMS.12 } }
		}
	}
}

#Ping event for weaponsmith
character_event = {
    id = ARMS.9119
    hide_window = yes
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

	immediate = {
		if={limit={from={has_character_flag=gromrilsmith}}
		event_target:smith_employer = { character_event = { id = ARMS.22 } }
		}
		if={limit={from={has_character_flag=runecraft}}
		event_target:smith_employer = { character_event = { id = ARMS.24 } }
		}
		else={
		event_target:smith_employer = { character_event = { id = ARMS.9120 } }
		}
	}
}


#And how much are you willing to pay?
character_event = {
    id = ARMS.9120
    desc =  EVTDESC_MNM_9120_NEW
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
        name = EVTOPTA_MNM_9120_TT_GREENSKIN
		trigger = {
			OR={
			trait=creature_goblin
            trait=creature_hobgoblin
			trait=creature_orc
			}
			OR={
			AND={
				tier=king
				prestige=400
				scaled_wealth = { value = 3.5 min = 180 max = 500 }
			}
			AND={
				tier=emperor
				prestige=500
				scaled_wealth = { value = 4.5 min = 240 max = 800 }
			}
			AND={
				OR={
					tier=duke
					tier=count
				}
				prestige=300
				scaled_wealth = { value = 1.5 min = 120 max = 800 }
			}}
		}
		if = {
			limit = { FROM = { or={
			has_character_flag = weapon_ax
			has_character_flag = weapon_choppa
			has_character_flag = weapon_club
			has_character_flag = weapon_stabba
			has_character_flag = ard_armour
			}}}
			custom_tooltip = { text = EVTOPTA_MNM_9120_TT_GREENSKIN }
		}
		IF={limit={tier=king}
			prestige=-400

		scaled_wealth = { value = -3.5 min = -180 max = -500 }
		}
		IF={limit={tier=emperor}
			prestige=-500
		scaled_wealth = { value = -4.5 min = -240 max = -800 }
		}
		IF={
			limit={
				OR={
					tier=duke
					tier=count
				}
			}
			prestige=-300
			scaled_wealth = { value = -1.5 min = -120 max = 800 }
		}

        hidden_effect = {
			random_list = {
				40 = { #Success
					event_target:smith = { set_character_flag = good_weapons }
					set_character_flag = good_weapons
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				40 = { #Tries to take them with him
					set_character_flag = smith_duel
					random_list={
						50={
						event_target:smith = { set_character_flag = good_weapons }
						set_character_flag = good_weapons
						}
						50={
						event_target:smith = { set_character_flag = expensive_weapons }
						set_character_flag = expensive_weapons
						}
					}
				}
				10 = { #Steal
					event_target:smith = { set_character_flag = expensive_weapons }
					set_character_flag = expensive_weapons
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			modifier = { factor = 1.3 FROM = { trait = creature_goblin } }
                    modifier = { factor = 1.3 FROM = { trait = creature_hobgoblin } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
				10 = { #Cheap
					event_target:smith = { set_character_flag = cheap_weapons }
					set_character_flag = cheap_weapons
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
				}
			}
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        }
		ai_chance = {
    		factor = 33
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 10
    		}
    		modifier = {
    			lower_tier_than = DUKE
    			factor = 3
    		}
    		modifier = {
    			tier = EMPEROR
    			factor = 3
    		}
    	}
    }
    #The best money can buy
    option = {
        name = EVTOPTA_MNM_9120
        trigger = {
			tier = EMPEROR
			NOR={
				trait=creature_goblin
                trait = creature_hobgoblin
				trait=creature_orc
				trait=creature_dwarf
				AND={
					trait=creature_elf
					OR={
					culture_group=asur_group
					culture_group=druchi_group
					}
				}
			}
        }
       	if = {
            limit = { FROM = { has_character_flag = weapon_sword } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_SWORD_EMPEROR }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_scimitar } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_SWORDSCIMITAR_EMPEROR }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_lance } }
           	custom_tooltip = { text = EVTOPTA_MNM_9120_TT_LANCE_EMPEROR }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_axe } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_AXE_EMPEROR }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_mace } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_MACE_EMPEROR }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_bow } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_BOW_EMPEROR }
        }
        if = {
            limit = { FROM = { has_character_flag = armor_set } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_ARMOR_EMPEROR }
        }

        scaled_wealth = { value = -3.5 min = -400 max = -2000 }

        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_weapons }
        	set_character_flag = expensive_weapons
			random_list = {
				55 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				45 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 400
    				yearly_income = 40
    			}
    			factor = 0
    		}
    	}
    }
    option = {
        name = EVTOPTA_ELDAR_ARMS_9120
        trigger = {
			wealth = 450
			higher_tier_than=COUNT
			AND={
				trait=creature_elf
				OR={
					AND={
						culture_group=asur_group
						FROM={has_character_flag = armor_set}
						nor={
							has_artifact = asur_artifact_dragon_armour
							has_artifact = asur_artifact_shadow_armour
							has_artifact = asur_artifact_ithilmar_armour
						}
					}
					AND={
						culture_group=druchi_group
						FROM={has_character_flag = armor_set}
						nor={
							has_artifact=druchii_meteorite_armour
							has_artifact=druchii_sea_dragon_cloak
						}
					}
				}
				OR={
					FROM={has_character_flag = armor_set}
					AND={
						culture_group=asur_group
						NOT={culture=asur_colonial}
						has_character_flag = weapon_bow
					}
				}
			}
        }
       	if = {
            limit = { FROM = { has_character_flag = weapon_sword } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_SWORD_EMPEROR }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_bow } }
            custom_tooltip = { text = EVTOPTA_MNM_9120_TT_BOW_ELDAR}
        }
        if = {
            limit = {
			culture_group=druchi_group
			FROM = { has_character_flag = armor_set }
			}
            custom_tooltip = { text = EVTOPTA_ARMS_9120_TT_DRUCHII_ARMOR }
        }
        if = {
            limit = {
			culture_group=asur_group
			FROM = { has_character_flag = armor_set }
			}
            custom_tooltip = { text = EVTOPTA_ARMS_9120_TT_ASUR_ARMOR }
        }
        hidden_effect = {
        	event_target:smith = { set_character_flag = expensive_weapons }
        	set_character_flag = expensive_weapons
			random_list = {
				55 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				45 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
        	character_event = { id = ARMS.16 days = 7 }
        }
    	ai_chance = {
    		factor = 33
    		modifier = {
    			tier = EMPEROR
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 400
    				yearly_income = 40
    			}
    			factor = 0
    		}
    	}
    }

    #Something nice
    option = {
        name = {
        	trigger = {
        		tier = EMPEROR
        	}
        	text = EVTOPTB_MNM_9120
        }
        name = {
        	trigger = {
        		tier = KING
        	}
        	text = EVTOPTB_MNM_9120_KING
        }

        trigger = {
			NOR={
			trait=creature_goblin
            trait = creature_hobgoblin
			trait=creature_orc
			}
        	higher_tier_than = DUKE
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_sword } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_SWORD_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_SWORD_KING}
            }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_scimitar } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_SWORDSCIMITAR_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_SWORDSCIMITAR_KING }
            }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_lance } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_LANCE_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_LANCE_KING }
            }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_axe } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_AXE_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_AXE_KING }
            }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_mace } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_MACE_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_MACE_KING }
            }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_bow } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_BOW_EMPEROR}
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_BOW_KING}
            }
        }
        if = {
            limit = { FROM = { has_character_flag = armor_set } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_ARMOR_EMPEROR}
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTB_MNM_9120_TT_ARMOR_KING}
            }
        }

        scaled_wealth = { value = -2.5 min = -180 max = -500 }

        hidden_effect = {
        	event_target:smith = { set_character_flag = good_weapons }
        	set_character_flag = good_weapons
			random_list = {
				70 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				30 = { #Fail
					set_character_flag = smith_fail
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }
		ai_chance = {
    		factor = 33
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 10
    		}
    		modifier = {
    			lower_tier_than = DUKE
    			factor = 3
    		}
    		modifier = {
    			tier = EMPEROR
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 180
    				yearly_income = 18
    			}
    			factor = 0
    		}
    	}
    }

   	#I can't afford that much
    option = {
		trigger={
			NOR={
			trait=creature_goblin
            trait = creature_hobgoblin
			trait=creature_orc
			}
		}
        name = {
        	trigger = {
        		tier = EMPEROR
        	}
        	text = EVTOPTC_MNM_9120
        }
        name = {
        	trigger = {
        		tier = KING
        	}
        	text = EVTOPTC_MNM_9120_KING
        }
        name = {
        	trigger = {
        		NOT = {
        			tier = EMPEROR
        			tier = KING
        		}
        	}
        	text = EVTOPTC_MNM_9120_GENERIC
        }


        if = {
            limit = { FROM = { NOT = { has_character_flag = armor_set } NOT = { has_character_flag = weapon_bow } } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_SWORDSCIMITAR_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_SWORDSCIMITAR_KING }
            }
            else_if = {
            	limit = {
            		NOT = {
            			tier = EMPEROR
            			tier = KING
            		}
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_SWORDSCIMITAR_GENERIC }
            }
        }
        if = {
            limit = { FROM = { has_character_flag = weapon_bow } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_BOW_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_BOW_KING }
            }
            else_if = {
            	limit = {
        			NOT = {
        				tier = EMPEROR
        				tier = KING
        			}
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_BOW_GENERIC }
            }
        }
        if = {
            limit = { FROM = { has_character_flag = armor_set } }
            if = {
            	limit = {
            		tier = EMPEROR
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_ARMOR_EMPEROR }
            }
            else_if = {
            	limit = {
            		tier = KING
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_ARMOR_KING }
            }
            else_if = {
            	limit = {
            		NOT = {
            			tier = EMPEROR
            			tier = KING
            		}
            	}
            	custom_tooltip = { text = EVTOPTC_MNM_9120_TT_ARMOR_GENERIC }
            }
        }

        scaled_wealth = { value = -1.25 min = -50 max = -100 }

        hidden_effect = {
        	event_target:smith = { set_character_flag = cheap_weapons }
        	set_character_flag = cheap_weapons
			random_list = {
				100 = { #Success
        			modifier = { factor = 0.7 FROM = { stewardship <= 2 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 4 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 6 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 8 } }
        			modifier = { factor = 0.7 FROM = { stewardship <= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 10 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 12 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 14 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 16 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 18 } }
        			modifier = { factor = 1.1 FROM = { stewardship >= 20 } }
        			modifier = { factor = 1.3 FROM = { trait = greedy } }
        			modifier = { factor = 1.3 FROM = { trait = diligent } }
        			modifier = { factor = 1.3 FROM = { trait = patient } }
        			modifier = { factor = 1.3 FROM = { is_smart_trigger = yes } }
        			modifier = { factor = 1.5 event_target:the_armory = { always = yes } }
        			set_character_flag = smith_success
				}
				10 = { #Steal
        			modifier = { factor = 1.3 FROM = { trait = envious } }
        			modifier = { factor = 0.2 FROM = { trait = charitable } }
        			modifier = { factor = 0.2 FROM = { trait = content } }
        			modifier = { factor = 1.5 FROM = { trait = ambitious } }
        			modifier = { factor = 1.3 FROM = { trait = deceitful } }
        			trigger = {
        				NOT = {
	        				any_owned_bloodline = {
								has_bloodline_flag = bloodline_artisan_craftsmen
							}
        				}
        			}
        			set_character_flag = smith_steal
				}
			}
        	character_event = { id = ARMS.9125 days = 50 random = 100 }
        	character_event = { id = ARMS.9133 days = 20 random = 5 } #tombola for random events
        }

        ai_chance = {
    		factor = 33
    		modifier = {
    			tier = COUNT
    			factor = 10
    		}
    		modifier = {
    			OR = {
    				tier = KING
    				tier = DUKE
    			}
    			factor = 3
    		}
    		modifier = {
    			NAND = {
    				wealth = 75
    				yearly_income = 7.5
    				religion_group = pagan_group
    			}
    			factor = 0
    		}
    	}
    }

    #Actually, no
    option = {
        name = EVTOPTD_MNM_9120
        custom_tooltip = { text = EVTOPTD_MNM_9120_TT }

       	ai_chance = {
            factor = 15
            modifier = {
                NOR = {
                    has_education_martial_trigger = yes
                    has_lifestyle_martial_trigger = yes
                }
                factor = 20
            }
        }
        clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
        hidden_effect = { FROM = { character_event = { id = ARMS.9110 days = 5 } } }
    }
}

#Ping event for success
character_event = {
	id = ARMS.9121
    hide_window = yes

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = {
    	if = {
    		limit = { NOT = { event_target:smith_employer = { is_alive = yes } } }
    		liege = { save_event_target_as = smith_employer }
    	}
    	if = {
    		limit = { event_target:smith_employer = { OR={
			trait=creature_goblin
            trait = creature_hobgoblin
			trait=creature_orc
			} } }
			event_target:smith_employer = { character_event = { id = ARMS.15 } }
		}
    	if = {
    		limit = { NOT = { event_target:smith_employer = { OR={
			trait=creature_goblin
            trait = creature_hobgoblin
			trait=creature_orc
			} } }}
			trigger_switch = {
				on_trigger = has_character_flag
				amazing_weapons 		= { event_target:smith_employer = { character_event = { id = ARMS.40000 } } }
				expensive_weapons		= { event_target:smith_employer = { character_event = { id = ARMS.9122 } } }
				good_weapons			= { event_target:smith_employer = { character_event = { id = ARMS.9123 } } }
				cheap_weapons			= { event_target:smith_employer = { character_event = { id = ARMS.9124 } } }
			}
    	}
    }
}

#Amazing weapon done
character_event = {
    id = ARMS.40000
    desc = {
    	trigger = { FROM = { NOT = { has_character_flag = armor_set } } }
    	text = EVTDESC_MNM_40000
    }
    desc = {
    	trigger = { FROM = { has_character_flag = armor_set } }
    	text = EVTDESC_MNM_40000_B
    }

    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes
    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
		trigger={
			not={has_character_flag=gromrilsmith}
		}
        name = {
        	text = EVTOPTA_MNM_40000_SWORD
			trigger = { FROM = { has_character_flag = weapon_sword } }
        }
        name = {
        	text = EVTOPTA_MNM_40000_SCIMITAR
        	trigger = { FROM = { has_character_flag = weapon_scimitar } }
        }
        name = {
        	text = EVTOPTA_MNM_40000_LANCE
        	trigger = { FROM = { has_character_flag = weapon_lance } }
        }
        name = {
        	text = EVTOPTA_MNM_40000_AXE
        	trigger = { FROM = { has_character_flag = weapon_axe } }
        }
        name = {
        	text = EVTOPTA_MNM_40000_MACE
        	trigger = { FROM = { has_character_flag = weapon_mace } }
        }
        name = {
        	text = EVTOPTA_MNM_40000_BOW
        	trigger = { FROM = { has_character_flag = weapon_bow } }
        }
        name = {
            text = EVTOPTA_MNM_40000_ARMOR
            trigger = { FROM = {
				has_character_flag = armor_set
				NOR={
				has_character_flag=druchii_sea_dragon_cloak_flag
				has_character_flag=druchii_sea_dragon_cloak_flag
				}}
			}
        }
        name = {
            text = EVTOPTB_ARM_9122_METEORITEB
            trigger = { FROM = { has_character_flag = druchii_sea_dragon_cloak_flag } }
        }
        name = {
            text = EVTOPTB_ARM_9122_DRAGON_SCALEB
            trigger = { FROM = { has_character_flag = druchii_sea_dragon_cloak_flag } }
        }

        if = {
        	limit = { have_duplicate_smith_artifacts_flag_amazing_optionA_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_amazing_optionA_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }
    option = {
		trigger={
			has_character_flag=gromrilsmith
		}
        name = {
        	text = EVTOPTA_GROMRIL_AMAZING
        }
        if = {
        	limit = { have_duplicate_runesmith_artifacts_flag_amazing_option_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_runesmith_artifacts_flag_amazing_option_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }

    option = {
		trigger = { FROM = {
			NOR={
			has_character_flag=druchii_sea_dragon_cloak_flag
			has_character_flag=druchii_sea_dragon_cloak_flag
			}}
			not={has_character_flag=gromrilsmith}
		}
        name = {
        	text = EVTOPTB_MNM_40000_SWORD
			trigger = { FROM = { has_character_flag = weapon_sword } }
        }
        name = {
        	text = EVTOPTB_MNM_40000_SCIMITAR
        	trigger = { FROM = { has_character_flag = weapon_scimitar } }
        }
        name = {
        	text = EVTOPTB_MNM_40000_LANCE
        	trigger = { FROM = { has_character_flag = weapon_lance } }
        }
        name = {
        	text = EVTOPTB_MNM_40000_AXE
        	trigger = { FROM = { has_character_flag = weapon_axe } }
        }
        name = {
        	text = EVTOPTB_MNM_40000_MACE
        	trigger = { FROM = { has_character_flag = weapon_mace } }
        }
        name = {
        	text = EVTOPTB_MNM_40000_BOW
        	trigger = { FROM = { has_character_flag = weapon_bow } }
        }
        name = {
        	text = EVTOPTB_MNM_40000_ARMOR
        	trigger = { FROM = { has_character_flag = armor_set } }
        }

        if = {
        	limit = { have_duplicate_smith_artifacts_flag_amazing_optionB_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_amazing_optionB_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }

    option = {
		trigger = { FROM = {
			NOR={
			has_character_flag=druchii_sea_dragon_cloak_flag
			has_character_flag=druchii_sea_dragon_cloak_flag
			}}
			not={has_character_flag=gromrilsmith}
		}
        name = {
        	text = EVTOPTC_MNM_40000_SWORD
			trigger = { FROM = { has_character_flag = weapon_sword } }
        }
        name = {
        	text = EVTOPTC_MNM_40000_SCIMITAR
        	trigger = { FROM = { has_character_flag = weapon_scimitar } }
        }
        name = {
        	text = EVTOPTC_MNM_40000_LANCE
        	trigger = { FROM = { has_character_flag = weapon_lance } }
        }
        name = {
        	text = EVTOPTC_MNM_40000_AXE
        	trigger = { FROM = { has_character_flag = weapon_axe } }
        }
        name = {
        	text = EVTOPTC_MNM_40000_MACE
        	trigger = { FROM = { has_character_flag = weapon_mace } }
        }
        name = {
        	text = EVTOPTC_MNM_40000_BOW
        	trigger = { FROM = { has_character_flag = weapon_bow } }
        }
        name = {
        	text = EVTOPTC_MNM_40000_ARMOR
        	trigger = { FROM = { has_character_flag = armor_set } }
        }

        if = {
        	limit = { have_duplicate_smith_artifacts_flag_amazing_optionC_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_amazing_optionC_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }

    after = {
		if={ limit={NOT={has_character_flag=gromrilsmith}}
    	hidden_effect = { FROM = { character_event = { id = ARMS.9127 days = 5 } } }
		}
		if={ limit={has_character_flag=gromrilsmith}
			clr_character_flag=gromrilsmith
			event_target:smith={
				clr_character_flag=preparing_crafting
				clr_character_flag=weapon_axe
				clr_character_flag=weapon_mace
				clr_character_flag=armor_set
				clr_character_flag=expensive_weapons
				clr_character_flag = amazing_weapons
			}
		}
    	clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
        clr_character_flag = gromrilsmith
		clr_character_flag=weapon_axe
		clr_character_flag=weapon_mace
		clr_character_flag=armor_set
    }
}

#Expensive weapon done
character_event = {
    id = ARMS.9122
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

	desc = {
    	trigger = { FROM = { NOT = { has_character_flag = armor_set } } }
    	text = EVTDESC_MNM_9122
    }
	desc = {
    	trigger = { FROM = { has_character_flag = armor_set } }
    	text = EVTDESC_MNM_9122_B
    }

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
		trigger={NOT={has_character_flag=gromrilsmith}}
        name = {
            text = EVTOPTA_MNM_9122_SWORD
            trigger = { FROM = { has_character_flag = weapon_sword } }
        }
        name = {
            text = EVTOPTA_MNM_9122_SCIMITAR
            trigger = { FROM = { has_character_flag = weapon_scimitar } }
        }
        name = {
            text = EVTOPTA_MNM_9122_LANCE
            trigger = { FROM = { has_character_flag = weapon_lance } }
        }
        name = {
            text = EVTOPTA_MNM_9122_AXE
            trigger = { FROM = { has_character_flag = weapon_axe } }
        }
        name = {
            text = EVTOPTA_MNM_9122_MACE
            trigger = { FROM = { has_character_flag = weapon_mace } }
        }
        name = {
            text = EVTOPTA_MNM_9122_BOW
            trigger = { FROM = { has_character_flag = weapon_bow } }
        }
        name = {
            text = EVTOPTA_MNM_9122_ARMOR
            trigger = { FROM = {
				has_character_flag = armor_set
				NOR={
					has_character_flag = asur_artifact_dragon_armour_flag
					has_character_flag = asur_artifact_shadow_armour_flag
					has_character_flag = asur_artifact_ithilmar_armour_flag
					has_character_flag=druchii_sea_dragon_cloak_flag
					has_character_flag=druchii_meteorite_armour_flag
				}
			}}
        }
        name = {
            text = EVTOPTB_ARM_9122_METEORITE
            trigger = { FROM = { has_character_flag = druchii_meteorite_armour_flag } }
        }
        name = {
            text = EVTOPTB_ARM_9122_DRAGON_SCALE
            trigger = { FROM = { has_character_flag = druchii_sea_dragon_cloak_flag } }
        }
        name = {
            text = EVTOPTB_ARM_9122_SHADOW
            trigger = { FROM = { has_character_flag = asur_artifact_shadow_armour_flag } }
        }
        name = {
            text = EVTOPTB_ARM_9122_ITHILMAR
            trigger = { FROM = { has_character_flag = asur_artifact_ithilmar_armour_flag } }
        }
        name = {
            text = EVTOPTB_ARM_9122_DRAGON
            trigger = { FROM = { has_character_flag = asur_artifact_dragon_armour_flag } }
        }
        if = {
        	limit = { have_duplicate_smith_artifacts_flag_expensive_optionA_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_expensive_optionA_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }
    option = {
		trigger={has_character_flag=gromrilsmith}
        name = {
        	text = EVTOPTA_GROMRIL_EXPENSIVE
        }
        if = {
        	limit = { have_duplicate_runesmith_artifacts_flag_expensive_option_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_runesmith_artifacts_flag_expensive_option_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
		clr_character_flag=gromrilsmith
		event_target:smith={
			clr_character_flag=preparing_crafting
			clr_character_flag=weapon_axe
			clr_character_flag=expensive_weapons
		}
    }

    option = {
		trigger = { FROM = {
			NOR={
				has_character_flag = asur_artifact_dragon_armour_flag
				has_character_flag = asur_artifact_shadow_armour_flag
				has_character_flag = asur_artifact_ithilmar_armour_flag
				has_character_flag=druchii_sea_dragon_cloak_flag
				has_character_flag=druchii_meteorite_armour_flag
			}}
			NOT={has_character_flag=gromrilsmith}
		}
        name = {
            text = EVTOPTB_MNM_9122_SWORD
            trigger = { FROM = { has_character_flag = weapon_sword } }
        }
        name = {
            text = EVTOPTB_MNM_9122_SCIMITAR
            trigger = { FROM = { has_character_flag = weapon_scimitar } }
        }
        name = {
            text = EVTOPTB_MNM_9122_LANCE
            trigger = { FROM = { has_character_flag = weapon_lance } }
        }
        name = {
            text = EVTOPTB_MNM_9122_AXE
            trigger = { FROM = { has_character_flag = weapon_axe } }
        }
        name = {
            text = EVTOPTB_MNM_9122_MACE
            trigger = { FROM = { has_character_flag = weapon_mace } }
        }
        name = {
            text = EVTOPTB_MNM_9122_BOW
            trigger = { FROM = { has_character_flag = weapon_bow } }
        }
        name = {
            text = EVTOPTB_MNM_9122_ARMOR
            trigger = { FROM = {
				has_character_flag = armor_set
				NOR={
				has_character_flag=druchii_sea_dragon_cloak_flag
				has_character_flag=druchii_meteorite_armour_flag
				}}
			}
        }
        name = {
            text = EVTOPTB_ARM_9122_METEORITE
            trigger = { FROM = { has_character_flag = druchii_meteorite_armour_flag } }
        }
        name = {
            text = EVTOPTB_ARM_9122_DRAGON_SCALE
            trigger = { FROM = { has_character_flag = druchii_sea_dragon_cloak_flag } }
        }
        if = {
        	limit = { have_duplicate_smith_artifacts_flag_expensive_optionB_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_expensive_optionB_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }

    option = {
		trigger = { FROM = {
			NOR={
				has_character_flag = asur_artifact_dragon_armour_flag
				has_character_flag = asur_artifact_shadow_armour_flag
				has_character_flag = asur_artifact_ithilmar_armour_flag
				has_character_flag=druchii_sea_dragon_cloak_flag
				has_character_flag=druchii_meteorite_armour_flag
			}}
			NOT={has_character_flag=gromrilsmith}
		}
        name = {
            text = EVTOPTC_MNM_9122_SWORD
            trigger = { FROM = { has_character_flag = weapon_sword } }
        }
        name = {
            text = EVTOPTC_MNM_9122_SCIMITAR
            trigger = { FROM = { has_character_flag = weapon_scimitar } }
        }
        name = {
            text = EVTOPTC_MNM_9122_LANCE
            trigger = { FROM = { has_character_flag = weapon_lance } }
        }
        name = {
            text = EVTOPTC_MNM_9122_AXE
            trigger = { FROM = { has_character_flag = weapon_axe } }
        }
        name = {
            text = EVTOPTC_MNM_9122_MACE
            trigger = { FROM = { has_character_flag = weapon_mace } }
        }
        name = {
            text = EVTOPTC_MNM_9122_BOW
            trigger = { FROM = { has_character_flag = weapon_bow } }
        }
        name = {
            text = EVTOPTC_MNM_9122_ARMOR
            trigger = { FROM = { has_character_flag = armor_set } }
        }

        if = {
        	limit = { have_duplicate_smith_artifacts_flag_expensive_optionC_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_expensive_optionC_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 3.5 min = 230 max = 2000 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }
    after = {
		if={ limit={NOT={has_character_flag=gromrilsmith}}
    	hidden_effect = { FROM = { character_event = { id = ARMS.9127 days = 5 } } }
		}
		if={ limit={has_character_flag=gromrilsmith}
			clr_character_flag=gromrilsmith
			event_target:smith={
				clr_character_flag=preparing_crafting
				clr_character_flag=weapon_axe
				clr_character_flag=weapon_mace
				clr_character_flag=armor_set
				clr_character_flag=expensive_weapons
				clr_character_flag = amazing_weapons
			}
		}
    	clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
		clr_character_flag=weapon_axe
		clr_character_flag=weapon_mace
		clr_character_flag=armor_set
    }
}

#Good weapon done
character_event = {
    id = ARMS.9123
    desc = EVTDESC_MNM_9123
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
        name = EVTOPTA_MNM_9123
        if = {
        	limit = { have_duplicate_smith_artifacts_flag_good_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_good_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 1.8 min = 100 max = 500 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }
    after = {
    	hidden_effect = { FROM = { character_event = { id = ARMS.9127 days = 5 } } }
    	clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
        clr_character_flag = sword_tier_2
        clr_character_flag = scimitar_tier_2
        clr_character_flag = lance_tier_2
        clr_character_flag = axe_tier_2
        clr_character_flag = mace_tier_2
        clr_character_flag = bow_tier_2
    }
}

#Cheap weapon done
character_event = {
    id = ARMS.9124
    desc = {
    	trigger = {
    		tier = EMPEROR
    	}
    	text = EVTDESC_MNM_9124
    }
    desc = {
    	trigger = {
    		tier = KING
    	}
    	text = EVTDESC_MNM_9124_KING
    }
    desc = {
    	trigger = {
    		NOT = { tier = KING }
    	}
    	text = EVTDESC_MNM_9124_GENERIC
    }


    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
        name = EVTOPTA_MNM_9124

        if = {
        	limit = { have_duplicate_smith_artifacts_flag_okay_trigger = no } # If player doesn't already have all items in the given set, then give items
	        give_smith_artifacts_flag_okay_effect = yes
	    }
	    else = {
	    	scaled_wealth = { value = 0.8 min = 40 max = 100 } # Get some money back if duplicate
	    	custom_tooltip = { text = EVTTT_MNM_9105_NO_DUPLICATES }
	    }
    }
    after = {
    	hidden_effect = { FROM = { character_event = { id = ARMS.9127 days = 5 } } }
    	clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
        clr_character_flag = sword_tier_1
        clr_character_flag = scimitar_tier_1
        clr_character_flag = lance_tier_1
        clr_character_flag = axe_tier_1
        clr_character_flag = mace_tier_1
        clr_character_flag = bow_tier_1
    }
}

#Ping event for problems
character_event = {
	id = ARMS.9128
    hide_window = yes

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    immediate = {
    	if = {
    		limit = { NOT = { event_target:smith_employer = { is_alive = yes } } }
    		liege = { save_event_target_as = smith_employer }
    	}

    	event_target:smith_employer = { character_event = { id = ARMS.9129 } }
    }
}

#Potentially better
character_event = {
    id = ARMS.9129
    desc = EVTDESC_MNM_9129_NEW
    picture = GFX_evt_merchant_caravan
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    #I want my expensive stuff
    option = {
    	trigger = { FROM  = { has_character_flag = expensive_weapons } }
        name = EVTOPTA_MNM_9109
        custom_tooltip = { text = EVTOPTA_MNM_9129_TT_NEW }

        scaled_wealth = { value = -2 min = -300 max = -1000 }

        hidden_effect = {
        	FROM = {
        		clr_character_flag = expensive_weapons
        		set_character_flag = amazing_weapons
        	}
        	clr_character_flag = expensive_weapons
        	set_character_flag = amazing_weapons
        }
    }

    #Settle for less expensive stuff
    option = {
    	trigger = { FROM  = { has_character_flag = expensive_weapons } }
        name = EVTOPTB_MNM_9109
        custom_tooltip = { text = EVTOPTB_MNM_9129_TT_NEW }
    }

    #I want my good stuff
    option = {
    	trigger = { FROM  = { has_character_flag = good_weapons } }
        name = EVTOPTC_MNM_9109
        custom_tooltip = { text = EVTOPTA_MNM_9129_TT_NEW }

        scaled_wealth = { value = -1.25 min = -100 max = -500 }

        hidden_effect = {
        	FROM = {
        		clr_character_flag = good_weapons
        		set_character_flag = expensive_weapons
        	}
        	clr_character_flag = good_weapons
        	set_character_flag = expensive_weapons
        }
    }

    #Settle for less good stuff
    option = {
    	trigger = { FROM  = { has_character_flag = good_weapons } }
        name = EVTOPTD_MNM_9109
        custom_tooltip = { text = EVTOPTB_MNM_9129_TT_NEW }
    }

    after = {
    	hidden_effect = {
    		clr_character_flag = smith_fail
    		set_character_flag = smith_success
    		character_event = { id = ARMS.9125 days = 50 random = 100 }
    	}
    }
}

#Ping event for checking if Weaponsmith died
character_event = {
	id = ARMS.9125
    hide_window = yes

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    	event_target:smith = { is_alive = yes }
    }

    fail_trigger_effect = { character_event = { id = ARMS.9126 } }

    immediate = {
    	trigger_switch = {
    		on_trigger = has_character_flag
    		smith_success = { event_target:smith = { character_event = { id = ARMS.9121 } } }
    		smith_fail = { event_target:smith = { character_event = { id = ARMS.9128 } } }
    		smith_steal = { event_target:smith = { character_event = { id = ARMS.9131 } } }
			smith_duel = { event_target:smith = { character_event = { id = ARMS.13 } } }
		}
		clr_character_flag = smith_success
		clr_character_flag = smith_fail
		clr_character_flag = smith_steal
		clr_character_flag = smith_duel
    }
}

#Weaponsmith died
character_event = {
    id = ARMS.9126
    desc = EVTDESC_MNM_9112
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    hide_from = yes

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    #Returned leftover money
    option = {
    	trigger = { has_character_flag = expensive_weapons }
        name = EVTOPTA_MNM_9112

        scaled_wealth = { value = 3.5 min = 230 }
    }

    #Returned leftover money
    option = {
    	trigger = { has_character_flag = good_weapons }
        name = EVTOPTB_MNM_9112

        scaled_wealth = { value = 1.8 min = 100 }
    }

    #Returned leftover money
    option = {
    	trigger = { has_character_flag = cheap_weapons }
        name = EVTOPTC_MNM_9112

        scaled_wealth = { value = 0.8 min = 40 }
    }
    after = {
    	clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = weaponsmith
        clr_character_flag = armorsmith
		clr_character_flag = smith_success
		clr_character_flag = smith_fail
		clr_character_flag = smith_steal
    }
}

character_event = {
	id = ARMS.9127
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_landed = no
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

	immediate = {
		any_spouse = {
			limit = {
				dynasty = none
			}
			leave_court_and_die_effect = yes
		}
		leave_court_and_die_effect = yes
	}
}

#Smith steals item and decides who to give it to
character_event = {
	id = ARMS.9131
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		OR = {
			has_dlc = "Mystics"
			has_dlc = "Jade Dragon"
		}
	}

	immediate = {
		if = {
			limit = { NOT = { event_target:smith_employer = { is_alive = yes } } }
    		liege = { save_event_target_as = smith_employer }
		}
		trigger_switch = {
			on_trigger = has_character_flag
			expensive_jewels = {
		        if = {
		        	limit = {
		        		FROM = {
			        		 NOR = {
								religion_group = ormazd_gods_group
								religion_group = chaos_gods_group
								religion_group = oriental_gods_group
							}
						}
		        	}
		        	add_artifact = crown_of_majesty
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = emerald_scepter
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = sword_of_heroes
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		OR = {
								religion_group = ormazd_gods_group
							}
			        	}
		        	}
		        	add_artifact = dagger_of_glory
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = ruby_bracelets
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		OR = {
								religion_group = oriental_gods_group
							}
						}
					}
		        	add_artifact = circlet_of_the_heavens
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = staff_of_majesty
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		OR = {
								religion_group = chaos_gods_group
							}
			        	}
		        	}
		        	add_artifact = crown_of_crows
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = sword_of_heroes
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else = {
		        	add_artifact = heros_crown
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = axe_of_the_ancestors
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
			}
			good_jewels = {
				if = {
		        	limit = {
		        		FROM = {
			        		NOR = {
								religion_group = ormazd_gods_group
								religion_group = chaos_gods_group
								religion_group = oriental_gods_group
							}
						}
		        	}
		        	add_artifact = crown_of_pearls
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = ruby_scepter
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = golden_sword
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		OR = {
								religion_group = ormazd_gods_group
							}
			        	}
		        	}
		        	add_artifact = bejeweled_dagger
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = golden_bracelets
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		OR = {
								religion_group = oriental_gods_group
							}
						}
					}
		        	add_artifact = circlet_of_the_heavens
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = golden_staff
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		 OR = {
								religion_group = chaos_gods_group
							}
			        	}
		        	}
		        	add_artifact = crown_of_the_sea
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = golden_sword
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else = {
		        	add_artifact = amber_crown
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = obsidian_axe
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
			}
			cheap_jewels = {
		        if = {
		        	limit = {
		        		FROM = {
			        		NOR = {
								religion_group = ormazd_gods_group
								religion_group = chaos_gods_group
								religion_group = oriental_gods_group
							}
						}
		        	}
		        	add_artifact = the_lily_crown
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = noble_scepter
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = engraved_sword
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		 OR = {
								religion_group = ormazd_gods_group
							}
			        	}
		        	}
		        	add_artifact = engraved_dagger
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = silver_bracelets
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		OR = {
								religion_group = oriental_gods_group
							}
						}
					}
		        	add_artifact = circlet_of_twilight
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = silver_staff
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else_if = {
		        	limit = {
		        		FROM = {
			        		OR = {
								religion_group = chaos_gods_group
							}
			        	}
		        	}
		        	add_artifact = iron_crown
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = engraved_sword
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
		        else = {
		        	add_artifact = engraved_crown
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        	add_artifact = ceremonial_axe
		        	new_artifact = { set_artifact_flag = stolen_by_smith }
		        }
			}
			amazing_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
					weapon_sword = {
						random_list = {
							1 = { add_artifact = sword_tier_4_heartseeker }
			        		1 = { add_artifact = sword_tier_4_vengeance }
			        		1 = { add_artifact = sword_tier_4_fury }
						}
						new_artifact = { set_artifact_flag = stolen_by_smith }
					}
			        weapon_scimitar = {
			        	random_list = {
			        		1 = { add_artifact = scimitar_tier_4_golden }
			        		1 = { add_artifact = scimitar_tier_4_fortune }
			        		1 = { add_artifact = scimitar_tier_4_conquest }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_lance = {
			        	random_list = {
			        		1 = { add_artifact = lance_tier_4_impaler }
			        		1 = { add_artifact = lance_tier_4_trident }
			        		1 = { add_artifact = lance_tier_4_piercer }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_axe = {
			        	random_list = {
			        		1 = { add_artifact = axe_tier_4_cleaver }
			        		1 = { add_artifact = axe_tier_4_ravager }
			        		1 = { add_artifact = axe_tier_4_marauder }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_mace = {
			        	random_list = {
			        		1 = { add_artifact = mace_tier_4_foe_hammer }
			        		1 = { add_artifact = mace_tier_4_bone_breaker }
			        		1 = { add_artifact = mace_tier_4_shatterer }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_bow = {
			        	random_list = {
			        		1 = { add_artifact = bow_tier_4_silent_wind }
			        		1 = { add_artifact = bow_tier_4_lightning }
			        		1 = { add_artifact = bow_tier_4_eagle }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        armor_set = {
			        	random_list = {
			        		1 = { add_artifact = armor_tier_4_guardian }
			        		1 = { add_artifact = armor_tier_4_champion }
			        		1 = { add_artifact = armor_tier_4_warden }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
				}
			}
			expensive_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
			        weapon_sword = {
			        	random_list = {
			        		1 = { add_artifact = sword_tier_3_heartseeker }
			        		1 = { add_artifact = sword_tier_3_vengeance }
			        		1 = { add_artifact = sword_tier_3_fury }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_scimitar = {
			        	random_list = {
			        		1 = { add_artifact = scimitar_tier_3_golden }
			        		1 = { add_artifact = scimitar_tier_3_fortune }
			        		1 = { add_artifact = scimitar_tier_3_conquest }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_lance = {
			        	random_list = {
			        		1 = { add_artifact = lance_tier_3_impaler }
			        		1 = { add_artifact = lance_tier_3_trident }
			        		1 = { add_artifact = lance_tier_3_piercer }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_axe = {
			        	random_list = {
			        		1 = { add_artifact = axe_tier_3_cleaver }
			        		1 = { add_artifact = axe_tier_3_ravager }
			        		1 = { add_artifact = axe_tier_3_marauder }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_mace = {
			        	random_list = {
			        		1 = { add_artifact = mace_tier_3_foe_hammer }
			        		1 = { add_artifact = mace_tier_3_bone_breaker }
			        		1 = { add_artifact = mace_tier_3_shatterer }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        weapon_bow = {
			        	random_list = {
			        		1 = { add_artifact = bow_tier_3_silent_wind }
			        		1 = { add_artifact = bow_tier_3_lightning }
			        		1 = { add_artifact = bow_tier_3_eagle }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			        armor_set = {
			        	random_list = {
			        		1 = { add_artifact = armor_tier_3_guardian }
			        		1 = { add_artifact = armor_tier_3_champion }
			        		1 = { add_artifact = armor_tier_3_warden }
			        	}
		        		new_artifact = { set_artifact_flag = stolen_by_smith }
			        }
			    }
			}
			good_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
			        weapon_sword = { add_artifact = sword_tier_2_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_scimitar = { add_artifact = scimitar_tier_2_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_lance = { add_artifact = lance_tier_2_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_axe = { add_artifact = axe_tier_2_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_mace = { add_artifact = mace_tier_2_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_bow = { add_artifact = bow_tier_2_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        armor_set = { add_artifact = armor_tier_2 new_artifact = { set_artifact_flag = stolen_by_smith } }
			    }
			}
			cheap_weapons = {
				trigger_switch = {
					on_trigger = has_character_flag
			        weapon_sword = { add_artifact = sword_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_scimitar = { add_artifact = scimitar_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_lance = { add_artifact = lance_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_axe = { add_artifact = axe_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_mace = { add_artifact = mace_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        weapon_bow = { add_artifact = bow_tier_1_new new_artifact = { set_artifact_flag = stolen_by_smith } }
			        armor_set = { add_artifact = armor_tier_1 new_artifact = { set_artifact_flag = stolen_by_smith } }
			    }
			}
		}
		#Give to landed rivals first, then nearby rulers who dislike the employer, else keep for self and run away.
		if = {
			limit = {
				event_target:smith_employer = {
					any_rival = {
						is_landed = yes
						is_within_diplo_range = ROOT
					}
				}
			}
			event_target:smith_employer = {
				random_rival = {
					limit = {
						is_landed = yes
						is_within_diplo_range = ROOT
					}
					save_event_target_as = smith_steal_target
				}
			}
		}
		else_if = {
			limit = {
				event_target:smith_employer = {
					any_neighbor_independent_ruler = {
						is_landed = yes
						NOT = {
							opinion = {
								who = PREV
								value = -30
							}
						}
					}
				}
			}
			event_target:smith_employer = {
				any_neighbor_independent_ruler = {
					limit = {
						is_landed = yes
						NOT = {
							opinion = {
								who = PREV
								value = -30
							}
						}
					}
					save_event_target_as = smith_steal_target
				}
			}
		}
		else_if = {
			limit = {
				event_target:smith_employer = {
					any_neighbor_independent_ruler = {
						is_landed = yes
						NOT = {
							opinion = {
								who = PREV
								value = 0
							}
						}
					}
				}
			}
			event_target:smith_employer = {
				any_neighbor_independent_ruler = {
					limit = {
						is_landed = yes
						NOT = {
							opinion = {
								who = PREV
								value = 0
							}
						}
					}
					save_event_target_as = smith_steal_target
				}
			}
		}
		else = { save_event_target_as = smith_steal_target }
		any_artifact = {
			limit = { has_artifact_flag = stolen_by_smith }
			set_original_owner = event_target:smith_employer
			transfer_artifact = {
				to = event_target:smith_steal_target
				from = ROOT
			}
		}
		if = {
			limit = {
				event_target:smith_steal_target = { is_landed = yes }
				is_landed = no
			}
			move_character = event_target:smith_steal_target
			opinion = {
				who = event_target:smith_steal_target
				modifier = opinion_grateful
				years = 10
			}
			reverse_opinion = {
				who = event_target:smith_steal_target
				modifier = opinion_grateful
				years = 10
			}
		}
		else = { banish = yes }
		event_target:smith_employer = { character_event = { id = ARMS.9132 } }
		#clear_event_target = smith_employer
		clr_character_flag = amazing_weapons
    	clr_character_flag = expensive_weapons
		clr_character_flag = good_weapons
		clr_character_flag = cheap_weapons
		clr_character_flag = amazing_jewels
		clr_character_flag = expensive_jewels
		clr_character_flag = good_jewels
		clr_character_flag = cheap_jewels
	}
}

#Smith stole item and fled
character_event = {
	id = ARMS.9132
	desc = EVT_DESC_MNM_9132
    picture = GFX_evt_merchant_caravan
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    }

    option = {
    	name = EVT_OPTA_MNM_9132
    	event_target:smith_steal_target = {
    		show_scope_change = no
    		any_artifact = {
    			limit = { has_artifact_flag = stolen_by_smith }
    			clr_artifact_flag = stolen_by_smith
    		}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_thief
				years = 10
			}
    	}
    	FROM = {
    		show_scope_change = no
			reverse_opinion = {
				who = ROOT
				modifier = opinion_thief
				years = 10
			}
			hidden_effect = { remove_nickname = yes }
		}
    }

	option = {
		name = EVT_OPTB_MNM_9132
		tooltip_info = intrigue
		custom_tooltip = { text = EVT_OPTB_MNM_9132_TT}
		trigger = {
			intrigue = 15
		}
		hidden_effect = {
			event_target:smith_steal_target = {
				any_artifact = {
					show_scope_change = no
					limit = { has_artifact_flag = stolen_by_smith }
					transfer_artifact = {
						from = event_target:smith_steal_target
						to = ROOT
					}
					clr_artifact_flag = stolen_by_smith
				}
			}
		}

		FROM = {
			show_scope_change = no
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}

	}
}

#Tombola for events mid-smithing
character_event = {
	id = ARMS.9133
	hide_window = yes
    is_triggered_only = yes

    trigger = {
    	OR = {
    		has_dlc = "Mystics"
    		has_dlc = "Jade Dragon"
    	}
    	event_target:smith = { is_alive = yes }
    }

    fail_trigger_effect = {
    	if = {
    		limit = {
    			OR = {
    				has_character_flag = weaponsmith
					has_character_flag = armorsmith
    			}
    		}
    		character_event = { id = ARMS.9126 }
    	}
    	else = {
    		character_event = { id = ARMS.9112 }
    	}
    	clear_delayed_event = { id = ARMS.9111 }
    	clear_delayed_event = { id = ARMS.9125 }
    }

	immediate = {
		event_target:smith = {
			random_list = { #Set flag then ping event
				20 = { #Smith teachs someone stewardship
					trigger = {
						ROOT = {
							OR = {
								any_courtier = {
									is_inaccessible_or_incapable_trigger = no
									age = 13
									stewardship < 14
									NOT = { character = PREVPREV }
								}
								any_friend = {
									is_inaccessible_or_incapable_trigger = no
									liege = { character = ROOT }
									age = 13
									stewardship < 14
									NOT = { character = PREVPREV }
								}
								any_child = {
									is_inaccessible_or_incapable_trigger = no
									liege = { character = ROOT }
									age = 13
									stewardship < 14
									NOT = { character = PREVPREV }
								}
							}
						}
					}
					modifier = {
						factor = 1.5
						ROOT = {
							NOR = {
								has_character_flag = weaponsmith
								has_character_flag = armorsmith
							}
						}
					}
					set_character_flag = smith_event_MNM_9135
					character_event = { id = ARMS.9134 }
				}
				20 = { #Smith makes child/ward stronger
					trigger = {
						ROOT = {
							OR = {
								any_child = {
									is_inaccessible_or_incapable_trigger = no
									liege = { character = ROOT }
									age <= 16
									age = 9
									is_strong_trigger = no
									NOT = { trait = weak }
								}
								any_pupil = {
									is_inaccessible_or_incapable_trigger = no
									age = 9
									age <= 16
									is_strong_trigger = no
									NOT = { trait = weak }
								}
							}
						}
					}
					modifier = {
						factor = 1.5
						ROOT = {
							OR = {
								has_character_flag = weaponsmith
								has_character_flag = armorsmith
							}
						}
					}
					set_character_flag = smith_event_MNM_9136
					character_event = { id = ARMS.9134 }
				}
				15 = { #Smith sleeps with courtier
					trigger = {
						ROOT = {
							any_courtier = {
								is_inaccessible_or_incapable_trigger = no
								age = 16
								OR = {
									AND = {
										event_target:smith = { is_female = yes }
										prefers_men_trigger = no
									}
									AND = {
										event_target:smith = { is_female = no }
										prefers_men_trigger = yes
									}
								}
							}
							NOT = {
								any_owned_bloodline = {
									has_bloodline_flag = bloodline_artisan_craftsmen #A Legendary Bloodline
								}
							}
						}
						NOR = {
							trait = chaste
							trait = celibate
						}
					}
					modifier = {
						factor = 2
						trait = lustful
					}
					modifier = {
						factor = 2
						trait = hedonist
					}
					modifier = {
						factor = 2
						OR = {
							trait = seducer
							trait = seductress
						}
					}
					set_character_flag = smith_event_MNM_9137
					character_event = { id = ARMS.9134 }
				}
				15 = { #Smith has an accident
					modifier = {
						factor = 5
						is_dumb_trigger = yes
					}
					modifier = { factor = 0 }
					set_character_flag = smith_event_MNM_9138
					character_event = { id = ARMS.9134 }
				}
				30 = { }
			}
		}
	}
}

#Ping the smith
character_event = {
	id = ARMS.9134
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		trigger_switch = {
			on_trigger = has_character_flag
			smith_event_MNM_9135 = { FROM = { character_event = { id = ARMS.9135 } } }
			smith_event_MNM_9136 = { FROM = { character_event = { id = ARMS.9136 } } }
			smith_event_MNM_9137 = { FROM = { character_event = { id = ARMS.9137 } } }
			smith_event_MNM_9138 = { FROM = { character_event = { id = ARMS.9138 } } }
		}
		clr_character_flag = smith_event_MNM_9135
		clr_character_flag = smith_event_MNM_9136
		clr_character_flag = smith_event_MNM_9137
		clr_character_flag = smith_event_MNM_9138
	}
}

#Smith teaches someone stewardship
character_event = {
	id = ARMS.9135
	desc = EVT_DESC_MNM_9135
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {
		random_courtier = {
			limit = {
				is_inaccessible_or_incapable_trigger = no
				age = 13
				stewardship < 14
				NOT = { character = FROM }
			}
			save_event_target_as = smith_event_target
		}
		random_friend = {
			limit = {
				is_inaccessible_or_incapable_trigger = no
				liege = { character = ROOT }
				age = 13
				stewardship < 14
				NOT = { character = FROM }
			}
			save_event_target_as = smith_event_target
		}
		random_child = {
			limit = {
				is_inaccessible_or_incapable_trigger = no
				liege = { character = ROOT }
				age = 13
				stewardship < 14
			}
			save_event_target_as = smith_event_target
		}
	}

	option = {
		name = EVT_OPTA_MNM_9135
		prestige = -50
		event_target:smith_event_target = {
			change_stewardship = 1
			opinion = {
				who = ROOT
				modifier = opinion_happy
				months = 12
			}
		}
		FROM = {
			show_scope_change = no
			reverse_opinion = {
				who = event_target:smith_event_target
				modifier = opinion_grateful
				months = 12
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_grateful
				months = 12
			}
		}
	}

	option = {
		name = EVT_OPTB_MNM_9135
		event_target:smith_event_target = {
			show_scope_change = no
			opinion = {
				who = ROOT
				modifier = opinion_disappointed
				months = 12
			}
		}
		reverse_opinion = {
			who = FROM
			modifier = opinion_upset
			months = 12
		}
		if = {
			limit = {
				OR = {
					AND = {# has weapon/armor smith not max tier
						OR = {
							has_character_flag = weaponsmith
							has_character_flag = armorsmith
						}
						OR={
							NOR={ #It is a Mastered Art
							culture_group=asur_group
							culture_group=druchi_group
							culture_group=asrai_group
							}
							has_character_flag=cheap_weapons
						}
						NOT = {
							has_character_flag = expensive_weapons
							has_character_flag = amazing_weapons
						}
					}
					AND = {# or has goldsmith not max tier
						NOR = {
							has_character_flag = weaponsmith
							has_character_flag = armorsmith
						}
						NOT = { has_character_flag = expensive_jewels }
					}
				}
			}
			prestige = 50
			random = {
				chance = 10
				modifier = {
					factor = 0.5
					OR = {
						has_character_flag = good_weapons
						has_character_flag = good_jewels
					}
				}
				custom_tooltip = {
					text = smith_improves_quality_tt
					if = {
						limit = {
							OR = {
								has_character_flag = weaponsmith
								has_character_flag = armorsmith
							}
						}
						trigger_switch = {
							on_trigger = has_character_flag
							cheap_weapons = {
								clr_character_flag = cheap_weapons set_character_flag = good_weapons
								FROM = { clr_character_flag = cheap_weapons set_character_flag = good_weapons }
							}
							good_weapons = {
								clr_character_flag = good_weapons set_character_flag = expensive_weapons
								FROM = { clr_character_flag = good_weapons set_character_flag = expensive_weapons }
							}
						}
					}
					else = {
						trigger_switch = {
							on_trigger = has_character_flag
							cheap_jewels = {
								clr_character_flag = cheap_jewels set_character_flag = good_jewels
								FROM = { clr_character_flag = cheap_jewels set_character_flag = good_jewels }
							}
							good_jewels = {
								clr_character_flag = good_jewels set_character_flag = expensive_jewels
								FROM = { clr_character_flag = good_jewels set_character_flag = expensive_jewels }
							}
						}
					}
				}
			}
		}
		else = {
			prestige = 75
		}
	}
}

#Smith makes ward stronger
character_event = {
	id = ARMS.9136
	desc = EVT_DESC_MNM_9136
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		random_child = {
			limit = {
				liege = { character = ROOT }
				age <= 16
				age = 9
				is_strong_trigger = no
				NOT = { trait = weak }
				is_inaccessible_or_incapable_trigger = no
			}
			save_event_target_as = smith_event_target
		}
		random_pupil = {
			limit = {
				age <= 16
				age = 9
				is_strong_trigger = no
				NOT = { trait = weak }
				is_inaccessible_or_incapable_trigger = no
			}
			save_event_target_as = smith_event_target
		}
	}

	option = {
		name = EVT_OPTA_MNM_9136
		prestige = -50
		event_target:smith_event_target = {
			show_scope_change = no
			if = {
				limit = { trait = feeble }
				remove_trait = feeble
			}
			else = { add_trait = robust }
			opinion = {
				who = ROOT
				modifier = opinion_happy
				months = 12
			}
		}
		FROM = {
			show_scope_change = no
			reverse_opinion = {
				who = event_target:smith_event_target
				modifier = opinion_grateful
				months = 12
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_grateful
				months = 12
			}
		}
	}

	option = {
		name = EVT_OPTB_MNM_9136
		event_target:smith_event_target = {
			show_scope_change = no
			opinion = {
				who = ROOT
				modifier = opinion_disappointed
				months = 12
			}
		}
		reverse_opinion = {
			who = FROM
			modifier = opinion_upset
			months = 12
		}
		if = {
			limit = {
				OR = {
					AND = { #has weapon/armor smith not max tier
						OR = {
							has_character_flag = weaponsmith
							has_character_flag = armorsmith
						}
						NOT = {
							has_character_flag = expensive_weapons
							has_character_flag = amazing_weapons
						}
					}
					AND = { #or has goldsmith not max tier
						NOR = {
							has_character_flag = weaponsmith
							has_character_flag = armorsmith
						}
						NOT = { has_character_flag = expensive_jewels }
					}
				}
			}
			prestige = 50
			random = {
				chance = 10
				modifier = {
					factor = 0.5
					OR = {
						has_character_flag = good_weapons
						has_character_flag = good_jewels
					}
				}
				custom_tooltip = {
					text = smith_improves_quality_tt
					if = {
						limit = {
							OR = {
								has_character_flag = weaponsmith
								has_character_flag = armorsmith
							}
						}
						trigger_switch = {
							on_trigger = has_character_flag
							cheap_weapons = {
								clr_character_flag = cheap_weapons set_character_flag = good_weapons
								FROM = { clr_character_flag = cheap_weapons set_character_flag = good_weapons }
							}
							good_weapons = {
								clr_character_flag = good_weapons set_character_flag = expensive_weapons
								FROM = { clr_character_flag = good_weapons set_character_flag = expensive_weapons }
							}
						}
					}
					else = {
						trigger_switch = {
							on_trigger = has_character_flag
							cheap_jewels = {
								clr_character_flag = cheap_jewels set_character_flag = good_jewels
								FROM = { clr_character_flag = cheap_jewels set_character_flag = good_jewels }
							}
							good_jewels = {
								clr_character_flag = good_jewels set_character_flag = expensive_jewels
								FROM = { clr_character_flag = good_jewels set_character_flag = expensive_jewels }
							}
						}
					}
				}
			}
		}
		else = {
			prestige = 75
		}
	}
}

#Smith sleeps with courtier
character_event = {
	id = ARMS.9137
	desc = EVT_DESC_MNM_9137
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		random_courtier = {
			limit = {
				is_inaccessible_or_incapable_trigger = no
				age = 16
				OR = {
					AND = {
						event_target:smith = { is_female = yes }
						prefers_men_trigger = no
					}
					AND = {
						event_target:smith = { is_female = no }
						prefers_men_trigger = yes
					}
				}
			}
			save_event_target_as = smith_event_target
			save_event_target_as = sex_partner
		}
		FROM = { unprotected_sex_effect_event_target = yes }
	}

	option = { #Not my business
		name = EVT_OPTA_MNM_9137
		prestige = -75
	}

	option = { #Helll no
		name = EVT_OPTB_MNM_9137
		event_target:smith_event_target = {
			show_scope_change = no
			opinion = {
				who = ROOT
				modifier = opinion_upset
				months = 12
			}
		}
		opinion = {
			who = FROM
			modifier = opinion_angry
			months = 12
		}
		reverse_opinion = {
			who = FROM
			modifier = opinion_worried
			months = 12
		}
		prestige = 25
	}

	option = { #Get out of my court
		name = EVT_OPTC_MNM_9137
		hidden_effect = {
    		clear_delayed_event = { id = ARMS.9111 }
    		clear_delayed_event = { id = ARMS.9125 }
    		clr_character_flag = amazing_weapons
	    	clr_character_flag = expensive_weapons
			clr_character_flag = good_weapons
			clr_character_flag = cheap_weapons
			clr_character_flag = weaponsmith
	        clr_character_flag = armorsmith
			clr_character_flag = smith_success
			clr_character_flag = smith_fail
			clr_character_flag = smith_steal
			clr_character_flag = amazing_jewels
	    	clr_character_flag = expensive_jewels
			clr_character_flag = good_jewels
			clr_character_flag = cheap_jewels
			clr_character_flag = goldsmith_success
			clr_character_flag = goldsmith_fail
			clr_character_flag = goldsmith_steal
			FROM = {
				clr_character_flag = amazing_weapons
		    	clr_character_flag = expensive_weapons
				clr_character_flag = good_weapons
				clr_character_flag = cheap_weapons
				clr_character_flag = amazing_jewels
		    	clr_character_flag = expensive_jewels
				clr_character_flag = good_jewels
				clr_character_flag = cheap_jewels
				remove_nickname = yes
			}
    	}
    	prestige = 100
    	FROM = {
    		show_scope_change = no
    		banish = yes
			opinion = {
				who = ROOT
				modifier = opinion_angry
				months = 12
			}
    	}
		reverse_opinion = {
			who = event_target:smith_event_target
			modifier = opinion_angry
			months = 12
		}
    	random = {
    		chance = 30
    		modifier = {
    			factor = 0
    			event_target:smith_event_target = { any_spouse = { ai = no } }
    		}
    		custom_tooltip = {
    			text = smith_lover_elopes_tt
    			event_target:smith = {
    				liege = {
    					event_target:smith_event_target = {
							if = {
								limit = { is_landed = no }
								move_character = PREV
							}
    						remove_spouse = spouse
    						add_spouse = event_target:smith
    					}
    				}
    			}
    		}
    	}
	}

	option = { #Off with his head
		name = EVT_OPTD_MNM_9137
		hidden_effect = {
    		clear_delayed_event = { id = ARMS.9111 }
    		clear_delayed_event = { id = ARMS.9125 }
    		clr_character_flag = amazing_weapons
	    	clr_character_flag = expensive_weapons
			clr_character_flag = good_weapons
			clr_character_flag = cheap_weapons
			clr_character_flag = weaponsmith
	        clr_character_flag = armorsmith
			clr_character_flag = smith_success
			clr_character_flag = smith_fail
			clr_character_flag = smith_steal
			clr_character_flag = amazing_jewels
	    	clr_character_flag = expensive_jewels
			clr_character_flag = good_jewels
			clr_character_flag = cheap_jewels
			clr_character_flag = goldsmith_success
			clr_character_flag = goldsmith_fail
			clr_character_flag = goldsmith_steal
			FROM = {
				remove_nickname = yes
			}
    	}
    	prestige = 100
    	FROM = { death = { death_reason = death_execution killer = ROOT } }
		reverse_opinion = {
			who = event_target:smith_event_target
			modifier = opinion_angry
			months = 12
		}
	}
}

#Smith injured in accident
character_event = {
	id = ARMS.9138
	desc = EVT_DESC_MNM_9138
    picture = GFX_evt_weaponsmith
    border = GFX_event_normal_frame_economy

    is_triggered_only = yes

    option = {
    	name = EVT_OPTA_MNM_9318
    	scaled_wealth = { value = -0.2 min = -30 max = -100 }
    	FROM = {
    		show_scope_change = no
    		random_list = {
    			1 = { add_maimed_trait_effect = yes }
    			2 = {
    				trigger = { NOT = { trait = wounded } }
    				add_trait = wounded
    			}
    		}
			add_character_modifier = {
				name = good_care
				duration = 365
			}
    	}
    }
    option = {
    	name = EVT_OPTB_MNM_9318
		hidden_effect = {
    		clear_delayed_event = { id = ARMS.9111 }
    		clear_delayed_event = { id = ARMS.9125 }
    		clr_character_flag = amazing_weapons
	    	clr_character_flag = expensive_weapons
			clr_character_flag = good_weapons
			clr_character_flag = cheap_weapons
			clr_character_flag = weaponsmith
	        clr_character_flag = armorsmith
			clr_character_flag = smith_success
			clr_character_flag = smith_fail
			clr_character_flag = smith_steal
			clr_character_flag = amazing_jewels
	    	clr_character_flag = expensive_jewels
			clr_character_flag = good_jewels
			clr_character_flag = cheap_jewels
			clr_character_flag = goldsmith_success
			clr_character_flag = goldsmith_fail
			clr_character_flag = goldsmith_steal
			FROM = {
				clr_character_flag = amazing_weapons
		    	clr_character_flag = expensive_weapons
				clr_character_flag = good_weapons
				clr_character_flag = cheap_weapons
				clr_character_flag = amazing_jewels
		    	clr_character_flag = expensive_jewels
				clr_character_flag = good_jewels
				clr_character_flag = cheap_jewels
				remove_nickname = yes
			}
    	}
    	FROM = {
    		show_scope_change = no
    		random_list = {
    			1 = { add_maimed_trait_effect = yes }
    			2 = {
    				trigger = { NOT = { trait = wounded } }
    				add_trait = wounded
    			}
    		}
    		banish = yes
    	}
    }
}

character_event = {
	id = ARMS.9899
	hide_window = yes

	is_triggered_only = yes
	has_dlc = "Mystics"

	trigger = {
		FROM = {
			always = yes
			is_capital = yes
			location = { is_capital = yes }
		}
	}

	immediate = {
		set_character_flag = looted_by_raiding_holding
		repeat_event = { id = ARMS.9900 }
	}
}

character_event = {
	id = ARMS.9900
    hide_window = yes

	is_triggered_only = yes

	trigger = {
		OR = {
			has_dlc = "Mystics"
			has_dlc = "Holy Fury"
		}
		FROM = {
			is_capital = yes #capital holding
			location = { is_capital = yes } #of capital province
		}
	}

	immediate = {
		save_event_target_as = looter
		FROM = {
			location = {
				save_event_target_as = target_location
			}
		}
		#log = "Chance to lose an artifact on_action fired for the leader: [This.GetBestName] on the holding: [From.GetName]"
		FROM = {
			save_event_target_as = target_title
			holder_scope = {
				if = {
					limit = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
					break = yes
				}
				#log = "Chance to lose an artifact on_action fired for the capital of [This.GetBestName]"
				if = {
					limit = {
						num_of_artifacts = 1
						at_location = event_target:target_location
					}
					character_event = { id = ARMS.9901 } # Chance to lose an artifact.
				}
				any_courtier = {
					limit = {
						num_of_artifacts = 1
						at_location = event_target:target_location
						prisoner = no
					}
					character_event = { id = ARMS.9901 } # Chance to lose an artifact.
				}
			}
		}
	}
}

character_event = {
	id = ARMS.9901

	hide_window = yes

	is_triggered_only = yes

	immediate = {
		save_event_target_as = original_item_owner
		random_list = {
			100 = {
				modifier = {
					factor = 0
					NOT = {
						any_artifact = {
							quality == 1
							NOT = {
								artifact_type_owned_by = FROM
							}
						}
					}
				}
				FROM = {
					character_event = { id = ARMS.9902 }
				}
			}
			70 = {
				modifier = {
					factor = 0
					NOT = {
						any_artifact = {
							quality == 2
							NOT = {
								artifact_type_owned_by = FROM
							}
						}
					}
				}
				FROM = {
					character_event = { id = ARMS.9904 }
				}
			}
			45 = {
				modifier = {
					factor = 0
					NOT = {
						any_artifact = {
							quality == 3
						}
					}
				}
				FROM = {
					character_event = { id = ARMS.9906 }
				}
			}
			25 = {
				modifier = {
					factor = 0
					NOT = {
						any_artifact = {
							quality == 4
						}
					}
				}
				FROM = {
					character_event = { id = ARMS.9908 }
				}
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_artifact = {
							quality == 5
						}
					}
				}
				FROM = {
					character_event = { id = ARMS.9910 }
				}
			}

			6000 = { #chance of no artifact stealing
				modifier = {
					factor = 0.2
					FROM = { has_character_flag = looted_by_raiding_holding }
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 3
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 4
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 5
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 6
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 7
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 8
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 9
				}
				modifier = {
					factor = 0.8
					num_of_artifacts = 10
				}
				modifier = {
					factor = 0.5
					NOT = {
						any_artifact = {
							quality == 1
						}
					}
				}
				modifier = {
					factor = 0.65
					NOT = {
						any_artifact = {
							quality == 2
						}
					}
				}
				modifier = {
					factor = 0.775
					NOT = {
						any_artifact = {
							quality == 3
						}
					}
				}
				modifier = {
					factor = 0.875
					NOT = {
						any_artifact = {
							quality == 4
						}
					}
				}
				modifier = {
					factor = 0.95
					NOT = {
						any_artifact = {
							quality == 5
						}
					}
				}
				modifier = {
					factor = 1.5 # if the item holder has a wonder with a vault of some kind
					any_realm_wonder_upgrade = {
						has_wonder_upgrade_flag = artifact_protection
						#wonder = { wonder_owner = ROOT }
					}
				}
				modifier = {
					factor = 0.5 # if the sieger was a warrior lodge member
					FROM = {
						OR={
							is_member_of_any_warband_trigger = yes
							is_member_of_any_warrior_lodge_trigger = yes
						}
						society_rank > 1 #Must be rank 2 or higher
					}
				}
				modifier = {
					factor = 0.5 # if the sieger has a reaver bloodline
					FROM = {
						any_owned_bloodline = {
							has_bloodline_flag = bloodline_reaver
						}
					}
				}
			}
		}
		FROM = {
			clr_character_flag = looted_by_raiding_holding
		}
	}
}

#Ransack enemy holding and find artifact, small item
character_event = {
	id = ARMS.9902
    desc = {
		text = EVTDESC_MNM_9902_A
		trigger = {
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9902_B
		trigger = {
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		FROM = {
			random_artifact = {
				limit = {
					quality == 1
					NOT = {
						artifact_type_owned_by = ROOT
					}
				}
				set_artifact_flag = looted_artifact_tooltip_1
				set_artifact_flag = looted_artifact_tooltip_2
				transfer_artifact = {
					from = PREV
					to = ROOT
				}
			}
			character_event = { id = ARMS.9903 }
		}
	}

	option = {
		name = {
			text = EVTOPTA_MNM_9902
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTB_MNM_9902
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		tooltip = {
			random_artifact = {
				show_scope_change = no
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				transfer_artifact = {
					from = FROM
					to = ROOT
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
		}
	}
}

#Someone ransacked my holding and stole my artifact, small item
character_event = {
	id = ARMS.9903
    desc = EVTDESC_MNM_9903
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_9903
		tooltip = {
			FROM = {
				random_artifact = {
					show_scope_change = no
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					transfer_artifact = {
						from = ROOT
						to = THIS
					}
				}
			}
		}
		hidden_effect = {
			FROM = {
				random_artifact = {
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					clr_artifact_flag = looted_artifact_tooltip_2
				}
			}
		}
	}
}

#Ransack enemy holding and find artifact, medium item
character_event = {
	id = ARMS.9904
    desc = {
		text = EVTDESC_MNM_9902_A
		trigger = {
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9902_B
		trigger = {
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		FROM = {
			random_artifact = {
				limit = {
					quality == 2
					NOT = {
						artifact_type_owned_by = ROOT
					}
				}
				set_artifact_flag = looted_artifact_tooltip_1
				set_artifact_flag = looted_artifact_tooltip_2
				transfer_artifact = {
					from = PREV
					to = ROOT
				}
			}
			character_event = { id = ARMS.9905 }
		}
	}

	option = {
		name = {
			text = EVTOPTA_MNM_9902
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTB_MNM_9902
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		tooltip = {
			random_artifact = {
				show_scope_change = no
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				transfer_artifact = {
					from = FROM
					to = ROOT
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
		}
	}
}

#Someone ransacked my holding and stole my artifact, medium item
character_event = {
	id = ARMS.9905
    desc = EVTDESC_MNM_9903
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_9903
		tooltip = {
			FROM = {
				show_scope_change = no
				random_artifact = {
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					transfer_artifact = {
						from = ROOT
						to = PREV
					}
				}
			}
		}
		hidden_effect = {
			FROM = {
				random_artifact = {
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					clr_artifact_flag = looted_artifact_tooltip_2
				}
			}
		}
	}
}

#Ransack enemy holding and find artifact, great item
character_event = {
	id = ARMS.9906
    desc = {
		text = EVTDESC_MNM_9906_A
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9906_B
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9906_C
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
	desc = {
		text = EVTDESC_MNM_9906_D
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		FROM = {
			random_artifact = {
				limit = {
					quality == 3
					NOT = {
						artifact_type_owned_by = ROOT
					}
				}
				set_artifact_flag = looted_artifact_tooltip_1
				set_artifact_flag = looted_artifact_tooltip_2
				transfer_artifact = {
					from = PREV
					to = ROOT
				}
			}
			if = {
				limit = {
					ROOT = {
						any_artifact = {
							has_artifact_flag = looted_artifact_tooltip_1
						}
					}
				}
				character_event = { id = ARMS.9907 }
			}
			if = {
				limit = {
					NOT = {
						ROOT = {
							any_artifact = {
								has_artifact_flag = looted_artifact_tooltip_1
							}
						}
					}
				}
				random_artifact = {
					limit = {
						quality == 3
					}
					set_artifact_flag = looted_artifact_tooltip_1
					set_artifact_flag = looted_artifact_tooltip_2
				}
				ROOT = {
					set_character_flag = looted_artifact_destroy_duplicate
				}
			}
		}
	}

	option = {
		name = {
			text = EVTOPTA_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTC_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
		}

		tooltip = {
			random_artifact = {
				show_scope_change = no
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				transfer_artifact = {
					from = FROM
					to = ROOT
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
		}
	}

	option = {
		name = {
			text = EVTOPTB_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTD_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
		}
		tooltip = {
			FROM = {
				random_artifact = {
					show_scope_change = no
					limit = {
						has_artifact_flag = looted_artifact_tooltip_1
					}
					destroy_artifact = yes
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
			FROM = {
				character_event = { id = ARMS.9907 }
			}
		}
	}
}

#Someone ransacked my holding and stole my artifact, great item
character_event = {
	id = ARMS.9907
    desc = {
		text = EVTDESC_MNM_9907_A
		trigger = {
			FROM = { NOT = { has_character_flag = looted_artifact_destroy_duplicate } }
		}
	}
	desc = {
		text = EVTDESC_MNM_9907_B
		trigger = {
			FROM = { has_character_flag = looted_artifact_destroy_duplicate }
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_9907
		trigger = {
			FROM  = { NOT = { has_character_flag = looted_artifact_destroy_duplicate } }
		}

		tooltip = {
			FROM = {
				random_artifact = {
					show_scope_change = no
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					transfer_artifact = {
						from = ROOT
						to = PREV
					}
				}
			}
		}
		hidden_effect = {
			FROM = {
				random_artifact = {
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					clr_artifact_flag = looted_artifact_tooltip_2
				}
			}
		}
	}

	option = {
		name = EVTOPTB_MNM_9907
		trigger = {
			FROM =  { has_character_flag = looted_artifact_destroy_duplicate }
		}

		random_artifact = {
			show_scope_change = no
			limit = {
				has_artifact_flag = looted_artifact_tooltip_2
			}
			clr_artifact_flag = looted_artifact_tooltip_2
			destroy_artifact = yes
		}
		FROM = {
			clr_character_flag = looted_artifact_destroy_duplicate
		}
	}
}

#Ransack enemy holding and find artifact, great+ item
character_event = {
	id = ARMS.9908
    desc = {
		text = EVTDESC_MNM_9906_A
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9906_B
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9906_C
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
	desc = {
		text = EVTDESC_MNM_9906_D
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		FROM = {
			random_artifact = {
				limit = {
					quality == 4
					NOT = {
						artifact_type_owned_by = ROOT
					}
				}
				set_artifact_flag = looted_artifact_tooltip_1
				set_artifact_flag = looted_artifact_tooltip_2
				transfer_artifact = {
					from = PREV
					to = ROOT
				}
			}
			if = {
				limit = {
					ROOT = {
						any_artifact = {
							has_artifact_flag = looted_artifact_tooltip_1
						}
					}
				}
				character_event = { id = ARMS.9909 }
			}
			if = {
				limit = {
					NOT = {
						ROOT = {
							any_artifact = {
								has_artifact_flag = looted_artifact_tooltip_1
							}
						}
					}
				}
				random_artifact = {
					limit = {
						quality == 4
					}
					set_artifact_flag = looted_artifact_tooltip_1
					set_artifact_flag = looted_artifact_tooltip_2
				}
				ROOT = {
					set_character_flag = looted_artifact_destroy_duplicate
				}
			}
		}
	}

	option = {
		name = {
			text = EVTOPTA_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTC_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
		}

		tooltip = {
			random_artifact = {
				show_scope_change = no
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				transfer_artifact = {
					from = FROM
					to = ROOT
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
		}
	}

	option = {
		name = {
			text = EVTOPTB_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTD_MNM_9906
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
		}
		tooltip = {
			FROM = {
				random_artifact = {
					show_scope_change = no
					limit = {
						has_artifact_flag = looted_artifact_tooltip_1
					}
					destroy_artifact = yes
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
			FROM = {
				character_event = { id = ARMS.9909 }
			}
		}
	}
}

#Someone ransacked my holding and stole my artifact, great+ item
character_event = {
	id = ARMS.9909
    desc = {
		text = EVTDESC_MNM_9907_A
		trigger = {
			FROM = { NOT = { has_character_flag = looted_artifact_destroy_duplicate } }
		}
	}
	desc = {
		text = EVTDESC_MNM_9907_B
		trigger = {
			FROM = { has_character_flag = looted_artifact_destroy_duplicate }
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_9907
		trigger = {
			FROM  = { NOT = { has_character_flag = looted_artifact_destroy_duplicate } }
		}

		tooltip = {
			FROM = {
				random_artifact = {
					show_scope_change = no
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					transfer_artifact = {
						from = ROOT
						to = THIS
					}
				}
			}
		}
		hidden_effect = {
			FROM = {
				random_artifact = {
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					clr_artifact_flag = looted_artifact_tooltip_2
				}
			}
		}
	}

	option = {
		name = EVTOPTB_MNM_9907
		trigger = {
			FROM =  { has_character_flag = looted_artifact_destroy_duplicate }
		}

		random_artifact = {
			show_scope_change = no
			limit = {
				has_artifact_flag = looted_artifact_tooltip_2
			}
			clr_artifact_flag = looted_artifact_tooltip_2
			destroy_artifact = yes
		}
		FROM = {
			clr_character_flag = looted_artifact_destroy_duplicate
		}
	}
}

#Ransack enemy holding and find artifact, amazing item
character_event = {
	id = ARMS.9910
    desc = {
		text = EVTDESC_MNM_9910_A
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9910_B
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
			looting_artifact_event_religious_artifacts_trigger = no
		}
	}
	desc = {
		text = EVTDESC_MNM_9910_C
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
	desc = {
		text = EVTDESC_MNM_9910_D
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
			looting_artifact_event_religious_artifacts_trigger = yes
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		FROM = {
			random_artifact = {
				limit = {
					quality == 5
					NOT = {
						artifact_type_owned_by = ROOT
					}
				}
				set_artifact_flag = looted_artifact_tooltip_1
				set_artifact_flag = looted_artifact_tooltip_2
				transfer_artifact = {
					from = PREV
					to = ROOT
				}
			}
			if = {
				limit = {
					ROOT = {
						any_artifact = {
							has_artifact_flag = looted_artifact_tooltip_1
						}
					}
				}
				character_event = { id = ARMS.9911 }
			}
			if = {
				limit = {
					NOT = {
						ROOT = {
							any_artifact = {
								has_artifact_flag = looted_artifact_tooltip_1
							}
						}
					}
				}
				random_artifact = {
					limit = {
						quality == 5
					}
					set_artifact_flag = looted_artifact_tooltip_1
					set_artifact_flag = looted_artifact_tooltip_2
				}
				ROOT = {
					set_character_flag = looted_artifact_destroy_duplicate
				}
			}
		}
	}

	option = {
		name = {
			text = EVTOPTA_MNM_9910
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTC_MNM_9910
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		trigger = {
			NOT = { has_character_flag = looted_artifact_destroy_duplicate }
		}

		tooltip = {
			random_artifact = {
				show_scope_change = no
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				transfer_artifact = {
					from = FROM
					to = ROOT
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
		}
	}

	option = {
		name = {
			text = EVTOPTB_MNM_9910
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = no
			}
		}
		name = {
			text = EVTOPTD_MNM_9910
			trigger = {
				looting_artifact_event_religious_artifacts_trigger = yes
			}
		}
		trigger = {
			has_character_flag = looted_artifact_destroy_duplicate
		}
		tooltip = {
			FROM = {
				random_artifact = {
					show_scope_change = no
					limit = {
						has_artifact_flag = looted_artifact_tooltip_1
					}
					destroy_artifact = yes
				}
			}
		}
		hidden_effect = {
			random_artifact = {
				limit = {
					has_artifact_flag = looted_artifact_tooltip_1
				}
				clr_artifact_flag = looted_artifact_tooltip_1
			}
			FROM = {
				character_event = { id = ARMS.9911 }
			}
		}
	}
}

#Someone ransacked my holding and stole my artifact, amazing item
character_event = {
	id = ARMS.9911
    desc = {
		text = EVTDESC_MNM_9911_A
		trigger = {
			FROM = { NOT = { has_character_flag = looted_artifact_destroy_duplicate } }
		}
	}
	desc = {
		text = EVTDESC_MNM_9911_B
		trigger = {
			FROM = { has_character_flag = looted_artifact_destroy_duplicate }
		}
	}
    picture = GFX_evt_relic_box
    border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_9911
		trigger = {
			FROM  = { NOT = { has_character_flag = looted_artifact_destroy_duplicate } }
		}

		tooltip = {
			FROM = {
				random_artifact = {
					show_scope_change = no
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					transfer_artifact = {
						from = ROOT
						to = THIS
					}
				}
			}
		}
		hidden_effect = {
			FROM = {
				random_artifact = {
					limit = {
						has_artifact_flag = looted_artifact_tooltip_2
					}
					clr_artifact_flag = looted_artifact_tooltip_2
				}
			}
		}
	}

	option = {
		name = EVTOPTB_MNM_9911
		trigger = {
			FROM =  { has_character_flag = looted_artifact_destroy_duplicate }
		}

		random_artifact = {
			show_scope_change = no
			limit = {
				has_artifact_flag = looted_artifact_tooltip_2
			}
			clr_artifact_flag = looted_artifact_tooltip_2
			destroy_artifact = yes
		}
		FROM = {
			clr_character_flag = looted_artifact_destroy_duplicate
		}
	}
}
