namespace = bretonnia
###Have Gifts of the Lady on page 39
###on_startup###
character_event = {
	id = bretonnia.1
	hide_window = yes
	is_triggered_only = yes
	only_playable = yes
	only_men = yes
	trigger = {
		controls_religion = no
		religion = grail
		is_bretonnian = yes
		is_adult = yes
		is_in_society = no
		higher_real_tier_than = baron
		NOT = {
			dynasty = none
		}
		age = 16
		is_female = no
		location = {
			region = world_old_world_bretonnia
		}
	}
	immediate = {
		join_society = knights_of_bretonnia
	}
}

character_event = {
	id = bretonnia.2
	hide_window = yes
	is_triggered_only = yes
	religion = grail
	trigger = {
		is_member_of_bretonnia_trigger = yes
		society_rank == 2
	}
	immediate = {
		add_character_modifier = {
			name = virtue_chivalry
			duration = -1
		}
	}
}

character_event = {
	id = bretonnia.3
	hide_window = yes
	is_triggered_only = yes
	religion = grail
	trigger = {
		is_member_of_bretonnia_trigger = yes
		society_rank == 3
	}
	immediate = {
		add_character_modifier = {
			name = virtue_chivalry
			duration = -1
		}
		add_character_modifier = {
			name = virtue_quest
			duration = -1
		}
		set_character_flag = virtue_quest
	}
}

character_event = {
	id = bretonnia.4
	hide_window = yes
	is_triggered_only = yes
	religion = grail
	trigger = {
		is_member_of_bretonnia_trigger = yes
		society_rank == 4
	}
	immediate = {
		add_character_modifier = {
			name = virtue_chivalry
			duration = -1
		}
	}
}

character_event = {
	id = bretonnia.5
	hide_window = yes
	religion = grail
	is_triggered_only = yes
	immediate = {
		if = {
			limit = {
				is_bretonnian = yes
				trait = peasant_leader
				has_class_trait = no
			}
			add_trait = peasant
		}
		else_if = {
			limit = {
				is_bretonnian = yes
				is_theocracy = yes
			}
			add_trait = clergy
		}
		else_if = {
			limit = {
				is_bretonnian = yes
				dynasty = none
				has_class_trait = no
			}
			add_trait = peasant
		}
		else_if = {
			limit = {
				is_bretonnian = yes
				is_feudal = yes
				has_class_trait = no
			}
			add_trait = noble
		}
		else_if = {
			limit = {
				is_bretonnian = yes
				is_republic = yes
				has_class_trait = no
			}
			add_trait = peasant
		}
		else_if = {
			limit = {
				is_bretonnian = yes
				is_landed = no
				has_class_trait = no
			}
			add_trait = peasant
		}
	}
}

character_event = {
	id = bretonnia.6
	hide_window = yes
	only_playable = yes
	war = yes
	is_triggered_only = yes
	trigger = {
		has_landed_title = e_bretonnia
		is_primary_war_defender = yes
		religion = grail
		NOT = {
			has_character_flag = green_knight_help
		}
	}
	immediate = {
		set_character_flag = green_knight_help
		create_random_soldier = {
			name = "The Green Knight"
			random_traits = yes
			dynasty = none
			religion = grail
			culture = old_breton
			female = no
			age = 30
		}
		new_character = {
			change_martial = 20
			add_trait = noble
			add_trait = green_knight
			add_trait = brave
			add_trait = holy_warrior
			set_character_flag = green_knight
			add_artifact = dolorous_blade
			add_artifact = shadow_steed
			unsafe_give_minor_title = title_commander
			character_event = {
				id = bretonnia.7
				months = 6
				random = 6
			}
		}
	}
}

character_event = {
	id = bretonnia.7
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		has_character_flag = green_knight
	}
	immediate = {
		death = {
			death_reason = death_vanished
		}
		unsafe_destroy_artifact = dolorous_blade
		unsafe_destroy_artifact = shadow_steed
		clr_character_flag = green_knight
		liege = {
			unsafe_destroy_artifact = dolorous_blade
			unsafe_destroy_artifact = shadow_steed
			clr_character_flag = green_knight_help
		}
	}
}

character_event = {
	id = bretonnia.8
	hide_window = yes
	only_playable = yes
	only_independent = yes
	is_triggered_only = yes
	trigger = {
		has_landed_title = e_bretonnia
		NOT = {
			society_rank == 4
			is_member_of_bretonnia_trigger = yes
		}
	}
	immediate = {
		if = {
			limit = {
				society_rank == 1
				is_member_of_bretonnia_trigger = yes
			}
			society_rank_up = 3
			character_event = {
				id = bretonnia.9
			}
		}
		else_if = {
			limit = {
				society_rank == 2
				is_member_of_bretonnia_trigger = yes
			}
			society_rank_up = 2
			character_event = {
				id = bretonnia.9
			}
		}
		else_if = {
			limit = {
				society_rank == 3
				is_member_of_bretonnia_trigger = yes
			}
			society_rank_up = 1
			character_event = {
				id = bretonnia.9
			}
		}
		else = {
			abdicate = yes
		}
	}
}

character_event = {
	id = bretonnia.9
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		has_landed_title = e_bretonnia
		NOT = {
			has_artifact = bretonnia_crown
		}
	}
	immediate = {
		add_artifact = bretonnia_crown
	}
}

character_event = {
	id = bretonnia.10
	hide_window = yes
	religion = grail
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_landed_title = e_bretonnia
		}
		has_artifact = bretonnia_crown
	}
	immediate = {
		unsafe_destroy_artifact = bretonnia_crown
	}
}

character_event = {
	id = bretonnia.11
	hide_window = yes
	is_triggered_only = yes
	religion = grail
	trigger = {
		is_member_of_bretonnia_trigger = yes
	}
	immediate = {
		if = {
			limit = {
				society_rank == 1
			}
			add_trait = bretonnian_knight_errant
		}
		if = {
			limit = {
				society_rank == 2
			}
			add_trait = bretonnian_knight
		}
		if = {
			limit = {
				society_rank == 3
			}
			add_trait = bretonnian_knight
		}
		if = {
			limit = {
				society_rank == 4
			}
			add_trait = grail_knight
		}
	}
}

###Virtues of Bretonnia###
#Power: Virtue of Chivalry
character_event = {
	id = bretonnia.100
	desc = EVTDESC_bretonnia_100
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_100
		add_character_modifier = {
			name = virtue_chivalry
			duration = -1
		}
		clr_character_flag = getting_chivalry_virtue
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = EVTOPTB_bretonnia_100
		clr_character_flag = getting_chivalry_virtue
		add_society_currency_minor_effect = yes
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of Knighthood Part 1
character_event = {
	id = bretonnia.101
	desc = EVTDESC_bretonnia_101
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		# Virtue of Audacity
		name = EVTOPTA_bretonnia_101
		add_character_modifier = {
			name = virtue_audacity
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		# Virtue of Confidence
		name = EVTOPTB_bretonnia_101
		add_character_modifier = {
			name = virtue_confidence
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Next
		name = EVTOPTC_bretonnia_101
		hidden_tooltip = {
			character_event = {
				id = bretonnia.102
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Close
		name = EVTOPTD_bretonnia_101
		clr_character_flag = getting_virtue_knighthood
		add_society_currency_major_effect = yes
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of Knighthood Part 2
character_event = {
	id = bretonnia.102
	desc = EVTDESC_bretonnia_102
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		# Virtue of Discipline
		name = EVTOPTA_bretonnia_102
		add_character_modifier = {
			name = virtue_discipline
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		# Virtue of Duty
		name = EVTOPTB_bretonnia_102
		add_character_modifier = {
			name = virtue_duty
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Next
		name = EVTOPTC_bretonnia_102
		hidden_tooltip = {
			character_event = {
				id = bretonnia.103
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Back
		name = EVTOPTD_bretonnia_102
		hidden_tooltip = {
			character_event = {
				id = bretonnia.101
			}
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of Knighthood Part 3
character_event = {
	id = bretonnia.103
	desc = EVTDESC_bretonnia_103
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		# Virtue of Empathy
		name = EVTOPTA_bretonnia_103
		add_character_modifier = {
			name = virtue_empathy
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		# Virtue of Heroism
		name = EVTOPTB_bretonnia_103
		add_character_modifier = {
			name = virtue_heroism
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Next
		name = EVTOPTC_bretonnia_103
		hidden_tooltip = {
			character_event = {
				id = bretonnia.104
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Back
		name = EVTOPTD_bretonnia_103
		hidden_tooltip = {
			character_event = {
				id = bretonnia.104
			}
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of Knighthood Part 4
character_event = {
	id = bretonnia.104
	desc = EVTDESC_bretonnia_104
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		# Virtue of the Ideal
		name = EVTOPTA_bretonnia_104
		add_character_modifier = {
			name = virtue_ideal
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		# Virtue of the Impetuous Knight
		name = EVTOPTB_bretonnia_104
		add_character_modifier = {
			name = virtue_impetuous_knight
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Next
		name = EVTOPTC_bretonnia_104
		hidden_tooltip = {
			character_event = {
				id = bretonnia.105
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Back
		name = EVTOPTD_bretonnia_104
		hidden_tooltip = {
			character_event = {
				id = bretonnia.103
			}
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of Knighthood Part 5
character_event = {
	id = bretonnia.105
	desc = EVTDESC_bretonnia_105
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		# Virtue of the Joust
		name = EVTOPTA_bretonnia_105
		add_character_modifier = {
			name = virtue_joust
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		# Virtue of Knightly Temper
		name = EVTOPTB_bretonnia_105
		add_character_modifier = {
			name = virtue_knightly_temper
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Next
		name = EVTOPTC_bretonnia_105
		hidden_tooltip = {
			character_event = {
				id = bretonnia.106
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Back
		name = EVTOPTD_bretonnia_105
		hidden_tooltip = {
			character_event = {
				id = bretonnia.104
			}
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of Knighthood Part 6
character_event = {
	id = bretonnia.106
	desc = EVTDESC_bretonnia_106
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		# Virtue of Noble Disdain
		name = EVTOPTA_bretonnia_106
		add_character_modifier = {
			name = virtue_noble_disdain
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		# Virtue of the Penitent
		name = EVTOPTB_bretonnia_106
		add_character_modifier = {
			name = virtue_penitent
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Next
		name = EVTOPTC_bretonnia_106
		hidden_tooltip = {
			character_event = {
				id = bretonnia.107
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Back
		name = EVTOPTD_bretonnia_106
		hidden_tooltip = {
			character_event = {
				id = bretonnia.105
			}
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of Knighthood Part 7
character_event = {
	id = bretonnia.107
	desc = EVTDESC_bretonnia_107
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		# Virtue of Purity
		name = EVTOPTA_bretonnia_107
		add_character_modifier = {
			name = virtue_purity
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		# Virtue of Stoicism
		name = EVTOPTB_bretonnia_107
		add_character_modifier = {
			name = virtue_stoicism
			duration = -1
		}
		clr_character_flag = getting_virtue_knighthood
		ai_chance = {
			factor = 1
		}
	}
	option = {
		#Next
		name = EVTOPTC_bretonnia_107
		hidden_tooltip = {
			character_event = {
				id = bretonnia.101
			}
		}
		ai_chance = {
			factor = 0
		}
	}
	option = {
		#Back
		name = EVTOPTD_bretonnia_107
		hidden_tooltip = {
			character_event = {
				id = bretonnia.106
			}
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Virtue of the Quest
character_event = {
	id = bretonnia.108
	desc = EVTDESC_bretonnia_108
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_108
		add_character_modifier = {
			name = virtue_quest
			duration = -1
		}
		set_character_flag = virtue_quest
		clr_character_flag = getting_virtue_quest
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = EVTOPTB_bretonnia_108
		clr_character_flag = getting_virtue_quest
		add_society_currency_minor_effect = yes
		ai_chance = {
			factor = 0
		}
	}
}

#Power: Grail Virtue
character_event = {
	id = bretonnia.109
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	desc = {
		trigger = {
			has_character_modifier = virtue_audacity
		}
		text = EVTDESC_bretonnia_109_virtue_audacity
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_confidence
		}
		text = EVTDESC_bretonnia_109_virtue_confidence
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_discipline
		}
		text = EVTDESC_bretonnia_109_virtue_discipline
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_duty
		}
		text = EVTDESC_bretonnia_109_virtue_duty
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_empathy
		}
		text = EVTDESC_bretonnia_109_virtue_empathy
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_heroism
		}
		text = EVTDESC_bretonnia_109_virtue_heroism
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_ideal
		}
		text = EVTDESC_bretonnia_109_virtue_ideal
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_impetuous_knight
		}
		text = EVTDESC_bretonnia_109_virtue_impetuous_knight
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_joust
		}
		text = EVTDESC_bretonnia_109_virtue_joust
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_knightly_temper
		}
		text = EVTDESC_bretonnia_109_virtue_knightly_temper
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_noble_disdain
		}
		text = EVTDESC_bretonnia_109_virtue_noble_disdain
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_penitent
		}
		text = EVTDESC_bretonnia_109_virtue_penitent
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_purity
		}
		text = EVTDESC_bretonnia_109_virtue_purity
	}
	desc = {
		trigger = {
			has_character_modifier = virtue_stoicism
		}
		text = EVTDESC_bretonnia_109_virtue_stoicism
	}
	option = {
		name = EVTOPTA_bretonnia_109
		add_virtue_grail = yes
		clr_character_flag = getting_virtue_grail
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = EVTOPTB_bretonnia_109
		clr_character_flag = getting_virtue_grail
		add_society_currency_large_effect = yes
		ai_chance = {
			factor = 0
		}
	}
}

###Society###
#Ask to join society
character_event = {
	id = bretonnia.200
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		FROM = {
			leader = {
				society_member_of = knights_of_bretonnia
			}
		}
	}
	immediate = {
		FROM = {
			leader = {
				character_event = {
					id = bretonnia.201
				}
			}
		}
	}
}

#Ping event
character_event = {
	id = bretonnia.201
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		FROM = {
			character_event = {
				id = bretonnia.202
			}
		}
	}
}

#Joined
character_event = {
	id = bretonnia.202
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		join_society = knights_of_bretonnia
		add_trait = bretonnian_knight_errant
	}
}

#Rank Up
character_event = {
	id = bretonnia.203
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	trigger = {
		is_member_of_bretonnia_trigger = yes
	}
	desc = {
		trigger = {
			society_rank == 1
		}
		text = EVTDESCA_bretonnia_203
	}
	desc = {
		trigger = {
			society_rank == 2
		}
		text = EVTDESCB_bretonnia_203
	}
	option = {
		trigger = {
			society_rank == 1
		}
		name = EVTOPTA_bretonnia_203
		society_rank_up = 1
		clr_character_flag = has_sent_request_to_rank_up
		remove_trait = bretonnian_knight_errant
		add_trait = bretonnian_knight
	}
	option = {
		trigger = {
			society_rank == 2
		}
		name = EVTOPTB_bretonnia_203
		society_rank_up = 1
		clr_character_flag = has_sent_request_to_rank_up
		set_character_flag = virtue_quest
		add_character_modifier = {
			name = virtue_quest
			duration = -1
		}
	}
}

#Giving up on the Quest
character_event = {
	id = bretonnia.204
	desc = EVTDESC_bretonnia_204
	picture = GFX_evt_bretonnians
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_204
		remove_character_modifier = virtue_quest
		clr_character_flag = give_up_on_quest
		ai_chance = {
			factor = 0
		}
	}
	option = {
		name = EVTOPTB_bretonnia_204
		clr_character_flag = give_up_on_quest
		ai_chance = {
			factor = 1
		}
	}
}

character_event = {
	#force the AI to join a society
	id = bretonnia.205
	hide_window = yes
	is_triggered_only = yes
	religion = grail
	min_age = 16
	only_men = yes
	only_capable = yes
	prisoner = no
	immediate = {
		if = {
			#force the joining event on AI
			limit = {
				ai = yes
				NOT = {
					dynasty = none
				}
				prisoner = no
				NOT = {
					trait = incapable
				}
				is_adult = yes
				is_in_society = no
				controls_religion = no
			}
			character_event = {
				id = bretonnia.206
			}
		}
	}
}

character_event = {
	#AI join event
	id = bretonnia.206
	hide_window = yes
	trigger = {
		can_join_society = knights_of_bretonnia
	}
	is_triggered_only = yes
	immediate = {
		join_society = knights_of_bretonnia
		add_trait = bretonnian_knight_errant
	}
}

#AI forcce to rank up
character_event = {
	id = bretonnia.207
	is_triggered_only = yes
	religion = grail
	only_capable = yes
	hide_window = yes
	trigger = {
		is_member_of_bretonnia_trigger = yes
		OR = {
			society_rank == 1
			society_rank == 2
			society_rank == 3
		}
		ai = yes
	}
	immediate = {
		random_list = {
			50 = {
			}
			50 = {
				if = {
					limit = {
						society_rank == 1
						prisoner = no
						NOT = {
							trait = incapable
						}
						is_adult = yes
						ai = yes
					}
					society_rank_up = 1
					clr_character_flag = has_sent_request_to_rank_up
					remove_trait = bretonnian_knight_errant
					add_trait = bretonnian_knight
				}
				else_if = {
					limit = {
						society_rank == 2
						prisoner = no
						NOT = {
							trait = incapable
						}
						is_adult = yes
						ai = yes
					}
					society_rank_up = 1
					clr_character_flag = has_sent_request_to_rank_up
					set_character_flag = virtue_quest
					add_character_modifier = {
						name = virtue_quest
						duration = -1
					}
				}
				else_if = {
					limit = {
						society_rank == 3
						prisoner = no
						NOT = {
							trait = incapable
						}
						is_adult = yes
						ai = yes
					}
					society_rank_up = 1
					clr_character_flag = has_sent_request_to_rank_up
					clr_character_flag = defeated_green_knight
					remove_character_modifier = virtue_quest
					remove_trait = bretonnian_knight
					add_trait = grail_knight
				}
			}
		}
	}
}

###Questing Setup###
character_event = {
	id = bretonnia.300
	hide_window = yes
	religion = grail
	is_triggered_only = yes
	is_in_society = yes
	only_capable = yes
	trigger = {
		is_member_of_bretonnia_trigger = yes
		has_any_quest = no
		NOT = {
			has_character_modifier = quest_cooldown_timer
		}
		NOT = {
			is_inaccessible_trigger = yes
		}
		prisoner = no
		society = {
			any_society_member = {
				NOT = {
					character = ROOT
				}
				prisoner = no
				is_within_diplo_range = ROOT
				opinion = {
					who = ROOT
					value = 0
				}
			}
		}
	}
	immediate = {
		#Picks out mission giver
		random_list = {
			20 = {
				#International Knights
				society = {
					random_society_member = {
						limit = {
							NOT = {
								character = ROOT
							}
							prisoner = no
							is_within_diplo_range = ROOT
							opinion = {
								who = ROOT
								value = 0
							}
						}
						save_event_target_as = event_questgiver
					}
				}
			}
			40 = {
				#Realm Knights
				trigger = {
					society = {
						any_society_member = {
							NOT = {
								character = ROOT
							}
							prisoner = no
							is_within_diplo_range = ROOT
							opinion = {
								who = ROOT
								value = 0
							}
							same_realm = ROOT
						}
					}
				}
				society = {
					random_society_member = {
						limit = {
							NOT = {
								character = ROOT
							}
							prisoner = no
							is_within_diplo_range = ROOT
							opinion = {
								who = ROOT
								value = 0
							}
							same_realm = ROOT
						}
						save_event_target_as = event_questgiver
					}
				}
			}
		}
		random_list = {
			20 = {
				trigger = {
					ai = no
				}
				event_target:event_questgiver = {
					character_event = {
						id = bretonnia.301
					}					#Troll Rumors
				}
			}
			20 = {
				trigger = {
					ai = no
				}
				event_target:event_questgiver = {
					character_event = {
						id = bretonnia.302
					}					#Orc Rumors
				}
			}
			10 = {
				trigger = {
					ai = no
				}
				event_target:event_questgiver = {
					character_event = {
						id = bretonnia.303
					}					#Attacked by Dark Elf Raiders
				}
			}
			20 = {
				trigger = {
					ai = no
				}
				event_target:event_questgiver = {
					character_event = {
						id = bretonnia.304
					}					#The Village
				}
			}
			30 = {
				trigger = {
					ai = no
				}
				event_target:event_questgiver = {
					character_event = {
						id = bretonnia.305
					}					#Give money to the Lady's OnlyFans
				}
			}
			100 = {
				# AI bypasses missions at times
				trigger = {
					ai = yes
				}
				random_list = {
					70 = {
						modifier = {
							factor = 0.9
							society_influence >= 30
						}
						modifier = {
							factor = 0.9
							society_influence >= 40
						}
						modifier = {
							factor = 0.8
							society_influence >= 50
						}
						modifier = {
							factor = 0.7
							society_influence >= 70
						}
						modifier = {
							factor = 0.6
							society_influence >= 80
						}
						modifier = {
							factor = 0.5
							society_influence >= 90
						}
						add_mission_succeed_influence_effect = yes
					}
					30 = {
						add_mission_fail_influence_effect = yes
					}
				}
			}
		}
	}
}

#Troll Rumors
character_event = {
	id = bretonnia.301
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		FROM = {
			character_event = {
				id = bretonnia.400
				days = 7
				random = 7
			}
		}
	}
}

#Orc Rumors
character_event = {
	id = bretonnia.302
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		FROM = {
			character_event = {
				id = bretonnia.404
				days = 7
				random = 7
			}
		}
	}
}

#Attacked by Dark Elf Raiders
character_event = {
	id = bretonnia.303
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		FROM = {
			character_event = {
				id = bretonnia.408
				days = 7
				random = 7
			}
		}
	}
}

#The Village
character_event = {
	id = bretonnia.304
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		FROM = {
			character_event = {
				id = bretonnia.414
				days = 7
				random = 7
			}
		}
	}
}

#Give money to the Lady's OnlyFans
character_event = {
	id = bretonnia.305
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		FROM = {
			character_event = {
				id = bretonnia.417
				days = 7
				random = 7
			}
		}
	}
}

###Questing###
#Troll Rumors
character_event = {
	id = bretonnia.400
	desc = EVTDESCBRETONNIA.6	# While visiting a tavern, you hear stories of a nearby cave rumored to be a troll's lair. Do you want to investigate?
	picture = "GFX_evt_feast"
	is_triggered_only = yes
	option = {
		name = SQUIRE_SADDLE_MY_HORSE
		set_quest = quest_troll_rumors
		character_event = {
			id = bretonnia.401
		}
	}
	option = {
		name = EVTOPTBRETONNIA.6.b		# No, I seek greater glories than mere trolls!
		custom_tooltip = {
			text = decline_quest_tooltip
		}
		add_character_modifier = {
			#will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Troll Lair
character_event = {
	id = bretonnia.401
	desc = EVTDESCBRETONNIA.7	# After a week of searching, you finally come upon some troll tracks which lead to a dark cave. Preparing yourself as best as you are able, you light some torches and prepare to destroy this threat to the local community.
	picture = "GFX_evt_bandits"
	is_triggered_only = yes
	option = {
		name = FORWARD_INTO_THE_DARKNESS
		if = {
			limit = {
				NOT = {
					martial = 10
				}
			}
			hidden_tooltip = {
				random_list = {
					75 = {
						character_event = {
							id = bretonnia.403
						}
					}
					25 = {
						long_character_event = {
							id = bretonnia.402
						}
					}
				}
			}
		}
		if = {
			limit = {
				martial = 10
			}
			long_character_event = {
				id = bretonnia.402
			}
		}
	}
	option = {
		name = EVTOPTBRETONNIA.7.b		# No, wait... what if there is a dragon over there instead?
		trigger = {
			ai = no
		}
		prestige = -50
		add_society_modifier = {
			modifier = failed_mission
			years = 10
		}
		clr_quest = quest_troll_rumors
		add_character_modifier = {
			#will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Trolls Success
long_character_event = {
	id = bretonnia.402
	desc = EVTDESCBRETONNIA.8	# You march into troll the lair, and though they are strong opponents, they are no match for your superior knightly skill and tactics. After slaying half a dozen of them, you find some treasure and quickly claim it.
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.8.a		# I dedicate this victory to the Lady!
		wealth = 10
		random = {
			chance = 5
			add_trait = wounded
		}
		if = {
			limit = {
				NOT = {
					martial = 10
				}
			}
			random = {
				chance = 20
				change_martial = 1
			}
		}
		clr_quest = quest_troll_rumors
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_major_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Trolls Defeat
character_event = {
	id = bretonnia.403
	desc = EVTDESCBRETONNIA.9	# You march into troll the lair, and quickly find yourself in trouble. Six trolls come at you all at once, and you are hard pressed to make it back to the exit alive!
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.9.a		# Men, advance in the other direction - quickly!
		random_list = {
			60 = {
			}
			25 = {
				add_trait = wounded
			}
			10 = {
				add_trait = maimed
			}
			5 = {
				if = {
					limit = {
						is_invincible_trigger = yes
					}
					antideath_effect = yes
					break = yes
				}
				death = {
					death_reason = death_battle
				}
			}
		}
		clr_quest = quest_troll_rumors
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_medium_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Orc Rumors
character_event = {
	id = bretonnia.404
	desc = EVTDESCBRETONNIA.10	# You hear rumors that an orc band is raiding this area. Do you want to investigate?
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = CHAAARGE
		set_quest = quest_orc_rumors
		character_event = {
			id = bretonnia.405
		}
	}
	option = {
		name = EVTOPTBRETONNIA.10.b		# No, a mere orc band is an unworthy foes!
		custom_tooltip = {
			text = decline_quest_tooltip
		}
		add_character_modifier = {
			#will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Orc warband
character_event = {
	id = bretonnia.405
	desc = EVTDESCBRETONNIA.11	# After some hard riding you quickly catch up to the orcs. There's about three dozen of them, and you are but a handful.
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.11.a		# I hope there's enough for all of us!
		hidden_tooltip = {
			if = {
				limit = {
					NOT = {
						martial = 15
					}
				}
				random_list = {
					75 = {
						character_event = {
							id = bretonnia.407
						}
					}
					25 = {
						long_character_event = {
							id = bretonnia.406
						}
					}
				}
			}
			if = {
				limit = {
					martial = 15
				}
				long_character_event = {
					id = bretonnia.406
				}
			}
		}
	}
	option = {
		name = EVTOPTBRETONNIA.11.b		# No, wait. I think I see a giant over there, this way men!
		trigger = {
			ai = no
		}
		prestige = -50
		add_society_modifier = {
			modifier = failed_mission
			years = 10
		}
		clr_quest = quest_orc_rumors
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Orcs Success
long_character_event = {
	id = bretonnia.406
	desc = EVTDESCBRETONNIA.12	# You charge into the orcs, and with lance and sword, you drive a deep wedge into their hastily formed ranks. It is a glorious slaughter, and they will now know the folly of raiding in these lands!
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.12.a		# The Lady granted me my strength!
		wealth = 5
		prestige = 50
		random = {
			chance = 5
			add_trait = wounded
		}
		if = {
			limit = {
				NOT = {
					martial = 15
				}
			}
			random = {
				chance = 25
				change_martial = 1
			}
		}
		clr_quest = quest_orc_rumors
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_major_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Orcs Failure
character_event = {
	id = bretonnia.407
	desc = EVTDESCBRETONNIA.13	# As soon as you charge the orcs, they spot you and form ranks. Some of them have great pikes, and as your charge is broken, you suddenly find yourself being attacked from all directions!
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.13.a		# Men, advance backwards! Double quick!
		random_list = {
			55 = {
			}
			35 = {
				add_trait = wounded
			}
			5 = {
				add_trait = maimed
			}
			5 = {
				if = {
					limit = {
						is_invincible_trigger = yes
					}
					antideath_effect = yes
					break = yes
				}
				death = {
					death_reason = death_battle
				}
			}
		}
		add_society_modifier = {
			modifier = failed_mission
			years = 10
		}
		clr_quest = quest_orc_rumors
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Attacked by Dark Elf Raiders
character_event = {
	id = bretonnia.408
	desc = EVTDESCBRETONNIA.14	# As you travel along the sea-line you suddenly see a sleek black ship moored just off the coast. Along the beach, there is a dark elf raiding party, and they have several humans tied together as slaves, ready for transport.
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = FOR_THE_LADY
		set_quest = quest_dark_elf_raiders
		if = {
			limit = {
				NOT = {
					martial = 15
				}
			}
			hidden_tooltip = {
				random_list = {
					80 = {
						character_event = {
							id = bretonnia.409
						}
					}
					20 = {
						character_event = {
							id = bretonnia.410
						}
					}
				}
			}
		}
		if = {
			limit = {
				martial = 15
			}
			character_event = {
				id = bretonnia.409
			}
		}
	}
	option = {
		name = EVTOPTB_bretonnia_406
		custom_tooltip = {
			text = decline_quest_tooltip
		}
		add_character_modifier = {
			#will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Charge vs Dark Elves Success
character_event = {
	id = bretonnia.409
	desc = EVTDESCBRETONNIA.15	# Your mighty charge takes the dark elves completely by surprise, and rather than form a line and seek to repel you, they make a mad dash for their ships. You slay several of them, and free the captives.
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = BACK_TO_YOUR_FARMS_PEASANTS
		wealth = 5
		random = {
			chance = 5
			add_trait = wounded
		}
		if = {
			limit = {
				NOT = {
					martial = 20
				}
			}
			random = {
				chance = 25
				change_martial = 1
			}
		}
		clr_quest = quest_dark_elf_raiders
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_major_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Dark Elves Defeat Charge
character_event = {
	id = bretonnia.410
	desc = EVTDESCBRETONNIA.16	# The dark elves saw you coming from afar, and quickly form ranks. They have a sorceress with them, and suddenly the air around you explodes with thunder and you are thrown from your horse!
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.16.a		# Arghh, men *cough* advance... backwards!
		wealth = -20
		prestige = -50
		random_list = {
			45 = {
			}
			25 = {
				add_trait = wounded
			}
			10 = {
				add_trait = maimed
			}
			20 = {
				if = {
					limit = {
						is_invincible_trigger = yes
					}
					antideath_effect = yes
					break = yes
				}
				death = {
					death_reason = death_battle
				}
			}
		}
		add_society_modifier = {
			modifier = failed_mission
			years = 10
		}
		clr_quest = quest_dark_elf_raiders
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
	option = {
		name = EVTOPTBRETONNIA.16.b		# A true knight never runs from danger!
		trigger = {
			ai = no
		}
		character_event = {
			id = bretonnia.411
		}
	}
}

#Dark Elf Desperate Charge
character_event = {
	id = bretonnia.411
	desc = EVTDESCBRETONNIA.17	# You get back up on your horse, right your lance, spit the blood from your mouth and with a great battle cry you charge the foul sorceress and her cohorts!
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.17.a		# Forwards! To victory! For the Lady!
		hidden_tooltip = {
			random_list = {
				50 = {
					character_event = {
						id = bretonnia.412
					}
				}
				50 = {
					character_event = {
						id = bretonnia.413
					}
				}
			}
		}
	}
}

#Dark Elf Charge, Success
character_event = {
	id = bretonnia.412
	desc = EVTDESCBRETONNIA.18	# The Sorceress casts another spell at you, but as her lightning bolt fails to stop you, she turns and runs and the rest follow. You slaughter many of them, and free the captives.
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = BACK_TO_THE_FARMS_PEASANTS
		wealth = 5
		prestige = 25
		random_list = {
			50 = {
				add_trait = wounded
			}
			50 = {
			}
		}
		if = {
			limit = {
				NOT = {
					martial = 25
				}
			}
			random = {
				chance = 25
				change_martial = 1
			}
		}
		clr_quest = quest_dark_elf_raiders
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_major_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Dark Elf Charge, Failure
character_event = {
	id = bretonnia.413
	desc = EVTDESCBRETONNIA.19	# You rush dark elves, but the sorceress casts another spell at you. Lightning flares around you and you are in excruciating pain as you are one more blasted from your horse. This battle is over!
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = MEN_GET_ME_OUT_OF_HERE
		wealth = -20
		random_list = {
			30 = {
				add_trait = wounded
				random_playable_ruler = {
					limit = {
						culture_group = druchii_group
						is_landed = yes
						OR = {
							tier = DUKE
							tier = KING
							tier = EMPEROR
						}
					}
					character_event = {
						id = darkelf.5
					}					##INTEGRATE
				}
			}
			55 = {
				add_trait = maimed
				random_playable_ruler = {
					limit = {
						culture_group = druchii_group
						is_landed = yes
						OR = {
							tier = DUKE
							tier = KING
							tier = EMPEROR
						}
					}
					character_event = {
						id = darkelf.5
					}					##INTEGRATE
				}
			}
			15 = {
				if = {
					limit = {
						is_invincible_trigger = yes
					}
					antideath_effect = yes
					break = yes
				}
				death = {
					death_reason = death_battle
				}
			}
		}
		add_society_modifier = {
			modifier = failed_mission
			years = 10
		}
		clr_quest = quest_dark_elf_raiders
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#The Village - Begs for help
character_event = {
	id = bretonnia.414
	desc = EVTDESC_bretonnia_414
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_414
		set_quest = quest_the_village
		character_event = {
			id = bretonnia.415
			days = 5
		}
	}
	option = {
		name = EVTOPTB_bretonnia_414
		custom_tooltip = {
			text = decline_quest_tooltip
		}
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		ai_chance = {
			factor = 0
		}
	}
}

#The Village - Defend against Beastmen
character_event = {
	id = bretonnia.415
	desc = EVTDESC_bretonnia_415
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_415
		save_event_target_as = combatant_1
		set_character_flag = duel
		set_character_flag = flag_duel_no_draws
		set_character_flag = deadly_duel@event_target:combatant_2
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = chaos
			culture = beastman_main
			female = no
			age = 30
		}
		new_character = {
			save_event_target_as = combatant_2
			set_character_flag = flag_duel_no_draws
			add_trait = brave
			character_event = {
				id = bretonnia.505
				days = 30
			}
			character_event = {
				id = HFP.10095
				days = 1
			}
		}
		character_event = {
			id = bretonnia.416
			days = 30
			random = 5
		}
	}
}

#The Village - Celebration
character_event = {
	id = bretonnia.416
	desc = EVTDESC_bretonnia_416
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_416
		clr_quest = quest_the_village
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_large_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		add_trait = lustful
	}
	option = {
		name = EVTOPTB_bretonnia_416
		clr_quest = quest_the_village
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_large_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
	option = {
		name = EVTOPTC_bretonnia_416
		clr_quest = quest_the_village
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_large_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		add_trait = zealous
	}
}

#Give money to the Lady's OnlyFans
character_event = {
	id = bretonnia.417
	desc = EVTDESC_bretonnia_417
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_417
		set_quest = quest_ladys_onlyfans
	}
	option = {
		name = EVTOPTB_bretonnia_417
		custom_tooltip = {
			text = decline_quest_tooltip
		}
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		ai_chance = {
			factor = 0
		}
	}
}

#Donating Money to the Lady
character_event = {
	id = bretonnia.418
	desc = EVTDESC_bretonnia_418
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_418
		clr_quest = quest_ladys_onlyfans
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_major_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		wealth = -300
		piety = 300
		clr_character_flag = donate_money_to_ladys
	}
}

#Donating Money to the Lady and receiving a special gift
character_event = {
	id = bretonnia.419
	desc = EVTDESC_bretonnia_419
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTA_bretonnia_419
		clr_quest = quest_ladys_onlyfans
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_minor_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		wealth = -300
		piety = 300
		hidden_tooltip = {
			random_list = {
				90 = {
					add_trait = ill
					health = -1
				}
				10 = {
					change_diplomacy = 3
					change_martial = 3
					change_stewardship = 3
					change_intrigue = 3
					change_learning = 3
				}
				2 = {
				remove_character_modifier = virtue_quest
				remove_trait = bretonnian_knight
				remove_trait = bretonnian_knight_errant
				add_trait = grail_knight
				}
			}
		}
		clr_character_flag = donate_money_to_ladys
	}
	option = {
		name = EVTOPTB_bretonnia_419
		clr_quest = quest_ladys_onlyfans
		add_society_modifier = {
			modifier = knights_of_bretonnia_successful_mission
			years = 10
		}
		add_society_currency_major_effect = yes
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		wealth = -300
		piety = 300
		clr_character_flag = donate_money_to_ladys
	}
}

# Grail Stuff
# then we try to get rid of the worst traits - in this case greed
character_event = {
	id = bretonnia.500
	desc = EVTDESCBRETONNIA.22	# You come across a remote shrine, dedicated to a sighting of The Lady many years ago. Rich offerings are on hand, and the pilgrims ask you to donate to the shrine to help feed the local village.
	picture = "GFX_evt_tribal_shrine"
	religion = grail
	min_age = 16
	is_triggered_only = yes
	trigger = {
		society_rank == 3
		is_member_of_bretonnia_trigger = yes
		trait = greedy
		NOT = {
			has_character_flag = failed_grail_quest
		}
	}
	option = {
		name = OF_COURSE_FOR_THE_LADY
		wealth = -200
		remove_trait = greedy
		add_trait = kind
	}
	option = {
		name = EVTOPTBRETONNIA.22.b		# Foul peasants - so that's where my tax money went!
		trigger = {
			ai = no
		}
		wealth = 200
		set_character_flag = failed_grail_quest
	}
}

# then we try to get rid of the worst traits - in this case craven
character_event = {
	id = bretonnia.501
	desc = EVTDESCBRETONNIA.23	# You know you are not the bravest of knights, so when you hear word that a norscan berserker has slain twenty men single-handedly and he suddenly appears over the horizon you are cautious about riding him down, but...
	picture = "GFX_evt_bretonnians"
	religion = grail
	min_age = 16
	is_triggered_only = yes
	trigger = {
		society_rank == 3
		is_member_of_bretonnia_trigger = yes
		trait = craven
		NOT = {
			has_character_flag = failed_grail_quest
		}
		NOT = {
			has_character_flag = duel
		}
	}
	option = {
		name = CHARGE
		save_event_target_as = combatant_1
		set_character_flag = duel
		remove_trait = craven
		add_trait = brave
		# THE START
		#Create the character to fight with
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			religion = norscan_gods
			culture = aesling			#somenorscanculture
			female = no
			age = 30
		}
		#scope to character we created and send him duel init event
		new_character = {
			save_event_target_as = combatant_2
			set_character_flag = duel
			character_event = {
				id = HFP.10095
			}
		}
		# THE END
	}
	option = {
		name = EVTOPTBRETONNIA.23.b		# I'm all alone, no one will if I just ride away...
		trigger = {
			ai = no
		}
		set_character_flag = failed_grail_quest
	}
}

# then we try to get rid of the worst traits - in this case lustful and hedonist
character_event = {
	id = bretonnia.502
	desc = EVTDESCBRETONNIA.24	# You are not the purest or most abstinent of knights, and just as you sit in a tavern considering these flaws of yours, a gorgeous barmaid approaches with a large pitcher of wine and a warm inviting smile...
	picture = "GFX_evt_feast"
	religion = grail
	min_age = 16
	is_triggered_only = yes
	trigger = {
		society_rank == 3
		is_member_of_bretonnia_trigger = yes
		OR = {
			trait = hedonist
			trait = lustful
		}
		NOT = {
			has_character_flag = failed_grail_quest
		}
	}
	option = {
		name = EVTOPTBRETONNIA.24.a		# Away with that, temptress! Just water for me from now on.
		remove_trait = lustful
		remove_trait = hedonist
		add_trait = temperate
	}
	option = {
		name = EVTOPTBRETONNIA.24.b		# I could indulge myself just once more...
		trigger = {
			ai = no
		}
		set_character_flag = failed_grail_quest
	}
}

# then we try to get rid of the worst traits - in this case cruel and wroth
character_event = {
	id = bretonnia.503
	desc = EVTDESCBRETONNIA.25	# While in a tavern, a peasant suddenly bumps into you and spills cheap wine all over you. He yells at you for being in his way, before realizing you are a knight, and then he slowly backs away with a sneer...
	picture = "GFX_evt_feast"
	religion = grail
	min_age = 16
	is_triggered_only = yes
	trigger = {
		society_rank == 3
		is_member_of_bretonnia_trigger = yes
		OR = {
			trait = cruel
			trait = wroth
		}
		NOT = {
			has_character_flag = failed_grail_quest
		}
	}
	option = {
		name = EVTOPTBRETONNIA.25.a		# *restrain yourself* Be on your way, peasant...
		remove_trait = wroth
		remove_trait = cruel
		add_trait = temperate
	}
	option = {
		name = EVTOPTBRETONNIA.25.b		# I'll horsewhip you from here till Cathay, you foul peasant!
		trigger = {
			ai = no
		}
		set_character_flag = failed_grail_quest
	}
}

# the green knights finally appears
character_event = {
	id = bretonnia.504
	title = THE_GRAIL_QUEST
	desc = EVTDESCBRETONNIA.26	# You can't believe it... one day while riding in the woods, the Green Knight appears. This is the final test! If you prove worthy and defeat him, the Lady of the Lake will appear and allow you to sip from the Holy Grail!
	picture = "GFX_evt_bretonnians"
	is_triggered_only = yes
	option = {
		name = EVTOPTBRETONNIA.26.a		# Well met, Sir Knight! I am ready for the challenge!
		set_character_flag = defeated_green_knight
		save_event_target_as = combatant_1
		set_character_flag = duel
		set_character_flag = flag_duel_no_draws
		set_character_flag = deadly_duel@event_target:combatant_2
		# THE START
		#Create the character to fight with
		create_random_soldier = {
			name = "The Green Knight"
			random_traits = yes
			dynasty = none
			religion = grail
			culture = old_breton
			female = no
			age = 30
		}
		#scope to character we created and send him duel init event
		new_character = {
			change_martial = 10
			save_event_target_as = combatant_2
			set_character_flag = flag_duel_no_draws
			set_character_flag = flag_duel_no_backsies
			add_trait = noble
			add_trait = green_knight
			add_trait = brave
			character_event = {
				id = bretonnia.505
				days = 30
			}
			character_event = {
				id = HFP.10095
				days = 1
			}
		}
		#Trigger the event to finish the quest - auto cancelled if character is dead.
		character_event = {
			id = bretonnia.506
			days = 30
			random = 5
		}
		# THE END
	}
}

#Despawn the Green Knight
character_event = {
	id = bretonnia.505
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		death = {
			death_reason = death_vanished
		}
	}
	option = {
		name = BEST_DAY_EVER
	}
}

# the lady finally appears
character_event = {
	id = bretonnia.506
	title = THE_LADY_OF_THE_LAKE
	desc = EVTDESCBRETONNIA.27	# It... it's finally happening! The Lady of the Lake appears before you, her grace and beauty beyond compare. Purified from your trials she allows you to sip from the Grail, and you feel vitality and strength flow into you!
	picture = "GFX_evt_knight_kneeling"
	is_triggered_only = yes
	option = {
		name = BEST_DAY_EVER
		society_rank_up = 1
		clr_character_flag = has_sent_request_to_rank_up
		clr_character_flag = defeated_green_knight
		remove_character_modifier = virtue_quest
		remove_trait = bretonnian_knight
		add_trait = grail_knight
	}
}

character_event = {
	id = bretonnia.507
	hide_window = yes
	religion = grail
	only_playable = yes
	trigger = {
		is_mutated_trigger = yes
		is_member_of_bretonnia_trigger = yes
	}
	#NEED TO CONVERT TO ON_ACTION
	mean_time_to_happen = {
		years = 1
	}
	immediate = {
		set_character_flag = failed_grail_quest
	}
}
