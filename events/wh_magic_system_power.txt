namespace = magic_learn_power
namespace = svampires
namespace = mageproc

##############################LEARNING#######################################
character_event = {
	id = magic_learn_power.1
	picture = GFX_evt_mage_choose_lore
	desc = {
		trigger = {
			NOR = {
				has_character_modifier = magic_power_1
				has_character_modifier = magic_power_2
				has_character_modifier = magic_power_3
				has_character_modifier = magic_power_4
			}
		}
		text = magic_learn_power.1.0_desc
		# Magic_Power_0 becomes Magic_Power_2
	}
	desc = {
		trigger = {
			has_character_modifier = magic_power_1
		}
		text = magic_learn_power.1.1_desc
		# Magic_Power_1 becomes Magic_Power_2
	}
	desc = {
		trigger = {
			has_character_modifier = magic_power_2
		}
		text = magic_learn_power.1.2_desc
		# Magic_Power_2 becomes Magic_Power_3
	}
	desc = {
		trigger = {
			has_character_modifier = magic_power_3
		}
		text = magic_learn_power.1.3_desc
		# Magic_Power_3 becomes Magic_Power_4
	}
	desc = {
		trigger = {
			has_character_modifier = magic_power_4
		}
		text = magic_learn_power.1.4_desc
	}
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	trigger = {
		prisoner = no
		NOT = { trait = incapable }
		magic_power_threshold_trigger = yes
	}
	option = {
		name = magic_learn_power.1d
		trigger = {
			magic_power_1_threshold_trigger = yes
		}
		level_up_magic_power_effect = yes
		change_learning = 1
	}
	option = {
		name = magic_learn_power.1a
		trigger = {
			magic_power_2_threshold_trigger = yes
		}
		level_up_magic_power_effect = yes
		change_learning = 1
	}
	option = {
		name = magic_learn_power.1b
		trigger = {
			magic_power_3_threshold_trigger = yes
		}
		level_up_magic_power_effect = yes
		change_learning = 1
	}
	option = {
		name = magic_learn_power.1c
		trigger = {
			magic_power_4_threshold_threshold_trigger = yes
		}
		level_up_magic_power_effect = yes
		change_learning = 1
	}
}
character_event = {
    id = magic_learn_power.99
    desc = magic_learn_power.99_desc#breakthrough in magic
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	trigger = {
		OR = {
			has_character_modifier =  magic_power_1
			has_character_modifier =  magic_power_2
			has_character_modifier =  magic_power_3
			has_character_modifier =  magic_power_4
		}
	}
 	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.5
			has_character_modifier = magic_power_2
		}
		modifier = {
			factor = 0.3
			has_character_modifier = magic_power_3
		}
		modifier = {
			factor = 0.1
			has_character_modifier = magic_power_4
		}
		modifier = {
			factor = 3
			trait = genius
		}
		modifier = {
			factor = 3
			trait = mystic
		}
		modifier = {
			factor = 3
			trait = scholar
		}
		modifier = {
			factor = 4
			trait = creature_slann
		}
		modifier = {
			factor = 2
			trait = brilliant
		}
		modifier = {
			factor = 2
			trait = grey_seer
		}
		modifier = {
			factor = 2
			trait = skink_priest
		}
		modifier = {
			factor = 2
			trait = council_warlord
		}
		modifier = {
			factor = 1.1
			trait = magic_potential_1
		}
		modifier = {
			factor = 1.2
			trait = magic_potential_2
		}
		modifier = {
			factor = 1.5
			trait = magic_potential_3
		}
		modifier = {
			factor = 2
			trait = magic_potential_4
		}
		modifier = {
			factor = 3
			trait = prince_tzeentch
		}
		modifier = {
			factor = 1.1
			learning = 5
		}
		modifier = {
			factor = 1.1
			learning = 10
		}
		modifier = {
			factor = 1.1
			learning = 15
		}
		modifier = {
			factor = 1.1
			learning = 20
		}
		modifier = {
			factor = 1.1
			learning = 25
		}
		modifier = {
			factor = 2
			learning = 30
		}
		modifier = {
			factor = 1.1
			learning = 35
		}
		modifier = {
			factor = 1.1
			learning = 40
		}
		modifier = {
			factor = 1.1
			learning = 45
		}
		modifier = {
			factor = 1.1
			learning = 50
		}
		modifier = {
			factor = 1.1
			learning = 55
		}
		modifier = {
			factor = 1.1
			learning = 60
		}
		modifier = {
			factor = 1.1
			learning = 75
		}
		modifier = {
			factor = 1.1
			learning = 80
		}
		modifier = {
			factor = 1.1
			learning = 85
		}
		modifier = {
			factor = 0
			trait = incapable
		}
		modifier = {
			factor = 0.5
			trait = wounded
		}
		modifier = {
			factor = 0.1
			trait = maimed
		}
		modifier = {
			factor = 0.1
			trait = slow
		}
		modifier = {
			factor = 0.75
			trait = drunkard
		}
		modifier = {
			factor = 0.75
			trait = slothful
		}
		modifier = {
			factor = 2
			trait = ambitious
		}
		modifier = {
			factor = 2
			trait = diligent
		}
		modifier = {
			factor = 1.25
			trait = lunatic_1
		}
		modifier = {
			factor = 1.5
			trait = lunatic_2
		}
		modifier = {
			factor = 2
			trait = lunatic_3
		}
	}
	option = {
		name = magic_learn_power.99a#gain magic xp
		enable_magic_xp_effect = yes
		magic_xp_effect = yes

		random = {
			chance = 5
			change_learning = 1
		}
	}
}
##############################NECROMANCY#####################################

#Summon undead horde
character_event = {
	id = svampires.11
	picture = "GFX_evt_zombies"
	desc = EVTDESCsvampires11

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11
		trigger = {
			has_character_modifier = necromantic_power_5
			has_character_modifier = magic_power_4
		}
		if = {
			limit = { has_character_modifier = necromantic_power_5 }
			remove_character_modifier = necromantic_power_5
		}
		random_list = {
			50 = {
				character_event = { id = svampires.11009 }
			} #Small Endless horde
			50 = {
				modifier = {
					factor = 0
					location = { culture = nehekharan }
				}
				modifier = {
					factor = 1.75
					religion = nagashi
				}
				modifier = {
					factor = 0.85
					trait = hedge_wizard
				}
				modifier = {
					factor = 1.85
					trait = creature_nehekharan
				}
				modifier = {
					factor = 1.75
					is_vampire_trigger = yes
				}
				modifier = {
					factor = 1.65
					has_character_modifier = magic_power_2
				}
				modifier = {
					factor = 1.75
					has_character_modifier = magic_power_3
				}
				modifier = {
					factor = 1.85
					has_character_modifier = magic_power_4
				}
				character_event = { id = svampires.11010 }
			} #Big Endless horde
		}
	}
	option = {
		name = EVTOPTBsvampires11
		trigger = {
			OR = {
				has_character_modifier = necromantic_power_5
				has_character_modifier = necromantic_power_4
			}
			OR = {
				has_character_modifier = magic_power_3
				has_character_modifier = magic_power_4
			}
		}
		if = {
			limit = { has_character_modifier = necromantic_power_5 }
			remove_character_modifier = necromantic_power_5
			add_character_modifier = { name = necromantic_power_1 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_4 }
			remove_character_modifier = necromantic_power_4
		}
		random_list = {
			50 = {
				character_event = { id = svampires.11007 }
			} #Small Huge horde
			50 = {
				modifier = {
					factor = 0
					location = { culture = nehekharan }
				}
				modifier = {
					factor = 1.75
					religion = nagashi
				}
				modifier = {
					factor = 0.85
					trait = hedge_wizard
				}
				modifier = {
					factor = 1.85
					trait = creature_nehekharan
				}
				modifier = {
					factor = 1.75
					is_vampire_trigger = yes
				}
				modifier = {
					factor = 1.65
					has_character_modifier = magic_power_2
				}
				modifier = {
					factor = 1.75
					has_character_modifier = magic_power_3
				}
				modifier = {
					factor = 1.85
					has_character_modifier = magic_power_4
				}
				character_event = { id = svampires.11008 }
			} #Big Huge horde
		}
	}
	option = {
		name = EVTOPTCsvampires11
		trigger = {
			OR = {
				has_character_modifier = necromantic_power_5
				has_character_modifier = necromantic_power_4
				has_character_modifier = necromantic_power_3
			}
		}
		if = {
			limit = { has_character_modifier = necromantic_power_5 }
			remove_character_modifier = necromantic_power_5
			add_character_modifier = { name = necromantic_power_2 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_4 }
			remove_character_modifier = necromantic_power_4
			add_character_modifier = { name = necromantic_power_1 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_3 }
			remove_character_modifier = necromantic_power_3
		}
		random_list = {
			50 = {
				character_event = { id = svampires.11005 }
			} #Small Large horde
			50 = {
				modifier = {
					factor = 0
					location = { culture = nehekharan }
				}
				modifier = {
					factor = 1.75
					religion = nagashi
				}
				modifier = {
					factor = 0.85
					trait = hedge_wizard
				}
				modifier = {
					factor = 1.85
					trait = creature_nehekharan
				}
				modifier = {
					factor = 1.75
					is_vampire_trigger = yes
				}
				modifier = {
					factor = 1.65
					has_character_modifier = magic_power_2
				}
				modifier = {
					factor = 1.75
					has_character_modifier = magic_power_3
				}
				modifier = {
					factor = 1.85
					has_character_modifier = magic_power_4
				}
				character_event = { id = svampires.11006 }
			} #Big Large horde
		}
	}
	option = {
		name = EVTOPTDsvampires11
		trigger = {
			OR = {
				has_character_modifier = necromantic_power_5
				has_character_modifier = necromantic_power_4
				has_character_modifier = necromantic_power_3
				has_character_modifier = necromantic_power_2
			}
		}
		if = {
			limit = { has_character_modifier = necromantic_power_5 }
			remove_character_modifier = necromantic_power_5
			add_character_modifier = { name = necromantic_power_3 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_4 }
			remove_character_modifier = necromantic_power_4
			add_character_modifier = { name = necromantic_power_2 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_3 }
			remove_character_modifier = necromantic_power_3
			add_character_modifier = { name = necromantic_power_1 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_2 }
			remove_character_modifier = necromantic_power_2
		}
		random_list = {
			50 = {
				character_event = { id = svampires.11003 }
			} #Small Average horde
			50 = {
				modifier = {
					factor = 0
					location = { culture = nehekharan }
				}
				modifier = {
					factor = 1.75
					religion = nagashi
				}
				modifier = {
					factor = 0.85
					trait = hedge_wizard
				}
				modifier = {
					factor = 1.85
					trait = creature_nehekharan
				}
				modifier = {
					factor = 1.75
					is_vampire_trigger = yes
				}
				modifier = {
					factor = 1.65
					has_character_modifier = magic_power_2
				}
				modifier = {
					factor = 1.75
					has_character_modifier = magic_power_3
				}
				modifier = {
					factor = 1.85
					has_character_modifier = magic_power_4
				}
				character_event = { id = svampires.11004 }
			} #Big Average horde
		}
	}
	option = {
		name = EVTOPTEsvampires11
		trigger = {
			OR = {
				has_character_modifier = necromantic_power_4
				has_character_modifier = necromantic_power_3
				has_character_modifier = necromantic_power_2
				has_character_modifier = necromantic_power_1
			}
		}
		if = {
			limit = { has_character_modifier = necromantic_power_4 }
			remove_character_modifier = necromantic_power_4
			add_character_modifier = { name = necromantic_power_3 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_3 }
			remove_character_modifier = necromantic_power_3
			add_character_modifier = { name = necromantic_power_2 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_2 }
			remove_character_modifier = necromantic_power_2
			add_character_modifier = { name = necromantic_power_1 duration = -1 }
		}
		if = {
			limit = { has_character_modifier = necromantic_power_1 }
			remove_character_modifier = necromantic_power_1
		}
		random_list = {
			50 = {
				character_event = { id = svampires.11001 }
			} #Small small horde
			50 = {
				modifier = {
					factor = 0
					location = { culture = nehekharan }
				}
				modifier = {
					factor = 1.75
					religion = nagashi
				}
				modifier = {
					factor = 0.85
					trait = hedge_wizard
				}
				modifier = {
					factor = 1.85
					trait = creature_nehekharan
				}
				modifier = {
					factor = 1.75
					is_vampire_trigger = yes
				}
				modifier = {
					factor = 1.65
					has_character_modifier = magic_power_2
				}
				modifier = {
					factor = 1.75
					has_character_modifier = magic_power_3
				}
				modifier = {
					factor = 1.85
					has_character_modifier = magic_power_4
				}
				character_event = { id = svampires.11002 }
			} #Big small horde
		}
	}
}
#The undead fall apart
character_event = {
	id = svampires.12001
	desc = EVTDESCAsvampires12001
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	notification = yes
	is_triggered_only = yes

	immediate = {
		disband_event_forces = summoned_zombiehorde_1
		disband_event_forces = summoned_zombiehorde_2
		disband_event_forces = summoned_zombiehorde_3
		disband_event_forces = summoned_zombiehorde_4
		disband_event_forces = summoned_zombiehorde_5
		disband_event_forces = summoned_zombiehorde_6
		disband_event_forces = summoned_zombiehorde_7
		disband_event_forces = summoned_zombiehorde_8
		disband_event_forces = summoned_zombiehorde_9
		disband_event_forces = summoned_zombiehorde_10
	}
	option = {
	}
}
#Small small horde
character_event = {
	id = svampires.11001
	desc = EVTDESCAsvampires11001
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11001
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12001 days = 450 random = 490 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_1 duration = 650 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_1
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Big small horde
character_event = {
	id = svampires.11002
	desc = EVTDESCAsvampires11002
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11002
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12001 days = 450 random = 490 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_1 duration = 650 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_2
					troops = { undead_horde = { 1750 1750 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Small average horde
character_event = {
	id = svampires.11003
	desc = EVTDESCAsvampires11003
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11003
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12001 days = 450 random = 590 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_2 duration = 850 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_3
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_3
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_3
					troops = { undead_horde = { 500 500 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Big average horde
character_event = {
	id = svampires.11004
	desc = EVTDESCAsvampires11004
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11004
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12001 days = 450 random = 590 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_2 duration = 850 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_4
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_4
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_4
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Small large horde
character_event = {
	id = svampires.11005
	desc = EVTDESCAsvampires11005
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11005
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12005 days = 450 random = 690 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_3 duration = 1000 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_5
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_5
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_5
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_5
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Big large horde
character_event = {
	id = svampires.11006
	desc = EVTDESCAsvampires11006
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11006
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12001 days = 450 random = 690 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_3 duration = 1000 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_6
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_6
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_6
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_6
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_3
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_6
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Small Huge horde
character_event = {
	id = svampires.11007
	desc = EVTDESCAsvampires11007
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11007
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12001 days = 450 random = 790 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_4 duration = 1500 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_7
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_7
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_7
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_7
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_7
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_7
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_7
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Big Huge horde
character_event = {
	id = svampires.11008
	desc = EVTDESCAsvampires11008
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11008
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12001 days = 450 random = 790 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_4 duration = 1500 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 2000 2000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_8
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Small Endless horde
character_event = {
	id = svampires.11009
	desc = EVTDESCAsvampires11009
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11009
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12009 days = 450 random = 890 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_5 duration = 2000 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_9
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}
#Big Endless horde
character_event = {
	id = svampires.11010
	desc = EVTDESCAsvampires11010
	picture = "GFX_evt_zombies"
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAsvampires11010
		hidden_tooltip = {
			ROOT = {
				character_event = { id = svampires.12010 days = 450 random = 890 }
			}
		}
		location = {
			add_province_modifier = { name = province_tainted_5 duration = 2000 }
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					attrition = 0
					reinforces = yes
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					attrition = 0
					reinforces = yes
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					attrition = 0
					reinforces = yes
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 2500 2500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 1500 1500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_zombiehorde_10
					troops = { undead_horde = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
}

#############################################################################

#Reveal Plot Events
character_event = {
	id = mageproc.0
	desc = mageproc_0_desc
	picture = GFX_evt_mage_choose_lore
	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		reveal_plots_effect = yes
		event_target:plot_reveal_magic = {
			hidden_tooltip = {
				character_event = { id = mageproc.1 }
				change_plot_power = -100
			}
			reveal_plot = ROOT
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clear_event_target = plot_reveal_magic
		clr_character_flag = plots_and_dreams
	}
}
#Inform plotter
character_event = {
	id = mageproc.1
	desc = mageproc_1_Desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	option = {
	}
}

#############################################################################

#Drink elixir
character_event = {
	id = mageproc.2
	picture = "GFX_evt_magic_potion"
	desc = EVTDESC_mageproc_2

	is_triggered_only = yes

	option = { #Consume elixir of the marshall
		name = EVTOPTA_mageproc_2
		trigger = {
			has_artifact = elixir_of_the_marshall
			ROOT = { martial < 15 }
		}
		unsafe_destroy_artifact = elixir_of_the_marshall
		ROOT = { change_martial = 1 }
	}

	option = { #Consume elixir of the diplomat
		name = EVTOPTB_mageproc_2
		trigger = {
			has_artifact = elixir_of_the_diplomat
			ROOT = { diplomacy < 15 }
		}
		unsafe_destroy_artifact = elixir_of_the_diplomat
		ROOT = { change_diplomacy = 1 }
	}

	option = { #Consume elixir of the steward
		name = EVTOPTC_mageproc_2
		trigger = {
			has_artifact = elixir_of_the_steward
			ROOT = { stewardship < 15 }
		}
		unsafe_destroy_artifact = elixir_of_the_steward
		ROOT = { change_stewardship = 1 }
	}

	option = { #Consume elixir of the spy
		name = EVTOPTD_mageproc_2
		trigger = {
			has_artifact = elixir_of_the_spy
			ROOT = { intrigue < 15 }
		}
		unsafe_destroy_artifact = elixir_of_the_spy
		ROOT = { change_intrigue = 1 }
	}

	option = { #Cancel Decision
		name = "Nevermind"
	}
}
#Eat Warpstone
character_event = {
	id = mageproc.3
	picture = "GFX_evt_warpstone_vein"
	desc = EVTDESC_mageproc_3

	is_triggered_only = yes

	option = { #Consume warpstone dust
		name = EVTOPTA_mageproc_3
		trigger = {
			has_artifact = warpstone_dust
		}
		unsafe_destroy_artifact = warpstone_dust
		add_offmap_currency = {
			offmap = offmap_magic
			value = 1
		}
		hidden_tooltip = {
			channeling_effect = yes
		}
		if = {
			limit = {
				ROOT = {
					NOT = { religion_group = necromantic_group }
				}
			}
			hidden_tooltip = {
				random = {
					chance = 15
					add_trait = addict
				}
				character_event = { id = mutate.5 } #Lunacy Counter
			}
			add_character_modifier = { name = warpstone_1 duration = 365 stacking = yes }
			random = {
				chance = 5
				add_character_modifier = { name = warpstone_frenzy duration = 365 stacking = yes}
			}
			random = {
				chance = 5
				custom_tooltip = {
		 			text = mutations_test_tt
		 			mutation_toughness_test_effect = yes
		 	 	}
			}
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					NOR = {
						has_character_modifier = necromantic_power_1
						has_character_modifier = necromantic_power_2
						has_character_modifier = necromantic_power_3
						has_character_modifier = necromantic_power_4
						has_character_modifier = necromantic_power_5
					}
				}
			}
			add_character_modifier = { name = necromantic_power_1 duration = -1 }
			break = yes
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					has_character_modifier = necromantic_power_1
				}
			}
			add_character_modifier = { name = necromantic_power_2 duration = -1 }
			remove_character_modifier = necromantic_power_1
			break = yes
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					has_character_modifier = necromantic_power_2
				}
			}
			add_character_modifier = { name = necromantic_power_3 duration = -1 }
			remove_character_modifier = necromantic_power_2
			break = yes
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					has_character_modifier = necromantic_power_3
				}
			}
			add_character_modifier = { name = necromantic_power_4 duration = -1 }
			remove_character_modifier = necromantic_power_3
			break = yes
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					has_character_modifier = necromantic_power_4
				}
			}
			add_character_modifier = { name = necromantic_power_5 duration = -1 }
			remove_character_modifier = necromantic_power_4
			break = yes
		}
	}

	option = { #Consume warpstone shard
		name = EVTOPTB_mageproc_3
		trigger = {
			has_artifact = warpstone_shard
		}
		unsafe_destroy_artifact = warpstone_shard
		add_offmap_currency = {
			offmap = offmap_magic
			value = 3
		}
		hidden_tooltip = {
			channeling_effect = yes
		}
		if = {
			limit = {
				ROOT = {
					NOT = { religion_group = necromantic_group }
				}
			}
			hidden_tooltip = {
				random = {
					chance = 50
					add_trait = addict
				}
				character_event = { id = mutate.5 } #Lunacy Counter
			}
			add_character_modifier = { name = warpstone_3 duration = 365 stacking = yes }
			random = {
				chance = 50
				add_character_modifier = { name = warpstone_frenzy duration = 365 stacking = yes}
			}
			random = {
				chance = 15
				custom_tooltip = {
		 			text = mutations_test_tt
		 			mutation_toughness_test_effect = yes
		 	 	}
			}
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					NOR = {
						has_character_modifier = necromantic_power_1
						has_character_modifier = necromantic_power_2
						has_character_modifier = necromantic_power_3
						has_character_modifier = necromantic_power_4
						has_character_modifier = necromantic_power_5
					}
				}
			}
			add_character_modifier = { name = necromantic_power_3 duration = -1 }
			break = yes
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					has_character_modifier = necromantic_power_1
				}
			}
			add_character_modifier = { name = necromantic_power_4 duration = -1 }
			remove_character_modifier = necromantic_power_1
			break = yes
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					has_character_modifier = necromantic_power_2
					has_character_modifier = necromantic_power_3
					has_character_modifier = necromantic_power_4
				}
			}
			add_character_modifier = { name = necromantic_power_5 duration = -1 }
			remove_character_modifier = necromantic_power_2
			remove_character_modifier = necromantic_power_3
			remove_character_modifier = necromantic_power_4
			break = yes
		}
	}

	option = { #Consume warpstone cluster
		name = EVTOPTC_mageproc_3
		trigger = {
			has_artifact = warpstone_cluster
		}
		unsafe_destroy_artifact = warpstone_cluster
		add_offmap_currency = {
			offmap = offmap_magic
			value = 5
		}
		hidden_tooltip = {
			channeling_effect = yes
		}
		if = {
			limit = {
				ROOT = {
					NOT = { religion_group = necromantic_group }
				}
			}
			hidden_tooltip = {
				if = {
					limit = { is_invincible_trigger = yes }
					random = {
						chance = 5
						add_trait = addict
					}
				}
				else = {
					random = {
						chance = 100
						add_trait = addict
					}
				}
				character_event = { id = mutate.5 } #Lunacy Counter
			}
			add_character_modifier = { name = warpstone_5 duration = 365 stacking = yes }
			random = {
				chance = 100
				add_character_modifier = { name = warpstone_frenzy duration = 365 stacking = yes}
			}
			random = {
				chance = 30
				custom_tooltip = {
		 			text = mutations_test_tt
		 			mutation_toughness_test_effect = yes
		 	 	}
			}
			if = {
  				limit = { is_invincible_trigger = no }
				random = {
					chance = 25
					death = {
						death_reason = death_suicide_poison
					}
				}
			}
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					NOR = {
						has_character_modifier = necromantic_power_1
						has_character_modifier = necromantic_power_2
						has_character_modifier = necromantic_power_3
						has_character_modifier = necromantic_power_4
						has_character_modifier = necromantic_power_5
					}
				}
			}
			add_character_modifier = { name = necromantic_power_5 duration = -1 }
			break = yes
		}
		else_if = {
			limit = {
				ROOT = {
					religion_group = necromantic_group
					has_character_modifier = necromantic_power_1
					has_character_modifier = necromantic_power_2
					has_character_modifier = necromantic_power_3
					has_character_modifier = necromantic_power_4
				}
			}
			add_character_modifier = { name = necromantic_power_5 duration = -1 }
			remove_character_modifier = necromantic_power_1
			remove_character_modifier = necromantic_power_2
			remove_character_modifier = necromantic_power_3
			remove_character_modifier = necromantic_power_4
			break = yes
		}
	}

	option = { #Cancel Decision
		name = "Nevermind"
	}
}
#Drink Potion
character_event = {
	id = mageproc.4
	picture = "GFX_evt_magic_potion"
	desc = EVTDESC_mageproc_4

	is_triggered_only = yes

	option = { #Consume potion healing
		name = EVTOPTA_mageproc_4
		trigger = {
			has_artifact = potion_of_healing
		}
		unsafe_destroy_artifact = potion_of_healing
		healing_effect = yes
	}

	option = { #Consume potion beauty
		name = EVTOPTB_mageproc_4
		trigger = {
			has_artifact = potion_of_beauty
		}
		unsafe_destroy_artifact = potion_of_beauty
		enhanced_beauty_effect = yes
	}

	option = { #Consume potion speed
		name = EVTOPTC_mageproc_4
		trigger = {
			has_artifact = potion_of_speed
		}
		unsafe_destroy_artifact = potion_of_speed
		enhanced_ability_speed_effect = yes
	}

	option = { #Consume potion strength
		name = EVTOPTD_mageproc_4
		trigger = {
			has_artifact = potion_of_strength
		}
		unsafe_destroy_artifact = potion_of_strength
		enhanced_ability_strength_effect = yes
	}

	option = { #Cancel Decision
		name = "Nevermind"
	}
}


#############################################################################

##NOT LOCALIZED

#############################################################################

#Heal Location Troops Event
character_event = {
	id = mageproc.5
	desc = mageproc_5_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				save_event_target_as = magic_loc
				magic_reduce_disease_effect = yes
			}
		}
		hidden_tooltip = {
			random_army = {
				limit = {
					location = { province = event_target:magic_loc }
				}
				heal_effect = yes
				morale_heal_effect = yes
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clear_event_target = magic_loc
		clr_character_flag = heal_location_troops
	}
}
#Damage Location Troops Event
character_event = {
	id = mageproc.6
	desc = mageproc_6_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				save_event_target_as = magic_loc
			}
		}
	}

	option = {
		name = OKc
		any_character = {
			limit = {
				war_with = ROOT
				any_army = {
					location = { province = event_target:magic_loc }
				}
			}
			any_unit = {
				limit = {
					location = { province = event_target:magic_loc }
				}
				ROOT = { change_variable = { which = UnitsPresent value = 1 } }
				troops = -0.1
			}
		}
	}
	after = {
		character_event = { id = mageproc.44 days = 1}
		clear_event_target = magic_caster
		clear_event_target = magic_loc
		clr_character_flag = damage_location_troops
		clr_character_flag = damage_special_location_troops
	}
}
#Damage Location Troops Event
character_event = {
	id = mageproc.44
	desc = mageproc_6_desc
	picture = GFX_evt_mage_choose_lore

	is_triggered_only = yes
	trigger = {
		in_battle = yes
		NOT = {
			combat = {
				troops = {
					who = troops
					value <= 0.01
					enemy = yes
				}
			}
		}
	}
	immediate = { 
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				save_event_target_as = magic_loc
			}
		}
		any_army = { 
			limit = { location = { province = event_target:magic_loc } } 
			center_flank_leader = { save_event_target_as = battle_leader }
		}
		center_flank_leader = { save_event_target_as = battle_leader2 }
		leader = {
			save_event_target_as = battle_leader3
		}
		combat = {
			save_event_target_as = battle_leader4
		}
		enemy = {
			save_event_target_as = battle_leader5
		}
	}
	option = {
		name = OKc
		event_target:battle_leader = {
			if = {
				limit = {
					combat = {
						#Are the enemy's troops at least 10% of our troops?
						troops = {
							who = troops
							value <= 0.1
							enemy = yes
						}
					}
				}
				add_trait = berserker
				any_character = {
					limit = {
						war_with = ROOT
						any_army = {
							location = { province = event_target:magic_loc }
						}
					}
					any_controlled_unit = {
						limit = {
							location = { province = event_target:magic_loc }
							unit_is_in_combat = yes
						}
						damage_unit = { 
							amount = -126
							type = light_infantry
						}
					}
				}
			}
			if = {
				limit = {
					combat = {
						#Are the enemy's troops at least 10% of our troops?
						troops = {
							who = troops
							value >= 0.1
							enemy = yes
						}
					}
				}
				add_trait = celibate
				any_character = {
					limit = {
						war_with = ROOT
						any_army = {
							location = { province = event_target:magic_loc }
						}
					}
					any_controlled_unit = {
						limit = {
							location = { province = event_target:magic_loc }
							unit_is_in_combat = yes
						}
						damage_unit = { 
							amount = -126
							type = light_infantry
						}
					}
				}
			}
		
		}
	}
	option = {
		name = oki
		if = {
			limit = {
				combat = {
					#Are the enemy's troops at least 10% of our troops?
					troops = {
						who = troops
						value <= 0.1
						enemy = yes
					}
				}
			}
			add_trait = berserker
			any_character = {
				limit = {
					war_with = ROOT
					any_army = {
						location = { province = event_target:magic_loc }
					}
				}
				any_controlled_unit = {
					limit = {
						location = { province = event_target:magic_loc }
						unit_is_in_combat = yes
					}
					damage_unit = { 
						amount = -126
						type = light_infantry
					}
				}
			}
		}
		if = {
			limit = {
				combat = {
					#Are the enemy's troops at least 10% of our troops?
					troops = {
						who = troops
						value >= 0.1
						enemy = yes
					}
				}
			}
			add_trait = celibate
			any_character = {
				limit = {
					war_with = ROOT
					any_army = {
						location = { province = event_target:magic_loc }
					}
				}
				any_controlled_unit = {
					limit = {
						location = { province = event_target:magic_loc }
						unit_is_in_combat = yes
					}
					damage_unit = { 
						amount = -126
						type = light_infantry
					}
				}
			}
		}
	}
	option = {
		name = nvm
	}
	after = {
		clear_event_target = magic_caster
		clear_event_target = magic_loc
		clr_character_flag = damage_location_troops
		clr_character_flag = damage_special_location_troops
	}
}
#Dispel Event
character_event = {
	id = mageproc.7
	desc = mageproc_7_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				save_event_target_as = magic_loc
				if = {
					limit = {
						OR = {
   							has_province_modifier = province_tainted_1
   							has_province_modifier = province_tainted_2
   							has_province_modifier = province_tainted_3
   							has_province_modifier = province_tainted_4
   							has_province_modifier = province_tainted_5
   					 	}
					}
					remove_province_modifier = province_tainted_1
					remove_province_modifier = province_tainted_2
					remove_province_modifier = province_tainted_3
					remove_province_modifier = province_tainted_4
					remove_province_modifier = province_tainted_5
				}
			}
		}
		any_character = {
			limit = {
				war_with = ROOT
				any_army = {
					location = { province = event_target:magic_loc }
				}
			}
			random_army = {
				limit = {
					location = { province = event_target:magic_loc }
				}
				leader = {
					save_event_target_as = magic_target
				}
				dispel_effect = yes
				if = {
					limit = {
						event_target:magic_caster = {
							check_variable = { which = MagicPool value > 4 }
						}
					}
					event_target:magic_caster = {
						subtract_variable = { which = MagicPool value = 3 }
					}
					magic_dmg_effect = yes
					morale_dmg_effect = yes
				}
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clear_event_target = magic_loc
		clear_event_target = magic_target
		clr_character_flag = banishment_location
	}
}
#Prosperity Increase Event
character_event = {
	id = mageproc.8
	desc = mageproc_8_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_prosperity_increase_effect = yes
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = prosperity_location_increase
	}
}
#Prosperity Decrease Event
character_event = {
	id = mageproc.9
	desc = mageproc_9_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_prosperity_decrease_effect = yes
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = prosperity_location_decrease
	}
}
#Holding Slot Increase Event
character_event = {
	id = mageproc.10
	desc = mageproc_10_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_holding_slot_increase_effect = yes
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = holding_slot_location_increase
	}
}
#Magic Spawn Disease Event
character_event = {
	id = mageproc.11
	desc = mageproc_11_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_spawn_disease_effect = yes
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = magic_spawn_disease
	}
}
#Magic Reduce Disease Event
character_event = {
	id = mageproc.12
	desc = mageproc_12_desc
	picture = GFX_evt_mage_choose_lore

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_reduce_disease_effect = yes
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = magic_reduce_disease
	}
}

#############################################################################

#Magic Transform Events
character_event = {
	id = mageproc.13
	desc = mageproc_13_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
	}
	option = {
		name = mageproc.13a
		event_target:magic_target = {
			magic_transform_effect = yes
		}
	}
	option = {
		name = Nevermind
	}
	after = {
		clear_event_target = magic_caster
		clear_event_target = magic_target
		clr_character_flag = magic_transform_prisoner
	}
}
# The prisoner becomes monstrous
character_event = {
	id = mageproc.14
	desc = mageproc_14_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.14a
		set_graphical_culture = beastman_beasts
		#set_graphical_culture = beastman_ungor
		add_trait = monstrous
		opinion = { modifier = opinion_polymorphed_me who = FROM }
		FROM = {
			character_event = { id = mageproc.15 }
		}
	}
}
# The prisoner becomes monstrous - Notify jailer
character_event = {
	id = mageproc.15
	desc = mageproc_15_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.15a
		any_vassal = {
			limit = {
				NOR = {
					trait = brave
					trait = quick
					trait = genius
				}
			}
			opinion = { modifier = opinion_scared_into_submission who = ROOT }
		}
		any_courtier = {
			limit = {
				NOR = {
					trait = brave
					trait = quick
					trait = genius
				}
			}
			opinion = { modifier = opinion_scared_into_submission who = ROOT }
		}
	}
}
# The prisoner becomes a toad
character_event = {
	id = mageproc.16
	desc = mageproc_15_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.16a
		hidden_tooltip = {
			remove_trait = creature_human
			remove_trait = creature_fimir
			remove_trait = creature_elf
			remove_trait = creature_dwarf
			remove_trait = creature_halfling
			remove_trait = creature_forestspirit
			remove_trait = creature_slann
			remove_trait = creature_skink
			remove_trait = creature_amazon
			remove_trait = creature_nehekharan
			remove_trait = creature_ogre
			remove_trait = creature_chaos_dwarf
			remove_trait = creature_orc
			remove_trait = creature_goblin
			remove_trait = creature_hobgoblin
			remove_trait = creature_skaven
			remove_trait = creature_beastman
			remove_trait = creature_saurus
			remove_trait = slaanesh_demon
			remove_trait = tzeentch_demon
			remove_trait = nurgle_demon
			remove_trait = khorne_demon
			remove_trait = undivided_demon
			remove_trait = slaanesh_daemonette
			remove_trait = tzeentch_flamer
			remove_trait = nurgle_plaguebearer
			remove_trait = khorne_bloodletter
			remove_trait = hashut_kdaai
		}
		add_trait = creature_toad
		add_trait = disinherited
		if = {
			limit = {
				trait = creature_skink
			}
			add_trait = defective
		}
		opinion = { modifier = opinion_polymorphed_me who = FROM }
		FROM = {
			character_event = { id = mageproc.17 }
		}
	}
}
# The prisoner becomes toad - Notify jailer
character_event = {
	id = mageproc.17
	desc = mageproc_17_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.17a
		hidden_tooltip = {
			FROM = {
				character_event = { id = mageproc.18 days = 120 random = 100 }
			}
		}
		any_vassal = {
			limit = {
				NOR = {
					trait = brave
					trait = quick
					trait = brilliant
					trait = genius
				}
			}
			opinion = { modifier = opinion_scared_into_submission who = ROOT }
		}
		any_courtier = {
			limit = {
				NOR = {
					trait = brave
					trait = quick
					trait = brilliant
					trait = genius
				}
			}
			opinion = { modifier = opinion_scared_into_submission who = ROOT }
		}
	}
}
# The toad is deposed
character_event = {
	id = mageproc.18
	desc = mageproc_18_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	trigger = {
		trait = creature_toad
		is_ruler = yes
	}

	option = {
		name = mageproc.18a
		abdicate = yes
	}
}
# The prisoner becomes a pig
character_event = {
	id = mageproc.19
	desc = mageproc_19_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.19a
		hidden_tooltip = {
			remove_trait = creature_human
			remove_trait = creature_fimir
			remove_trait = creature_elf
			remove_trait = creature_dwarf
			remove_trait = creature_halfling
			remove_trait = creature_forestspirit
			remove_trait = creature_slann
			remove_trait = creature_skink
			remove_trait = creature_amazon
			remove_trait = creature_nehekharan
			remove_trait = creature_ogre
			remove_trait = creature_chaos_dwarf
			remove_trait = creature_orc
			remove_trait = creature_goblin
			remove_trait = creature_hobgoblin
			remove_trait = creature_skaven
			remove_trait = creature_beastman
			remove_trait = creature_saurus
			remove_trait = slaanesh_demon
			remove_trait = tzeentch_demon
			remove_trait = nurgle_demon
			remove_trait = khorne_demon
			remove_trait = undivided_demon
			remove_trait = slaanesh_daemonette
			remove_trait = tzeentch_flamer
			remove_trait = nurgle_plaguebearer
			remove_trait = khorne_bloodletter
			remove_trait = hashut_kdaai
		}
		add_trait = creature_pig
		add_trait = disinherited
		if = {
			limit = {
				trait = creature_skink
			}
			add_trait = defective
		}
		opinion = { modifier = opinion_polymorphed_me who = FROM }
		FROM = {
			character_event = { id = mageproc.20 }
		}
	}
}
# The prisoner becomes pig - Notify jailer
character_event = {
	id = mageproc.20
	desc = mageproc_20_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.20a
		hidden_tooltip = {
			FROM = {
				character_event = { id = mageproc.21 days = 120 random = 100 }
			}
		}
		any_vassal = {
			limit = {
				NOR = {
					trait = brave
					trait = quick
					trait = brilliant
					trait = genius
				}
			}
			opinion = { modifier = opinion_scared_into_submission who = ROOT }
		}
		any_courtier = {
			limit = {
				NOR = {
					trait = brave
					trait = quick
					trait = brilliant
					trait = genius
				}
			}
			opinion = { modifier = opinion_scared_into_submission who = ROOT }
		}
	}
}
# The pig is deposed
character_event = {
	id = mageproc.21
	desc = mageproc_21_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	trigger = {
		trait = creature_pig
		is_ruler = yes
	}

	option = {
		name = mageproc.21a
		abdicate = yes
	}
}

#############################################################################

# Target resists the spell
character_event = {
	id = mageproc.22
	desc = mageproc_22_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.22a
		FROM = {
			character_event = { id = mageproc.23 }
		}
	}
}
# Target resists the spell - Notify jailer
character_event = {
	id = mageproc.23
	desc = mageproc_23_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.23a
		piety = -50
		prestige = -50
		ai_chance = { factor = 1 }
	}
}
# The prisoner counteracted the spell and got free
character_event = {
	id = mageproc.24
	desc = mageproc_24_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.24a
		prisoner = no
		FROM = {
			character_event = { id = mageproc.25 }
		}
	}
}
# The prisoner counteracted the spell and got free - Jailer becomes unsightly
character_event = {
	id = mageproc.25
	desc = mageproc_25_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.25a
		add_trait = unsightly
		prestige = -150
		piety = -100
	}
}

#############################################################################

# Magic Influence Opinion Events

# Choose positive or negative
character_event = {
	id = mageproc.26
	desc = mageproc_26_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
	}

	option = {
		name = mageproc.26a
		hidden_tooltip = {
			event_target:magic_caster = {
				set_character_flag = magic_positive_influence
			}
			event_target:magic_target = {
				character_event = { id = mageproc.27 }
			}
		}
	}
	option = {
		name = mageproc.26b
		hidden_tooltip = {
			event_target:magic_caster = {
				set_character_flag = magic_negative_influence
			}
			event_target:magic_target = {
				character_event = { id = mageproc.27 }
			}
		}
	}
}
# Effect Applies
character_event = {
	id = mageproc.27
	desc = mageproc_27_desc
	picture = GFX_evt_mage_battle_magic
	notification = yes
	is_triggered_only = yes

	immediate = {
		event_target:magic_target = {
			influence_opinion_effect = yes
		}
	}
	after = {
		clear_event_target = magic_caster
		clear_event_target = magic_target
		clr_character_flag = magic_influence_opinion
		clr_character_flag = magic_positive_influence
		clr_character_flag = magic_negative_influence
	}
	option = {
		name = OK
	}
}

#############################################################################

#Awaken Forest
character_event = {
	id = mageproc.28
	picture = GFX_evt_mage_battle_magic
	desc = mageproc_28_desc

	notification = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				OR = {
					has_character_modifier = magic_power_1
					has_character_modifier = magic_power_2
				}
			}
			random_list = {
				50 = {
					character_event = { id = mageproc.29 }
				} #Small
				50 = {
					character_event = { id = mageproc.30 }
				} #Average
			}
		}
		else_if = {
			limit = {
				OR = {
					has_character_modifier = magic_power_3
					has_character_modifier = magic_power_4
				}
			}
			random_list = {
				50 = {
					character_event = { id = mageproc.30 }
				} #Average
				50 = {
					character_event = { id = mageproc.31 }
				} #Big
			}
		}
	}

	option = {
	}
}
#Small Forest
character_event = {
	id = mageproc.29
	desc = mageproc_29_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		hidden_tooltip = {
			ROOT = {
				character_event = { id = mageproc.32 days = 450 random = 590 }
			}
		}
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_1
					troops = { summoned_treekin = { 500 500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_1
					troops = { summoned_treekin = { 500 500 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_1
					troops = { summoned_treekin = { 500 500 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}

	option = {
	}
}
#Average Forest
character_event = {
	id = mageproc.30
	desc = mageproc_30_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		hidden_tooltip = {
			ROOT = {
				character_event = { id = mageproc.32 days = 450 random = 590 }
			}
		}
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_2
					troops = { summoned_treekin = { 750 750 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_2
					troops = { summoned_treekin = { 750 750 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_2
					troops = { summoned_treekin = { 750 750 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}
	option = {
	}
}
#Large Forest
character_event = {
	id = mageproc.31
	desc = mageproc_31_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		hidden_tooltip = {
			ROOT = {
				character_event = { id = mageproc.32 days = 450 random = 690 }
			}
		}
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_3
					troops = { summoned_treekin = { 1000 1000 } }
					cannot_inherit = yes
					reinforces = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_3
					troops = { summoned_treekin = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = summoned_treekin_3
					troops = { summoned_treekin = { 1000 1000 } }
					cannot_inherit = yes
					attrition = 0
				}
			}
		}
	}

	option = {
	}
}
#The Forest Returns
character_event = {
	id = mageproc.32
	desc = mageproc_32_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		disband_event_forces = summoned_treekin_1
		disband_event_forces = summoned_treekin_2
		disband_event_forces = summoned_treekin_3
	}
	option = {
	}
}

#############################################################################

#Taint Province Event
character_event = {
	id = mageproc.33
	desc = mageproc_33_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_prosperity_decrease_effect = yes
				random_list = {
					50 = { add_province_modifier = { name = province_tainted_1 duration = 2000 } }
					20 = { add_province_modifier = { name = province_tainted_2 duration = 2000 } }
					15 = { add_province_modifier = { name = province_tainted_3 duration = 2000 } }
					10 = { add_province_modifier = { name = province_tainted_4 duration = 2000 } }
					 5 = { add_province_modifier = { name = province_tainted_5 duration = 2000 } }
				}
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = tainted_province_location
	}
}
#The Gold returns to Lead
character_event = {
	id = mageproc.34
	desc = mageproc_34_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		scaled_wealth = {
			value = -0.5
			min = -100
			max = -500
		}
	}
	option = {
	}
}
#Enhance Province Event
character_event = {
	id = mageproc.35
	desc = mageproc_35_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		if = {
			limit = {
				OR = {
					trait = lore_high_magic
					trait = slaan
					trait = skink_priest
				}
			}
			event_target:magic_caster = {
				location = {
					enhance_province_strong_effect = yes
				}
			}
		}
		else = {
			event_target:magic_caster = {
				location = {
					enhance_province_effect = yes
				}
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = prosperity_location_increase
	}
}
#Summon Animal
character_event = {
	id = mageproc.36
	desc = mageproc_36_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
	}
	option = {
		name = mageproc.35a
		spawn_magic_creature_effect = yes
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = prosperity_location_increase
	}
}
#Summoned Animal Returns to wild
character_event = {
	id = mageproc.37
	desc = mageproc_37_desc
	picture = GFX_evt_mage_battle_magic

	is_triggered_only = yes

	option = {
		name = mageproc.35a
		hidden_effect = { death = { death_reason = death_vanished } }
	}
}
#Drain Magic and Morale Event
character_event = {
	id = mageproc.38
	desc = mageproc_38_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				save_event_target_as = magic_loc
			}
		}
		any_character = {
			limit = {
				war_with = ROOT
				location = { province = event_target:magic_loc }
			}
			drain_magic_effect = yes
			random_army = {
				limit = {
					location = { province = event_target:magic_loc }
				}
				morale_dmg_effect = yes
			}
		}
	}

	option = {
	}

	after = {
		clear_event_target = magic_caster
		clear_event_target = magic_loc
		clr_character_flag = drain_magic_location
	}
}
#Spawn Disease and Prosperity Decrease Event
character_event = {
	id = mageproc.39
	desc = mageproc_39_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_spawn_disease_effect = yes
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = spawn_disease_location
	}
}
#Slothful Stupor Province Event
character_event = {
	id = mageproc.40
	desc = mageproc_40_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_prosperity_decrease_effect = yes
				random_list = {
					50 = { add_province_modifier = { name = slothful_stupor duration = 180 } }
					20 = { add_province_modifier = { name = slothful_stupor duration = 365 } }
					15 = { add_province_modifier = { name = slothful_stupor duration = 730 } }
					10 = { add_province_modifier = { name = slothful_stupor duration = 1095 } }
					 5 = { add_province_modifier = { name = slothful_stupor duration = 1825 } }
				}
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = slothful_stupor_location
	}
}
#Desert Wind Province Event
character_event = {
	id = mageproc.41
	desc = mageproc_41_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				magic_prosperity_decrease_effect = yes
				random_list = {
					50 = { add_province_modifier = { name = desert_wind duration = 180 } }
					30 = { add_province_modifier = { name = desert_wind duration = 365 } }
					20 = { add_province_modifier = { name = desert_wind duration = 730 } }
				}
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = desert_wind_location
	}
}
#Blizzard Province Event
character_event = {
	id = mageproc.42
	desc = mageproc_42_desc
	picture = GFX_evt_mage_battle_magic

	notification = yes
	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = magic_caster }
		event_target:magic_caster = {
			location = {
				random_list = {
					50 = { add_province_modifier = { name = blizzard duration = 180 } }
					30 = { add_province_modifier = { name = blizzard duration = 365 } }
					20 = { add_province_modifier = { name = blizzard duration = 730 } }
				}
			}
		}
	}
	option = {
	}
	after = {
		clear_event_target = magic_caster
		clr_character_flag = blizzard_location
	}
}
#Eat Mushroom
character_event = {
	id = mageproc.43
	picture = "GFX_evt_warpstone_vein"
	desc = EVTDESC_mageproc_43

	is_triggered_only = yes

	option = { #Consume Scarlet Elf Cap
		name = EVTOPTA_mageproc_43
		trigger = {
			has_artifact = scarlet_elf_cap_mushroom
		}
		unsafe_destroy_artifact = scarlet_elf_cap_mushroom
		add_character_modifier = { name = poisoned_weapons duration = 365 stacking = yes }
	}

	option = { #Consume Madcap
		name = EVTOPTB_mageproc_43
		trigger = {
			has_artifact = madcap_mushroom
		}
		unsafe_destroy_artifact = madcap_mushroom
		add_offmap_currency = {
			offmap = offmap_magic
			value = 5
		}
		add_character_modifier = { name = madcap_frenzy duration = 365 stacking = yes }
		hidden_tooltip = {
			channeling_effect = yes
			random = {
				chance = 20
				add_trait = addict
			}
			character_event = { id = mutate.5 } #Lunacy Counter
		}
	}

	option = { #Cancel Decision
		name = "Nevermind"
	}
}
